function Eu(t,e){for(var s=0;s<e.length;s++){const n=e[s];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(n,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Hi(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const Ne={},en=[],Yt=()=>{},sl=()=>!1,Cr=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),qi=t=>t.startsWith("onUpdate:"),ht=Object.assign,Gi=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},Cu=Object.prototype.hasOwnProperty,Ie=(t,e)=>Cu.call(t,e),ve=Array.isArray,tn=t=>Bn(t)==="[object Map]",un=t=>Bn(t)==="[object Set]",$o=t=>Bn(t)==="[object Date]",xe=t=>typeof t=="function",Xe=t=>typeof t=="string",Xt=t=>typeof t=="symbol",De=t=>t!==null&&typeof t=="object",nl=t=>(De(t)||xe(t))&&xe(t.then)&&xe(t.catch),rl=Object.prototype.toString,Bn=t=>rl.call(t),Ou=t=>Bn(t).slice(8,-1),il=t=>Bn(t)==="[object Object]",Ki=t=>Xe(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,_n=Hi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Or=t=>{const e=Object.create(null);return(s=>e[s]||(e[s]=t(s)))},Tu=/-\w/g,Ut=Or(t=>t.replace(Tu,e=>e.slice(1).toUpperCase())),$u=/\B([A-Z])/g,Es=Or(t=>t.replace($u,"-$1").toLowerCase()),Tr=Or(t=>t.charAt(0).toUpperCase()+t.slice(1)),Gr=Or(t=>t?`on${Tr(t)}`:""),_s=(t,e)=>!Object.is(t,e),or=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},ol=(t,e,s,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:s})},dr=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Po;const $r=()=>Po||(Po=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function as(t){if(ve(t)){const e={};for(let s=0;s<t.length;s++){const n=t[s],r=Xe(n)?ju(n):as(n);if(r)for(const i in r)e[i]=r[i]}return e}else if(Xe(t)||De(t))return t}const Pu=/;(?![^(]*\))/g,Ru=/:([^]+)/,Uu=/\/\*[^]*?\*\//g;function ju(t){const e={};return t.replace(Uu,"").split(Pu).forEach(s=>{if(s){const n=s.split(Ru);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function it(t){let e="";if(Xe(t))e=t;else if(ve(t))for(let s=0;s<t.length;s++){const n=it(t[s]);n&&(e+=n+" ")}else if(De(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const Iu="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Nu=Hi(Iu);function al(t){return!!t||t===""}function Du(t,e){if(t.length!==e.length)return!1;let s=!0;for(let n=0;s&&n<t.length;n++)s=Bs(t[n],e[n]);return s}function Bs(t,e){if(t===e)return!0;let s=$o(t),n=$o(e);if(s||n)return s&&n?t.getTime()===e.getTime():!1;if(s=Xt(t),n=Xt(e),s||n)return t===e;if(s=ve(t),n=ve(e),s||n)return s&&n?Du(t,e):!1;if(s=De(t),n=De(e),s||n){if(!s||!n)return!1;const r=Object.keys(t).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in t){const c=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(c&&!l||!c&&l||!Bs(t[o],e[o]))return!1}}return String(t)===String(e)}function Wi(t,e){return t.findIndex(s=>Bs(s,e))}const ll=t=>!!(t&&t.__v_isRef===!0),D=t=>Xe(t)?t:t==null?"":ve(t)||De(t)&&(t.toString===rl||!xe(t.toString))?ll(t)?D(t.value):JSON.stringify(t,cl,2):String(t),cl=(t,e)=>ll(e)?cl(t,e.value):tn(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[n,r],i)=>(s[Kr(n,i)+" =>"]=r,s),{})}:un(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>Kr(s))}:Xt(e)?Kr(e):De(e)&&!ve(e)&&!il(e)?String(e):e,Kr=(t,e="")=>{var s;return Xt(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ut;class ul{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ut,!e&&ut&&(this.index=(ut.scopes||(ut.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=ut;try{return ut=this,e()}finally{ut=s}}}on(){++this._on===1&&(this.prevScope=ut,ut=this)}off(){this._on>0&&--this._on===0&&(ut=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function dl(t){return new ul(t)}function fl(){return ut}function Lu(t,e=!1){ut&&ut.cleanups.push(t)}let Me;const Wr=new WeakSet;class hl{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ut&&ut.active&&ut.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Wr.has(this)&&(Wr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ml(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ro(this),gl(this);const e=Me,s=Vt;Me=this,Vt=!0;try{return this.fn()}finally{vl(this),Me=e,Vt=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Yi(e);this.deps=this.depsTail=void 0,Ro(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Wr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){pi(this)&&this.run()}get dirty(){return pi(this)}}let pl=0,wn,xn;function ml(t,e=!1){if(t.flags|=8,e){t.next=xn,xn=t;return}t.next=wn,wn=t}function Ji(){pl++}function zi(){if(--pl>0)return;if(xn){let e=xn;for(xn=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;wn;){let e=wn;for(wn=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=s}}if(t)throw t}function gl(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function vl(t){let e,s=t.depsTail,n=s;for(;n;){const r=n.prevDep;n.version===-1?(n===s&&(s=r),Yi(n),Fu(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=r}t.deps=e,t.depsTail=s}function pi(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(yl(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function yl(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Rn)||(t.globalVersion=Rn,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!pi(t))))return;t.flags|=2;const e=t.dep,s=Me,n=Vt;Me=t,Vt=!0;try{gl(t);const r=t.fn(t._value);(e.version===0||_s(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Me=s,Vt=n,vl(t),t.flags&=-3}}function Yi(t,e=!1){const{dep:s,prevSub:n,nextSub:r}=t;if(n&&(n.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=n,t.nextSub=void 0),s.subs===t&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let i=s.computed.deps;i;i=i.nextDep)Yi(i,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function Fu(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let Vt=!0;const bl=[];function ls(){bl.push(Vt),Vt=!1}function cs(){const t=bl.pop();Vt=t===void 0?!0:t}function Ro(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=Me;Me=void 0;try{e()}finally{Me=s}}}let Rn=0;class Mu{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Xi{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Me||!Vt||Me===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Me)s=this.activeLink=new Mu(Me,this),Me.deps?(s.prevDep=Me.depsTail,Me.depsTail.nextDep=s,Me.depsTail=s):Me.deps=Me.depsTail=s,_l(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=Me.depsTail,s.nextDep=void 0,Me.depsTail.nextDep=s,Me.depsTail=s,Me.deps===s&&(Me.deps=n)}return s}trigger(e){this.version++,Rn++,this.notify(e)}notify(e){Ji();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{zi()}}}function _l(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)_l(n)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subs=t}}const fr=new WeakMap,Fs=Symbol(""),mi=Symbol(""),Un=Symbol("");function dt(t,e,s){if(Vt&&Me){let n=fr.get(t);n||fr.set(t,n=new Map);let r=n.get(s);r||(n.set(s,r=new Xi),r.map=n,r.key=s),r.track()}}function rs(t,e,s,n,r,i){const o=fr.get(t);if(!o){Rn++;return}const c=l=>{l&&l.trigger()};if(Ji(),e==="clear")o.forEach(c);else{const l=ve(t),u=l&&Ki(s);if(l&&s==="length"){const d=Number(n);o.forEach((f,h)=>{(h==="length"||h===Un||!Xt(h)&&h>=d)&&c(f)})}else switch((s!==void 0||o.has(void 0))&&c(o.get(s)),u&&c(o.get(Un)),e){case"add":l?u&&c(o.get("length")):(c(o.get(Fs)),tn(t)&&c(o.get(mi)));break;case"delete":l||(c(o.get(Fs)),tn(t)&&c(o.get(mi)));break;case"set":tn(t)&&c(o.get(Fs));break}}zi()}function Bu(t,e){const s=fr.get(t);return s&&s.get(e)}function Vs(t){const e=Pe(t);return e===t?e:(dt(e,"iterate",Un),Pt(t)?e:e.map(ot))}function Pr(t){return dt(t=Pe(t),"iterate",Un),t}const Vu={__proto__:null,[Symbol.iterator](){return Jr(this,Symbol.iterator,ot)},concat(...t){return Vs(this).concat(...t.map(e=>ve(e)?Vs(e):e))},entries(){return Jr(this,"entries",t=>(t[1]=ot(t[1]),t))},every(t,e){return es(this,"every",t,e,void 0,arguments)},filter(t,e){return es(this,"filter",t,e,s=>s.map(ot),arguments)},find(t,e){return es(this,"find",t,e,ot,arguments)},findIndex(t,e){return es(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return es(this,"findLast",t,e,ot,arguments)},findLastIndex(t,e){return es(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return es(this,"forEach",t,e,void 0,arguments)},includes(...t){return zr(this,"includes",t)},indexOf(...t){return zr(this,"indexOf",t)},join(t){return Vs(this).join(t)},lastIndexOf(...t){return zr(this,"lastIndexOf",t)},map(t,e){return es(this,"map",t,e,void 0,arguments)},pop(){return mn(this,"pop")},push(...t){return mn(this,"push",t)},reduce(t,...e){return Uo(this,"reduce",t,e)},reduceRight(t,...e){return Uo(this,"reduceRight",t,e)},shift(){return mn(this,"shift")},some(t,e){return es(this,"some",t,e,void 0,arguments)},splice(...t){return mn(this,"splice",t)},toReversed(){return Vs(this).toReversed()},toSorted(t){return Vs(this).toSorted(t)},toSpliced(...t){return Vs(this).toSpliced(...t)},unshift(...t){return mn(this,"unshift",t)},values(){return Jr(this,"values",ot)}};function Jr(t,e,s){const n=Pr(t),r=n[e]();return n!==t&&!Pt(t)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.done||(i.value=s(i.value)),i}),r}const Hu=Array.prototype;function es(t,e,s,n,r,i){const o=Pr(t),c=o!==t&&!Pt(t),l=o[e];if(l!==Hu[e]){const f=l.apply(t,i);return c?ot(f):f}let u=s;o!==t&&(c?u=function(f,h){return s.call(this,ot(f),h,t)}:s.length>2&&(u=function(f,h){return s.call(this,f,h,t)}));const d=l.call(o,u,n);return c&&r?r(d):d}function Uo(t,e,s,n){const r=Pr(t);let i=s;return r!==t&&(Pt(t)?s.length>3&&(i=function(o,c,l){return s.call(this,o,c,l,t)}):i=function(o,c,l){return s.call(this,o,ot(c),l,t)}),r[e](i,...n)}function zr(t,e,s){const n=Pe(t);dt(n,"iterate",Un);const r=n[e](...s);return(r===-1||r===!1)&&eo(s[0])?(s[0]=Pe(s[0]),n[e](...s)):r}function mn(t,e,s=[]){ls(),Ji();const n=Pe(t)[e].apply(t,s);return zi(),cs(),n}const qu=Hi("__proto__,__v_isRef,__isVue"),wl=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Xt));function Gu(t){Xt(t)||(t=String(t));const e=Pe(this);return dt(e,"has",t),e.hasOwnProperty(t)}class xl{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,n){if(s==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(s==="__v_isReactive")return!r;if(s==="__v_isReadonly")return r;if(s==="__v_isShallow")return i;if(s==="__v_raw")return n===(r?i?td:El:i?Al:kl).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=ve(e);if(!r){let l;if(o&&(l=Vu[s]))return l;if(s==="hasOwnProperty")return Gu}const c=Reflect.get(e,s,We(e)?e:n);if((Xt(s)?wl.has(s):qu(s))||(r||dt(e,"get",s),i))return c;if(We(c)){const l=o&&Ki(s)?c:c.value;return r&&De(l)?vi(l):l}return De(c)?r?vi(c):$t(c):c}}class Sl extends xl{constructor(e=!1){super(!1,e)}set(e,s,n,r){let i=e[s];if(!this._isShallow){const l=xs(i);if(!Pt(n)&&!xs(n)&&(i=Pe(i),n=Pe(n)),!ve(e)&&We(i)&&!We(n))return l||(i.value=n),!0}const o=ve(e)&&Ki(s)?Number(s)<e.length:Ie(e,s),c=Reflect.set(e,s,n,We(e)?e:r);return e===Pe(r)&&(o?_s(n,i)&&rs(e,"set",s,n):rs(e,"add",s,n)),c}deleteProperty(e,s){const n=Ie(e,s);e[s];const r=Reflect.deleteProperty(e,s);return r&&n&&rs(e,"delete",s,void 0),r}has(e,s){const n=Reflect.has(e,s);return(!Xt(s)||!wl.has(s))&&dt(e,"has",s),n}ownKeys(e){return dt(e,"iterate",ve(e)?"length":Fs),Reflect.ownKeys(e)}}class Ku extends xl{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const Wu=new Sl,Ju=new Ku,zu=new Sl(!0);const gi=t=>t,Wn=t=>Reflect.getPrototypeOf(t);function Yu(t,e,s){return function(...n){const r=this.__v_raw,i=Pe(r),o=tn(i),c=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=r[t](...n),d=s?gi:e?hr:ot;return!e&&dt(i,"iterate",l?mi:Fs),{next(){const{value:f,done:h}=u.next();return h?{value:f,done:h}:{value:c?[d(f[0]),d(f[1])]:d(f),done:h}},[Symbol.iterator](){return this}}}}function Jn(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Xu(t,e){const s={get(r){const i=this.__v_raw,o=Pe(i),c=Pe(r);t||(_s(r,c)&&dt(o,"get",r),dt(o,"get",c));const{has:l}=Wn(o),u=e?gi:t?hr:ot;if(l.call(o,r))return u(i.get(r));if(l.call(o,c))return u(i.get(c));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!t&&dt(Pe(r),"iterate",Fs),r.size},has(r){const i=this.__v_raw,o=Pe(i),c=Pe(r);return t||(_s(r,c)&&dt(o,"has",r),dt(o,"has",c)),r===c?i.has(r):i.has(r)||i.has(c)},forEach(r,i){const o=this,c=o.__v_raw,l=Pe(c),u=e?gi:t?hr:ot;return!t&&dt(l,"iterate",Fs),c.forEach((d,f)=>r.call(i,u(d),u(f),o))}};return ht(s,t?{add:Jn("add"),set:Jn("set"),delete:Jn("delete"),clear:Jn("clear")}:{add(r){!e&&!Pt(r)&&!xs(r)&&(r=Pe(r));const i=Pe(this);return Wn(i).has.call(i,r)||(i.add(r),rs(i,"add",r,r)),this},set(r,i){!e&&!Pt(i)&&!xs(i)&&(i=Pe(i));const o=Pe(this),{has:c,get:l}=Wn(o);let u=c.call(o,r);u||(r=Pe(r),u=c.call(o,r));const d=l.call(o,r);return o.set(r,i),u?_s(i,d)&&rs(o,"set",r,i):rs(o,"add",r,i),this},delete(r){const i=Pe(this),{has:o,get:c}=Wn(i);let l=o.call(i,r);l||(r=Pe(r),l=o.call(i,r)),c&&c.call(i,r);const u=i.delete(r);return l&&rs(i,"delete",r,void 0),u},clear(){const r=Pe(this),i=r.size!==0,o=r.clear();return i&&rs(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{s[r]=Yu(r,t,e)}),s}function Qi(t,e){const s=Xu(t,e);return(n,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?n:Reflect.get(Ie(s,r)&&r in n?s:n,r,i)}const Qu={get:Qi(!1,!1)},Zu={get:Qi(!1,!0)},ed={get:Qi(!0,!1)};const kl=new WeakMap,Al=new WeakMap,El=new WeakMap,td=new WeakMap;function sd(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function nd(t){return t.__v_skip||!Object.isExtensible(t)?0:sd(Ou(t))}function $t(t){return xs(t)?t:Zi(t,!1,Wu,Qu,kl)}function Cl(t){return Zi(t,!1,zu,Zu,Al)}function vi(t){return Zi(t,!0,Ju,ed,El)}function Zi(t,e,s,n,r){if(!De(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=nd(t);if(i===0)return t;const o=r.get(t);if(o)return o;const c=new Proxy(t,i===2?n:s);return r.set(t,c),c}function ws(t){return xs(t)?ws(t.__v_raw):!!(t&&t.__v_isReactive)}function xs(t){return!!(t&&t.__v_isReadonly)}function Pt(t){return!!(t&&t.__v_isShallow)}function eo(t){return t?!!t.__v_raw:!1}function Pe(t){const e=t&&t.__v_raw;return e?Pe(e):t}function to(t){return!Ie(t,"__v_skip")&&Object.isExtensible(t)&&ol(t,"__v_skip",!0),t}const ot=t=>De(t)?$t(t):t,hr=t=>De(t)?vi(t):t;function We(t){return t?t.__v_isRef===!0:!1}function z(t){return Ol(t,!1)}function rd(t){return Ol(t,!0)}function Ol(t,e){return We(t)?t:new id(t,e)}class id{constructor(e,s){this.dep=new Xi,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:Pe(e),this._value=s?e:ot(e),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(e){const s=this._rawValue,n=this.__v_isShallow||Pt(e)||xs(e);e=n?e:Pe(e),_s(e,s)&&(this._rawValue=e,this._value=n?e:ot(e),this.dep.trigger())}}function ne(t){return We(t)?t.value:t}const od={get:(t,e,s)=>e==="__v_raw"?t:ne(Reflect.get(t,e,s)),set:(t,e,s,n)=>{const r=t[e];return We(r)&&!We(s)?(r.value=s,!0):Reflect.set(t,e,s,n)}};function Tl(t){return ws(t)?t:new Proxy(t,od)}function ad(t){const e=ve(t)?new Array(t.length):{};for(const s in t)e[s]=cd(t,s);return e}class ld{constructor(e,s,n){this._object=e,this._key=s,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Bu(Pe(this._object),this._key)}}function cd(t,e,s){const n=t[e];return We(n)?n:new ld(t,e,s)}class ud{constructor(e,s,n){this.fn=e,this.setter=s,this._value=void 0,this.dep=new Xi(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Rn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Me!==this)return ml(this,!0),!0}get value(){const e=this.dep.track();return yl(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function dd(t,e,s=!1){let n,r;return xe(t)?n=t:(n=t.get,r=t.set),new ud(n,r,s)}const zn={},pr=new WeakMap;let Us;function fd(t,e=!1,s=Us){if(s){let n=pr.get(s);n||pr.set(s,n=[]),n.push(t)}}function hd(t,e,s=Ne){const{immediate:n,deep:r,once:i,scheduler:o,augmentJob:c,call:l}=s,u=x=>r?x:Pt(x)||r===!1||r===0?is(x,1):is(x);let d,f,h,p,g=!1,v=!1;if(We(t)?(f=()=>t.value,g=Pt(t)):ws(t)?(f=()=>u(t),g=!0):ve(t)?(v=!0,g=t.some(x=>ws(x)||Pt(x)),f=()=>t.map(x=>{if(We(x))return x.value;if(ws(x))return u(x);if(xe(x))return l?l(x,2):x()})):xe(t)?e?f=l?()=>l(t,2):t:f=()=>{if(h){ls();try{h()}finally{cs()}}const x=Us;Us=d;try{return l?l(t,3,[p]):t(p)}finally{Us=x}}:f=Yt,e&&r){const x=f,j=r===!0?1/0:r;f=()=>is(x(),j)}const k=fl(),P=()=>{d.stop(),k&&k.active&&Gi(k.effects,d)};if(i&&e){const x=e;e=(...j)=>{x(...j),P()}}let R=v?new Array(t.length).fill(zn):zn;const S=x=>{if(!(!(d.flags&1)||!d.dirty&&!x))if(e){const j=d.run();if(r||g||(v?j.some((I,_)=>_s(I,R[_])):_s(j,R))){h&&h();const I=Us;Us=d;try{const _=[j,R===zn?void 0:v&&R[0]===zn?[]:R,p];R=j,l?l(e,3,_):e(..._)}finally{Us=I}}}else d.run()};return c&&c(S),d=new hl(f),d.scheduler=o?()=>o(S,!1):S,p=x=>fd(x,!1,d),h=d.onStop=()=>{const x=pr.get(d);if(x){if(l)l(x,4);else for(const j of x)j();pr.delete(d)}},e?n?S(!0):R=d.run():o?o(S.bind(null,!0),!0):d.run(),P.pause=d.pause.bind(d),P.resume=d.resume.bind(d),P.stop=P,P}function is(t,e=1/0,s){if(e<=0||!De(t)||t.__v_skip||(s=s||new Map,(s.get(t)||0)>=e))return t;if(s.set(t,e),e--,We(t))is(t.value,e,s);else if(ve(t))for(let n=0;n<t.length;n++)is(t[n],e,s);else if(un(t)||tn(t))t.forEach(n=>{is(n,e,s)});else if(il(t)){for(const n in t)is(t[n],e,s);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&is(t[n],e,s)}return t}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Vn(t,e,s,n){try{return n?t(...n):t()}catch(r){Rr(r,e,s)}}function Qt(t,e,s,n){if(xe(t)){const r=Vn(t,e,s,n);return r&&nl(r)&&r.catch(i=>{Rr(i,e,s)}),r}if(ve(t)){const r=[];for(let i=0;i<t.length;i++)r.push(Qt(t[i],e,s,n));return r}}function Rr(t,e,s,n=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Ne;if(e){let c=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${s}`;for(;c;){const d=c.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](t,l,u)===!1)return}c=c.parent}if(i){ls(),Vn(i,null,10,[t,l,u]),cs();return}}pd(t,s,r,n,o)}function pd(t,e,s,n=!0,r=!1){if(r)throw t;console.error(t)}const yt=[];let Wt=-1;const sn=[];let gs=null,Ys=0;const $l=Promise.resolve();let mr=null;function Ur(t){const e=mr||$l;return t?e.then(this?t.bind(this):t):e}function md(t){let e=Wt+1,s=yt.length;for(;e<s;){const n=e+s>>>1,r=yt[n],i=jn(r);i<t||i===t&&r.flags&2?e=n+1:s=n}return e}function so(t){if(!(t.flags&1)){const e=jn(t),s=yt[yt.length-1];!s||!(t.flags&2)&&e>=jn(s)?yt.push(t):yt.splice(md(e),0,t),t.flags|=1,Pl()}}function Pl(){mr||(mr=$l.then(Ul))}function gd(t){ve(t)?sn.push(...t):gs&&t.id===-1?gs.splice(Ys+1,0,t):t.flags&1||(sn.push(t),t.flags|=1),Pl()}function jo(t,e,s=Wt+1){for(;s<yt.length;s++){const n=yt[s];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;yt.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Rl(t){if(sn.length){const e=[...new Set(sn)].sort((s,n)=>jn(s)-jn(n));if(sn.length=0,gs){gs.push(...e);return}for(gs=e,Ys=0;Ys<gs.length;Ys++){const s=gs[Ys];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}gs=null,Ys=0}}const jn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Ul(t){try{for(Wt=0;Wt<yt.length;Wt++){const e=yt[Wt];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Vn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Wt<yt.length;Wt++){const e=yt[Wt];e&&(e.flags&=-2)}Wt=-1,yt.length=0,Rl(),mr=null,(yt.length||sn.length)&&Ul()}}let Ot=null,jl=null;function gr(t){const e=Ot;return Ot=t,jl=t&&t.type.__scopeId||null,e}function Ge(t,e=Ot,s){if(!e||t._n)return t;const n=(...r)=>{n._d&&br(-1);const i=gr(e);let o;try{o=t(...r)}finally{gr(i),n._d&&br(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function ae(t,e){if(Ot===null)return t;const s=Dr(Ot),n=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,c,l=Ne]=e[r];i&&(xe(i)&&(i={mounted:i,updated:i}),i.deep&&is(o),n.push({dir:i,instance:s,value:o,oldValue:void 0,arg:c,modifiers:l}))}return t}function Ts(t,e,s,n){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const c=r[o];i&&(c.oldValue=i[o].value);let l=c.dir[n];l&&(ls(),Qt(l,s,8,[t.el,c,t,e]),cs())}}const vd=Symbol("_vte"),yd=t=>t.__isTeleport,bd=Symbol("_leaveCb");function no(t,e){t.shapeFlag&6&&t.component?(t.transition=e,no(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Il(t,e){return xe(t)?ht({name:t.name},e,{setup:t}):t}function Nl(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const vr=new WeakMap;function Sn(t,e,s,n,r=!1){if(ve(t)){t.forEach((g,v)=>Sn(g,e&&(ve(e)?e[v]:e),s,n,r));return}if(kn(n)&&!r){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Sn(t,e,s,n.component.subTree);return}const i=n.shapeFlag&4?Dr(n.component):n.el,o=r?null:i,{i:c,r:l}=t,u=e&&e.r,d=c.refs===Ne?c.refs={}:c.refs,f=c.setupState,h=Pe(f),p=f===Ne?sl:g=>Ie(h,g);if(u!=null&&u!==l){if(Io(e),Xe(u))d[u]=null,p(u)&&(f[u]=null);else if(We(u)){u.value=null;const g=e;g.k&&(d[g.k]=null)}}if(xe(l))Vn(l,c,12,[o,d]);else{const g=Xe(l),v=We(l);if(g||v){const k=()=>{if(t.f){const P=g?p(l)?f[l]:d[l]:l.value;if(r)ve(P)&&Gi(P,i);else if(ve(P))P.includes(i)||P.push(i);else if(g)d[l]=[i],p(l)&&(f[l]=d[l]);else{const R=[i];l.value=R,t.k&&(d[t.k]=R)}}else g?(d[l]=o,p(l)&&(f[l]=o)):v&&(l.value=o,t.k&&(d[t.k]=o))};if(o){const P=()=>{k(),vr.delete(t)};P.id=-1,vr.set(t,P),At(P,s)}else Io(t),k()}}}function Io(t){const e=vr.get(t);e&&(e.flags|=8,vr.delete(t))}$r().requestIdleCallback;$r().cancelIdleCallback;const kn=t=>!!t.type.__asyncLoader,Dl=t=>t.type.__isKeepAlive;function _d(t,e){Ll(t,"a",e)}function wd(t,e){Ll(t,"da",e)}function Ll(t,e,s=ft){const n=t.__wdc||(t.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(jr(e,n,s),s){let r=s.parent;for(;r&&r.parent;)Dl(r.parent.vnode)&&xd(n,e,s,r),r=r.parent}}function xd(t,e,s,n){const r=jr(e,t,n,!0);io(()=>{Gi(n[e],r)},s)}function jr(t,e,s=ft,n=!1){if(s){const r=s[t]||(s[t]=[]),i=e.__weh||(e.__weh=(...o)=>{ls();const c=Hn(s),l=Qt(e,s,t,o);return c(),cs(),l});return n?r.unshift(i):r.push(i),i}}const us=t=>(e,s=ft)=>{(!Nn||t==="sp")&&jr(t,(...n)=>e(...n),s)},Sd=us("bm"),Ye=us("m"),kd=us("bu"),Ad=us("u"),ro=us("bum"),io=us("um"),Ed=us("sp"),Cd=us("rtg"),Od=us("rtc");function Td(t,e=ft){jr("ec",t,e)}const $d="components";function oo(t,e){return Rd($d,t,!0,e)||t}const Pd=Symbol.for("v-ndc");function Rd(t,e,s=!0,n=!1){const r=Ot||ft;if(r){const i=r.type;{const c=wf(i,!1);if(c&&(c===e||c===Ut(e)||c===Tr(Ut(e))))return i}const o=No(r[t]||i[t],e)||No(r.appContext[t],e);return!o&&n?i:o}}function No(t,e){return t&&(t[e]||t[Ut(e)]||t[Tr(Ut(e))])}function st(t,e,s,n){let r;const i=s,o=ve(t);if(o||Xe(t)){const c=o&&ws(t);let l=!1,u=!1;c&&(l=!Pt(t),u=xs(t),t=Pr(t)),r=new Array(t.length);for(let d=0,f=t.length;d<f;d++)r[d]=e(l?u?hr(ot(t[d])):ot(t[d]):t[d],d,void 0,i)}else if(typeof t=="number"){r=new Array(t);for(let c=0;c<t;c++)r[c]=e(c+1,c,void 0,i)}else if(De(t))if(t[Symbol.iterator])r=Array.from(t,(c,l)=>e(c,l,void 0,i));else{const c=Object.keys(t);r=new Array(c.length);for(let l=0,u=c.length;l<u;l++){const d=c[l];r[l]=e(t[d],d,l,i)}}else r=[];return r}const yi=t=>t?oc(t)?Dr(t):yi(t.parent):null,An=ht(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>yi(t.parent),$root:t=>yi(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Ml(t),$forceUpdate:t=>t.f||(t.f=()=>{so(t.update)}),$nextTick:t=>t.n||(t.n=Ur.bind(t.proxy)),$watch:t=>ef.bind(t)}),Yr=(t,e)=>t!==Ne&&!t.__isScriptSetup&&Ie(t,e),Ud={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:n,data:r,props:i,accessCache:o,type:c,appContext:l}=t;let u;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return r[e];case 4:return s[e];case 3:return i[e]}else{if(Yr(n,e))return o[e]=1,n[e];if(r!==Ne&&Ie(r,e))return o[e]=2,r[e];if((u=t.propsOptions[0])&&Ie(u,e))return o[e]=3,i[e];if(s!==Ne&&Ie(s,e))return o[e]=4,s[e];bi&&(o[e]=0)}}const d=An[e];let f,h;if(d)return e==="$attrs"&&dt(t.attrs,"get",""),d(t);if((f=c.__cssModules)&&(f=f[e]))return f;if(s!==Ne&&Ie(s,e))return o[e]=4,s[e];if(h=l.config.globalProperties,Ie(h,e))return h[e]},set({_:t},e,s){const{data:n,setupState:r,ctx:i}=t;return Yr(r,e)?(r[e]=s,!0):n!==Ne&&Ie(n,e)?(n[e]=s,!0):Ie(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:n,appContext:r,propsOptions:i,type:o}},c){let l,u;return!!(s[c]||t!==Ne&&c[0]!=="$"&&Ie(t,c)||Yr(e,c)||(l=i[0])&&Ie(l,c)||Ie(n,c)||Ie(An,c)||Ie(r.config.globalProperties,c)||(u=o.__cssModules)&&u[c])},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:Ie(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function Do(t){return ve(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let bi=!0;function jd(t){const e=Ml(t),s=t.proxy,n=t.ctx;bi=!1,e.beforeCreate&&Lo(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:c,provide:l,inject:u,created:d,beforeMount:f,mounted:h,beforeUpdate:p,updated:g,activated:v,deactivated:k,beforeDestroy:P,beforeUnmount:R,destroyed:S,unmounted:x,render:j,renderTracked:I,renderTriggered:_,errorCaptured:U,serverPrefetch:B,expose:G,inheritAttrs:K,components:J,directives:ce,filters:ge}=e;if(u&&Id(u,n,null),o)for(const fe in o){const re=o[fe];xe(re)&&(n[fe]=re.bind(s))}if(r){const fe=r.call(s,s);De(fe)&&(t.data=$t(fe))}if(bi=!0,i)for(const fe in i){const re=i[fe],we=xe(re)?re.bind(s,s):xe(re.get)?re.get.bind(s,s):Yt,Ee=!xe(re)&&xe(re.set)?re.set.bind(s):Yt,_e=ie({get:we,set:Ee});Object.defineProperty(n,fe,{enumerable:!0,configurable:!0,get:()=>_e.value,set:Te=>_e.value=Te})}if(c)for(const fe in c)Fl(c[fe],n,s,fe);if(l){const fe=xe(l)?l.call(s):l;Reflect.ownKeys(fe).forEach(re=>{ar(re,fe[re])})}d&&Lo(d,t,"c");function Ae(fe,re){ve(re)?re.forEach(we=>fe(we.bind(s))):re&&fe(re.bind(s))}if(Ae(Sd,f),Ae(Ye,h),Ae(kd,p),Ae(Ad,g),Ae(_d,v),Ae(wd,k),Ae(Td,U),Ae(Od,I),Ae(Cd,_),Ae(ro,R),Ae(io,x),Ae(Ed,B),ve(G))if(G.length){const fe=t.exposed||(t.exposed={});G.forEach(re=>{Object.defineProperty(fe,re,{get:()=>s[re],set:we=>s[re]=we,enumerable:!0})})}else t.exposed||(t.exposed={});j&&t.render===Yt&&(t.render=j),K!=null&&(t.inheritAttrs=K),J&&(t.components=J),ce&&(t.directives=ce),B&&Nl(t)}function Id(t,e,s=Yt){ve(t)&&(t=_i(t));for(const n in t){const r=t[n];let i;De(r)?"default"in r?i=Ht(r.from||n,r.default,!0):i=Ht(r.from||n):i=Ht(r),We(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[n]=i}}function Lo(t,e,s){Qt(ve(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,s)}function Fl(t,e,s,n){let r=n.includes(".")?Zl(s,n):()=>s[n];if(Xe(t)){const i=e[t];xe(i)&&qe(r,i)}else if(xe(t))qe(r,t.bind(s));else if(De(t))if(ve(t))t.forEach(i=>Fl(i,e,s,n));else{const i=xe(t.handler)?t.handler.bind(s):e[t.handler];xe(i)&&qe(r,i,t)}}function Ml(t){const e=t.type,{mixins:s,extends:n}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,c=i.get(e);let l;return c?l=c:!r.length&&!s&&!n?l=e:(l={},r.length&&r.forEach(u=>yr(l,u,o,!0)),yr(l,e,o)),De(e)&&i.set(e,l),l}function yr(t,e,s,n=!1){const{mixins:r,extends:i}=e;i&&yr(t,i,s,!0),r&&r.forEach(o=>yr(t,o,s,!0));for(const o in e)if(!(n&&o==="expose")){const c=Nd[o]||s&&s[o];t[o]=c?c(t[o],e[o]):e[o]}return t}const Nd={data:Fo,props:Mo,emits:Mo,methods:yn,computed:yn,beforeCreate:gt,created:gt,beforeMount:gt,mounted:gt,beforeUpdate:gt,updated:gt,beforeDestroy:gt,beforeUnmount:gt,destroyed:gt,unmounted:gt,activated:gt,deactivated:gt,errorCaptured:gt,serverPrefetch:gt,components:yn,directives:yn,watch:Ld,provide:Fo,inject:Dd};function Fo(t,e){return e?t?function(){return ht(xe(t)?t.call(this,this):t,xe(e)?e.call(this,this):e)}:e:t}function Dd(t,e){return yn(_i(t),_i(e))}function _i(t){if(ve(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function gt(t,e){return t?[...new Set([].concat(t,e))]:e}function yn(t,e){return t?ht(Object.create(null),t,e):e}function Mo(t,e){return t?ve(t)&&ve(e)?[...new Set([...t,...e])]:ht(Object.create(null),Do(t),Do(e??{})):e}function Ld(t,e){if(!t)return e;if(!e)return t;const s=ht(Object.create(null),t);for(const n in e)s[n]=gt(t[n],e[n]);return s}function Bl(){return{app:null,config:{isNativeTag:sl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Fd=0;function Md(t,e){return function(n,r=null){xe(n)||(n=ht({},n)),r!=null&&!De(r)&&(r=null);const i=Bl(),o=new WeakSet,c=[];let l=!1;const u=i.app={_uid:Fd++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:Sf,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&xe(d.install)?(o.add(d),d.install(u,...f)):xe(d)&&(o.add(d),d(u,...f))),u},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),u},component(d,f){return f?(i.components[d]=f,u):i.components[d]},directive(d,f){return f?(i.directives[d]=f,u):i.directives[d]},mount(d,f,h){if(!l){const p=u._ceVNode||Q(n,r);return p.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),t(p,d,h),l=!0,u._container=d,d.__vue_app__=u,Dr(p.component)}},onUnmount(d){c.push(d)},unmount(){l&&(Qt(c,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(d,f){return i.provides[d]=f,u},runWithContext(d){const f=Ms;Ms=u;try{return d()}finally{Ms=f}}};return u}}let Ms=null;function ar(t,e){if(ft){let s=ft.provides;const n=ft.parent&&ft.parent.provides;n===s&&(s=ft.provides=Object.create(n)),s[t]=e}}function Ht(t,e,s=!1){const n=ic();if(n||Ms){let r=Ms?Ms._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return s&&xe(e)?e.call(n&&n.proxy):e}}function Bd(){return!!(ic()||Ms)}const Vl={},Hl=()=>Object.create(Vl),ql=t=>Object.getPrototypeOf(t)===Vl;function Vd(t,e,s,n=!1){const r={},i=Hl();t.propsDefaults=Object.create(null),Gl(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);s?t.props=n?r:Cl(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function Hd(t,e,s,n){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,c=Pe(r),[l]=t.propsOptions;let u=!1;if((n||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let f=0;f<d.length;f++){let h=d[f];if(Ir(t.emitsOptions,h))continue;const p=e[h];if(l)if(Ie(i,h))p!==i[h]&&(i[h]=p,u=!0);else{const g=Ut(h);r[g]=wi(l,c,g,p,t,!1)}else p!==i[h]&&(i[h]=p,u=!0)}}}else{Gl(t,e,r,i)&&(u=!0);let d;for(const f in c)(!e||!Ie(e,f)&&((d=Es(f))===f||!Ie(e,d)))&&(l?s&&(s[f]!==void 0||s[d]!==void 0)&&(r[f]=wi(l,c,f,void 0,t,!0)):delete r[f]);if(i!==c)for(const f in i)(!e||!Ie(e,f))&&(delete i[f],u=!0)}u&&rs(t.attrs,"set","")}function Gl(t,e,s,n){const[r,i]=t.propsOptions;let o=!1,c;if(e)for(let l in e){if(_n(l))continue;const u=e[l];let d;r&&Ie(r,d=Ut(l))?!i||!i.includes(d)?s[d]=u:(c||(c={}))[d]=u:Ir(t.emitsOptions,l)||(!(l in n)||u!==n[l])&&(n[l]=u,o=!0)}if(i){const l=Pe(s),u=c||Ne;for(let d=0;d<i.length;d++){const f=i[d];s[f]=wi(r,l,f,u[f],t,!Ie(u,f))}}return o}function wi(t,e,s,n,r,i){const o=t[s];if(o!=null){const c=Ie(o,"default");if(c&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&xe(l)){const{propsDefaults:u}=r;if(s in u)n=u[s];else{const d=Hn(r);n=u[s]=l.call(null,e),d()}}else n=l;r.ce&&r.ce._setProp(s,n)}o[0]&&(i&&!c?n=!1:o[1]&&(n===""||n===Es(s))&&(n=!0))}return n}const qd=new WeakMap;function Kl(t,e,s=!1){const n=s?qd:e.propsCache,r=n.get(t);if(r)return r;const i=t.props,o={},c=[];let l=!1;if(!xe(t)){const d=f=>{l=!0;const[h,p]=Kl(f,e,!0);ht(o,h),p&&c.push(...p)};!s&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!i&&!l)return De(t)&&n.set(t,en),en;if(ve(i))for(let d=0;d<i.length;d++){const f=Ut(i[d]);Bo(f)&&(o[f]=Ne)}else if(i)for(const d in i){const f=Ut(d);if(Bo(f)){const h=i[d],p=o[f]=ve(h)||xe(h)?{type:h}:ht({},h),g=p.type;let v=!1,k=!0;if(ve(g))for(let P=0;P<g.length;++P){const R=g[P],S=xe(R)&&R.name;if(S==="Boolean"){v=!0;break}else S==="String"&&(k=!1)}else v=xe(g)&&g.name==="Boolean";p[0]=v,p[1]=k,(v||Ie(p,"default"))&&c.push(f)}}const u=[o,c];return De(t)&&n.set(t,u),u}function Bo(t){return t[0]!=="$"&&!_n(t)}const ao=t=>t==="_"||t==="_ctx"||t==="$stable",lo=t=>ve(t)?t.map(Jt):[Jt(t)],Gd=(t,e,s)=>{if(e._n)return e;const n=Ge((...r)=>lo(e(...r)),s);return n._c=!1,n},Wl=(t,e,s)=>{const n=t._ctx;for(const r in t){if(ao(r))continue;const i=t[r];if(xe(i))e[r]=Gd(r,i,n);else if(i!=null){const o=lo(i);e[r]=()=>o}}},Jl=(t,e)=>{const s=lo(e);t.slots.default=()=>s},zl=(t,e,s)=>{for(const n in e)(s||!ao(n))&&(t[n]=e[n])},Kd=(t,e,s)=>{const n=t.slots=Hl();if(t.vnode.shapeFlag&32){const r=e._;r?(zl(n,e,s),s&&ol(n,"_",r,!0)):Wl(e,n)}else e&&Jl(t,e)},Wd=(t,e,s)=>{const{vnode:n,slots:r}=t;let i=!0,o=Ne;if(n.shapeFlag&32){const c=e._;c?s&&c===1?i=!1:zl(r,e,s):(i=!e.$stable,Wl(e,r)),o=e}else e&&(Jl(t,e),o={default:1});if(i)for(const c in r)!ao(c)&&o[c]==null&&delete r[c]},At=cf;function Jd(t){return zd(t)}function zd(t,e){const s=$r();s.__VUE__=!0;const{insert:n,remove:r,patchProp:i,createElement:o,createText:c,createComment:l,setText:u,setElementText:d,parentNode:f,nextSibling:h,setScopeId:p=Yt,insertStaticContent:g}=t,v=(b,w,O,M=null,V=null,H=null,se=void 0,ee=null,E=!!w.dynamicChildren)=>{if(b===w)return;b&&!gn(b,w)&&(M=m(b),Te(b,V,H,!0),b=null),w.patchFlag===-2&&(E=!1,w.dynamicChildren=null);const{type:y,ref:L,shapeFlag:F}=w;switch(y){case Nr:k(b,w,O,M);break;case Ss:P(b,w,O,M);break;case lr:b==null&&R(w,O,M,se);break;case Re:J(b,w,O,M,V,H,se,ee,E);break;default:F&1?j(b,w,O,M,V,H,se,ee,E):F&6?ce(b,w,O,M,V,H,se,ee,E):(F&64||F&128)&&y.process(b,w,O,M,V,H,se,ee,E,te)}L!=null&&V?Sn(L,b&&b.ref,H,w||b,!w):L==null&&b&&b.ref!=null&&Sn(b.ref,null,H,b,!0)},k=(b,w,O,M)=>{if(b==null)n(w.el=c(w.children),O,M);else{const V=w.el=b.el;w.children!==b.children&&u(V,w.children)}},P=(b,w,O,M)=>{b==null?n(w.el=l(w.children||""),O,M):w.el=b.el},R=(b,w,O,M)=>{[b.el,b.anchor]=g(b.children,w,O,M,b.el,b.anchor)},S=({el:b,anchor:w},O,M)=>{let V;for(;b&&b!==w;)V=h(b),n(b,O,M),b=V;n(w,O,M)},x=({el:b,anchor:w})=>{let O;for(;b&&b!==w;)O=h(b),r(b),b=O;r(w)},j=(b,w,O,M,V,H,se,ee,E)=>{w.type==="svg"?se="svg":w.type==="math"&&(se="mathml"),b==null?I(w,O,M,V,H,se,ee,E):B(b,w,V,H,se,ee,E)},I=(b,w,O,M,V,H,se,ee)=>{let E,y;const{props:L,shapeFlag:F,transition:W,dirs:ue}=b;if(E=b.el=o(b.type,H,L&&L.is,L),F&8?d(E,b.children):F&16&&U(b.children,E,null,M,V,Xr(b,H),se,ee),ue&&Ts(b,null,M,"created"),_(E,b,b.scopeId,se,M),L){for(const be in L)be!=="value"&&!_n(be)&&i(E,be,null,L[be],H,M);"value"in L&&i(E,"value",null,L.value,H),(y=L.onVnodeBeforeMount)&&Kt(y,M,b)}ue&&Ts(b,null,M,"beforeMount");const he=Yd(V,W);he&&W.beforeEnter(E),n(E,w,O),((y=L&&L.onVnodeMounted)||he||ue)&&At(()=>{y&&Kt(y,M,b),he&&W.enter(E),ue&&Ts(b,null,M,"mounted")},V)},_=(b,w,O,M,V)=>{if(O&&p(b,O),M)for(let H=0;H<M.length;H++)p(b,M[H]);if(V){let H=V.subTree;if(w===H||tc(H.type)&&(H.ssContent===w||H.ssFallback===w)){const se=V.vnode;_(b,se,se.scopeId,se.slotScopeIds,V.parent)}}},U=(b,w,O,M,V,H,se,ee,E=0)=>{for(let y=E;y<b.length;y++){const L=b[y]=ee?vs(b[y]):Jt(b[y]);v(null,L,w,O,M,V,H,se,ee)}},B=(b,w,O,M,V,H,se)=>{const ee=w.el=b.el;let{patchFlag:E,dynamicChildren:y,dirs:L}=w;E|=b.patchFlag&16;const F=b.props||Ne,W=w.props||Ne;let ue;if(O&&$s(O,!1),(ue=W.onVnodeBeforeUpdate)&&Kt(ue,O,w,b),L&&Ts(w,b,O,"beforeUpdate"),O&&$s(O,!0),(F.innerHTML&&W.innerHTML==null||F.textContent&&W.textContent==null)&&d(ee,""),y?G(b.dynamicChildren,y,ee,O,M,Xr(w,V),H):se||re(b,w,ee,null,O,M,Xr(w,V),H,!1),E>0){if(E&16)K(ee,F,W,O,V);else if(E&2&&F.class!==W.class&&i(ee,"class",null,W.class,V),E&4&&i(ee,"style",F.style,W.style,V),E&8){const he=w.dynamicProps;for(let be=0;be<he.length;be++){const Oe=he[be],nt=F[Oe],rt=W[Oe];(rt!==nt||Oe==="value")&&i(ee,Oe,nt,rt,V,O)}}E&1&&b.children!==w.children&&d(ee,w.children)}else!se&&y==null&&K(ee,F,W,O,V);((ue=W.onVnodeUpdated)||L)&&At(()=>{ue&&Kt(ue,O,w,b),L&&Ts(w,b,O,"updated")},M)},G=(b,w,O,M,V,H,se)=>{for(let ee=0;ee<w.length;ee++){const E=b[ee],y=w[ee],L=E.el&&(E.type===Re||!gn(E,y)||E.shapeFlag&198)?f(E.el):O;v(E,y,L,null,M,V,H,se,!0)}},K=(b,w,O,M,V)=>{if(w!==O){if(w!==Ne)for(const H in w)!_n(H)&&!(H in O)&&i(b,H,w[H],null,V,M);for(const H in O){if(_n(H))continue;const se=O[H],ee=w[H];se!==ee&&H!=="value"&&i(b,H,ee,se,V,M)}"value"in O&&i(b,"value",w.value,O.value,V)}},J=(b,w,O,M,V,H,se,ee,E)=>{const y=w.el=b?b.el:c(""),L=w.anchor=b?b.anchor:c("");let{patchFlag:F,dynamicChildren:W,slotScopeIds:ue}=w;ue&&(ee=ee?ee.concat(ue):ue),b==null?(n(y,O,M),n(L,O,M),U(w.children||[],O,L,V,H,se,ee,E)):F>0&&F&64&&W&&b.dynamicChildren?(G(b.dynamicChildren,W,O,V,H,se,ee),(w.key!=null||V&&w===V.subTree)&&Yl(b,w,!0)):re(b,w,O,L,V,H,se,ee,E)},ce=(b,w,O,M,V,H,se,ee,E)=>{w.slotScopeIds=ee,b==null?w.shapeFlag&512?V.ctx.activate(w,O,M,se,E):ge(w,O,M,V,H,se,E):Se(b,w,E)},ge=(b,w,O,M,V,H,se)=>{const ee=b.component=gf(b,M,V);if(Dl(b)&&(ee.ctx.renderer=te),vf(ee,!1,se),ee.asyncDep){if(V&&V.registerDep(ee,Ae,se),!b.el){const E=ee.subTree=Q(Ss);P(null,E,w,O),b.placeholder=E.el}}else Ae(ee,b,w,O,V,H,se)},Se=(b,w,O)=>{const M=w.component=b.component;if(af(b,w,O))if(M.asyncDep&&!M.asyncResolved){fe(M,w,O);return}else M.next=w,M.update();else w.el=b.el,M.vnode=w},Ae=(b,w,O,M,V,H,se)=>{const ee=()=>{if(b.isMounted){let{next:F,bu:W,u:ue,parent:he,vnode:be}=b;{const wt=Xl(b);if(wt){F&&(F.el=be.el,fe(b,F,se)),wt.asyncDep.then(()=>{b.isUnmounted||ee()});return}}let Oe=F,nt;$s(b,!1),F?(F.el=be.el,fe(b,F,se)):F=be,W&&or(W),(nt=F.props&&F.props.onVnodeBeforeUpdate)&&Kt(nt,he,F,be),$s(b,!0);const rt=Ho(b),kt=b.subTree;b.subTree=rt,v(kt,rt,f(kt.el),m(kt),b,V,H),F.el=rt.el,Oe===null&&lf(b,rt.el),ue&&At(ue,V),(nt=F.props&&F.props.onVnodeUpdated)&&At(()=>Kt(nt,he,F,be),V)}else{let F;const{el:W,props:ue}=w,{bm:he,m:be,parent:Oe,root:nt,type:rt}=b,kt=kn(w);$s(b,!1),he&&or(he),!kt&&(F=ue&&ue.onVnodeBeforeMount)&&Kt(F,Oe,w),$s(b,!0);{nt.ce&&nt.ce._def.shadowRoot!==!1&&nt.ce._injectChildStyle(rt);const wt=b.subTree=Ho(b);v(null,wt,O,M,b,V,H),w.el=wt.el}if(be&&At(be,V),!kt&&(F=ue&&ue.onVnodeMounted)){const wt=w;At(()=>Kt(F,Oe,wt),V)}(w.shapeFlag&256||Oe&&kn(Oe.vnode)&&Oe.vnode.shapeFlag&256)&&b.a&&At(b.a,V),b.isMounted=!0,w=O=M=null}};b.scope.on();const E=b.effect=new hl(ee);b.scope.off();const y=b.update=E.run.bind(E),L=b.job=E.runIfDirty.bind(E);L.i=b,L.id=b.uid,E.scheduler=()=>so(L),$s(b,!0),y()},fe=(b,w,O)=>{w.component=b;const M=b.vnode.props;b.vnode=w,b.next=null,Hd(b,w.props,M,O),Wd(b,w.children,O),ls(),jo(b),cs()},re=(b,w,O,M,V,H,se,ee,E=!1)=>{const y=b&&b.children,L=b?b.shapeFlag:0,F=w.children,{patchFlag:W,shapeFlag:ue}=w;if(W>0){if(W&128){Ee(y,F,O,M,V,H,se,ee,E);return}else if(W&256){we(y,F,O,M,V,H,se,ee,E);return}}ue&8?(L&16&&A(y,V,H),F!==y&&d(O,F)):L&16?ue&16?Ee(y,F,O,M,V,H,se,ee,E):A(y,V,H,!0):(L&8&&d(O,""),ue&16&&U(F,O,M,V,H,se,ee,E))},we=(b,w,O,M,V,H,se,ee,E)=>{b=b||en,w=w||en;const y=b.length,L=w.length,F=Math.min(y,L);let W;for(W=0;W<F;W++){const ue=w[W]=E?vs(w[W]):Jt(w[W]);v(b[W],ue,O,null,V,H,se,ee,E)}y>L?A(b,V,H,!0,!1,F):U(w,O,M,V,H,se,ee,E,F)},Ee=(b,w,O,M,V,H,se,ee,E)=>{let y=0;const L=w.length;let F=b.length-1,W=L-1;for(;y<=F&&y<=W;){const ue=b[y],he=w[y]=E?vs(w[y]):Jt(w[y]);if(gn(ue,he))v(ue,he,O,null,V,H,se,ee,E);else break;y++}for(;y<=F&&y<=W;){const ue=b[F],he=w[W]=E?vs(w[W]):Jt(w[W]);if(gn(ue,he))v(ue,he,O,null,V,H,se,ee,E);else break;F--,W--}if(y>F){if(y<=W){const ue=W+1,he=ue<L?w[ue].el:M;for(;y<=W;)v(null,w[y]=E?vs(w[y]):Jt(w[y]),O,he,V,H,se,ee,E),y++}}else if(y>W)for(;y<=F;)Te(b[y],V,H,!0),y++;else{const ue=y,he=y,be=new Map;for(y=he;y<=W;y++){const oe=w[y]=E?vs(w[y]):Jt(w[y]);oe.key!=null&&be.set(oe.key,y)}let Oe,nt=0;const rt=W-he+1;let kt=!1,wt=0;const fs=new Array(rt);for(y=0;y<rt;y++)fs[y]=0;for(y=ue;y<=F;y++){const oe=b[y];if(nt>=rt){Te(oe,V,H,!0);continue}let Ce;if(oe.key!=null)Ce=be.get(oe.key);else for(Oe=he;Oe<=W;Oe++)if(fs[Oe-he]===0&&gn(oe,w[Oe])){Ce=Oe;break}Ce===void 0?Te(oe,V,H,!0):(fs[Ce-he]=y+1,Ce>=wt?wt=Ce:kt=!0,v(oe,w[Ce],O,null,V,H,se,ee,E),nt++)}const Y=kt?Xd(fs):en;for(Oe=Y.length-1,y=rt-1;y>=0;y--){const oe=he+y,Ce=w[oe],Ke=w[oe+1],Je=oe+1<L?Ke.el||Ke.placeholder:M;fs[y]===0?v(null,Ce,O,Je,V,H,se,ee,E):kt&&(Oe<0||y!==Y[Oe]?_e(Ce,O,Je,2):Oe--)}}},_e=(b,w,O,M,V=null)=>{const{el:H,type:se,transition:ee,children:E,shapeFlag:y}=b;if(y&6){_e(b.component.subTree,w,O,M);return}if(y&128){b.suspense.move(w,O,M);return}if(y&64){se.move(b,w,O,te);return}if(se===Re){n(H,w,O);for(let F=0;F<E.length;F++)_e(E[F],w,O,M);n(b.anchor,w,O);return}if(se===lr){S(b,w,O);return}if(M!==2&&y&1&&ee)if(M===0)ee.beforeEnter(H),n(H,w,O),At(()=>ee.enter(H),V);else{const{leave:F,delayLeave:W,afterLeave:ue}=ee,he=()=>{b.ctx.isUnmounted?r(H):n(H,w,O)},be=()=>{H._isLeaving&&H[bd](!0),F(H,()=>{he(),ue&&ue()})};W?W(H,he,be):be()}else n(H,w,O)},Te=(b,w,O,M=!1,V=!1)=>{const{type:H,props:se,ref:ee,children:E,dynamicChildren:y,shapeFlag:L,patchFlag:F,dirs:W,cacheIndex:ue}=b;if(F===-2&&(V=!1),ee!=null&&(ls(),Sn(ee,null,O,b,!0),cs()),ue!=null&&(w.renderCache[ue]=void 0),L&256){w.ctx.deactivate(b);return}const he=L&1&&W,be=!kn(b);let Oe;if(be&&(Oe=se&&se.onVnodeBeforeUnmount)&&Kt(Oe,w,b),L&6)N(b.component,O,M);else{if(L&128){b.suspense.unmount(O,M);return}he&&Ts(b,null,w,"beforeUnmount"),L&64?b.type.remove(b,w,O,te,M):y&&!y.hasOnce&&(H!==Re||F>0&&F&64)?A(y,w,O,!1,!0):(H===Re&&F&384||!V&&L&16)&&A(E,w,O),M&&Ue(b)}(be&&(Oe=se&&se.onVnodeUnmounted)||he)&&At(()=>{Oe&&Kt(Oe,w,b),he&&Ts(b,null,w,"unmounted")},O)},Ue=b=>{const{type:w,el:O,anchor:M,transition:V}=b;if(w===Re){Z(O,M);return}if(w===lr){x(b);return}const H=()=>{r(O),V&&!V.persisted&&V.afterLeave&&V.afterLeave()};if(b.shapeFlag&1&&V&&!V.persisted){const{leave:se,delayLeave:ee}=V,E=()=>se(O,H);ee?ee(b.el,H,E):E()}else H()},Z=(b,w)=>{let O;for(;b!==w;)O=h(b),r(b),b=O;r(w)},N=(b,w,O)=>{const{bum:M,scope:V,job:H,subTree:se,um:ee,m:E,a:y}=b;Vo(E),Vo(y),M&&or(M),V.stop(),H&&(H.flags|=8,Te(se,b,w,O)),ee&&At(ee,w),At(()=>{b.isUnmounted=!0},w)},A=(b,w,O,M=!1,V=!1,H=0)=>{for(let se=H;se<b.length;se++)Te(b[se],w,O,M,V)},m=b=>{if(b.shapeFlag&6)return m(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const w=h(b.anchor||b.el),O=w&&w[vd];return O?h(O):w};let $=!1;const q=(b,w,O)=>{b==null?w._vnode&&Te(w._vnode,null,null,!0):v(w._vnode||null,b,w,null,null,null,O),w._vnode=b,$||($=!0,jo(),Rl(),$=!1)},te={p:v,um:Te,m:_e,r:Ue,mt:ge,mc:U,pc:re,pbc:G,n:m,o:t};return{render:q,hydrate:void 0,createApp:Md(q)}}function Xr({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function $s({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Yd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Yl(t,e,s=!1){const n=t.children,r=e.children;if(ve(n)&&ve(r))for(let i=0;i<n.length;i++){const o=n[i];let c=r[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=r[i]=vs(r[i]),c.el=o.el),!s&&c.patchFlag!==-2&&Yl(o,c)),c.type===Nr&&c.patchFlag!==-1&&(c.el=o.el),c.type===Ss&&!c.el&&(c.el=o.el)}}function Xd(t){const e=t.slice(),s=[0];let n,r,i,o,c;const l=t.length;for(n=0;n<l;n++){const u=t[n];if(u!==0){if(r=s[s.length-1],t[r]<u){e[n]=r,s.push(n);continue}for(i=0,o=s.length-1;i<o;)c=i+o>>1,t[s[c]]<u?i=c+1:o=c;u<t[s[i]]&&(i>0&&(e[n]=s[i-1]),s[i]=n)}}for(i=s.length,o=s[i-1];i-- >0;)s[i]=o,o=e[o];return s}function Xl(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Xl(e)}function Vo(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Qd=Symbol.for("v-scx"),Zd=()=>Ht(Qd);function qe(t,e,s){return Ql(t,e,s)}function Ql(t,e,s=Ne){const{immediate:n,deep:r,flush:i,once:o}=s,c=ht({},s),l=e&&n||!e&&i!=="post";let u;if(Nn){if(i==="sync"){const p=Zd();u=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=Yt,p.resume=Yt,p.pause=Yt,p}}const d=ft;c.call=(p,g,v)=>Qt(p,d,g,v);let f=!1;i==="post"?c.scheduler=p=>{At(p,d&&d.suspense)}:i!=="sync"&&(f=!0,c.scheduler=(p,g)=>{g?p():so(p)}),c.augmentJob=p=>{e&&(p.flags|=4),f&&(p.flags|=2,d&&(p.id=d.uid,p.i=d))};const h=hd(t,e,c);return Nn&&(u?u.push(h):l&&h()),h}function ef(t,e,s){const n=this.proxy,r=Xe(t)?t.includes(".")?Zl(n,t):()=>n[t]:t.bind(n,n);let i;xe(e)?i=e:(i=e.handler,s=e);const o=Hn(this),c=Ql(r,i.bind(n),s);return o(),c}function Zl(t,e){const s=e.split(".");return()=>{let n=t;for(let r=0;r<s.length&&n;r++)n=n[s[r]];return n}}const tf=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Ut(e)}Modifiers`]||t[`${Es(e)}Modifiers`];function sf(t,e,...s){if(t.isUnmounted)return;const n=t.vnode.props||Ne;let r=s;const i=e.startsWith("update:"),o=i&&tf(n,e.slice(7));o&&(o.trim&&(r=s.map(d=>Xe(d)?d.trim():d)),o.number&&(r=s.map(dr)));let c,l=n[c=Gr(e)]||n[c=Gr(Ut(e))];!l&&i&&(l=n[c=Gr(Es(e))]),l&&Qt(l,t,6,r);const u=n[c+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[c])return;t.emitted[c]=!0,Qt(u,t,6,r)}}const nf=new WeakMap;function ec(t,e,s=!1){const n=s?nf:e.emitsCache,r=n.get(t);if(r!==void 0)return r;const i=t.emits;let o={},c=!1;if(!xe(t)){const l=u=>{const d=ec(u,e,!0);d&&(c=!0,ht(o,d))};!s&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!c?(De(t)&&n.set(t,null),null):(ve(i)?i.forEach(l=>o[l]=null):ht(o,i),De(t)&&n.set(t,o),o)}function Ir(t,e){return!t||!Cr(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ie(t,e[0].toLowerCase()+e.slice(1))||Ie(t,Es(e))||Ie(t,e))}function Ho(t){const{type:e,vnode:s,proxy:n,withProxy:r,propsOptions:[i],slots:o,attrs:c,emit:l,render:u,renderCache:d,props:f,data:h,setupState:p,ctx:g,inheritAttrs:v}=t,k=gr(t);let P,R;try{if(s.shapeFlag&4){const x=r||n,j=x;P=Jt(u.call(j,x,d,f,p,h,g)),R=c}else{const x=e;P=Jt(x.length>1?x(f,{attrs:c,slots:o,emit:l}):x(f,null)),R=e.props?c:rf(c)}}catch(x){En.length=0,Rr(x,t,1),P=Q(Ss)}let S=P;if(R&&v!==!1){const x=Object.keys(R),{shapeFlag:j}=S;x.length&&j&7&&(i&&x.some(qi)&&(R=of(R,i)),S=rn(S,R,!1,!0))}return s.dirs&&(S=rn(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(s.dirs):s.dirs),s.transition&&no(S,s.transition),P=S,gr(k),P}const rf=t=>{let e;for(const s in t)(s==="class"||s==="style"||Cr(s))&&((e||(e={}))[s]=t[s]);return e},of=(t,e)=>{const s={};for(const n in t)(!qi(n)||!(n.slice(9)in e))&&(s[n]=t[n]);return s};function af(t,e,s){const{props:n,children:r,component:i}=t,{props:o,children:c,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return n?qo(n,o,u):!!o;if(l&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const h=d[f];if(o[h]!==n[h]&&!Ir(u,h))return!0}}}else return(r||c)&&(!c||!c.$stable)?!0:n===o?!1:n?o?qo(n,o,u):!0:!!o;return!1}function qo(t,e,s){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let r=0;r<n.length;r++){const i=n[r];if(e[i]!==t[i]&&!Ir(s,i))return!0}return!1}function lf({vnode:t,parent:e},s){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=s,e=e.parent;else break}}const tc=t=>t.__isSuspense;function cf(t,e){e&&e.pendingBranch?ve(t)?e.effects.push(...t):e.effects.push(t):gd(t)}const Re=Symbol.for("v-fgt"),Nr=Symbol.for("v-txt"),Ss=Symbol.for("v-cmt"),lr=Symbol.for("v-stc"),En=[];let Tt=null;function C(t=!1){En.push(Tt=t?null:[])}function uf(){En.pop(),Tt=En[En.length-1]||null}let In=1;function br(t,e=!1){In+=t,t<0&&Tt&&e&&(Tt.hasOnce=!0)}function sc(t){return t.dynamicChildren=In>0?Tt||en:null,uf(),In>0&&Tt&&Tt.push(t),t}function T(t,e,s,n,r,i){return sc(a(t,e,s,n,r,i,!0))}function co(t,e,s,n,r){return sc(Q(t,e,s,n,r,!0))}function _r(t){return t?t.__v_isVNode===!0:!1}function gn(t,e){return t.type===e.type&&t.key===e.key}const nc=({key:t})=>t??null,cr=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?Xe(t)||We(t)||xe(t)?{i:Ot,r:t,k:e,f:!!s}:t:null);function a(t,e=null,s=null,n=0,r=null,i=t===Re?0:1,o=!1,c=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&nc(e),ref:e&&cr(e),scopeId:jl,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Ot};return c?(uo(l,s),i&128&&t.normalize(l)):s&&(l.shapeFlag|=Xe(s)?8:16),In>0&&!o&&Tt&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Tt.push(l),l}const Q=df;function df(t,e=null,s=null,n=0,r=null,i=!1){if((!t||t===Pd)&&(t=Ss),_r(t)){const c=rn(t,e,!0);return s&&uo(c,s),In>0&&!i&&Tt&&(c.shapeFlag&6?Tt[Tt.indexOf(t)]=c:Tt.push(c)),c.patchFlag=-2,c}if(xf(t)&&(t=t.__vccOpts),e){e=ff(e);let{class:c,style:l}=e;c&&!Xe(c)&&(e.class=it(c)),De(l)&&(eo(l)&&!ve(l)&&(l=ht({},l)),e.style=as(l))}const o=Xe(t)?1:tc(t)?128:yd(t)?64:De(t)?4:xe(t)?2:0;return a(t,e,s,n,r,o,i,!0)}function ff(t){return t?eo(t)||ql(t)?ht({},t):t:null}function rn(t,e,s=!1,n=!1){const{props:r,ref:i,patchFlag:o,children:c,transition:l}=t,u=e?hf(r||{},e):r,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&nc(u),ref:e&&e.ref?s&&i?ve(i)?i.concat(cr(e)):[i,cr(e)]:cr(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:c,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Re?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&rn(t.ssContent),ssFallback:t.ssFallback&&rn(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&no(d,l.clone(d)),d}function X(t=" ",e=0){return Q(Nr,null,t,e)}function rc(t,e){const s=Q(lr,null,t);return s.staticCount=e,s}function me(t="",e=!1){return e?(C(),co(Ss,null,t)):Q(Ss,null,t)}function Jt(t){return t==null||typeof t=="boolean"?Q(Ss):ve(t)?Q(Re,null,t.slice()):_r(t)?vs(t):Q(Nr,null,String(t))}function vs(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:rn(t)}function uo(t,e){let s=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(ve(e))s=16;else if(typeof e=="object")if(n&65){const r=e.default;r&&(r._c&&(r._d=!1),uo(t,r()),r._c&&(r._d=!0));return}else{s=32;const r=e._;!r&&!ql(e)?e._ctx=Ot:r===3&&Ot&&(Ot.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else xe(e)?(e={default:e,_ctx:Ot},s=32):(e=String(e),n&64?(s=16,e=[X(e)]):s=8);t.children=e,t.shapeFlag|=s}function hf(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const r in n)if(r==="class")e.class!==n.class&&(e.class=it([e.class,n.class]));else if(r==="style")e.style=as([e.style,n.style]);else if(Cr(r)){const i=e[r],o=n[r];o&&i!==o&&!(ve(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=n[r])}return e}function Kt(t,e,s,n=null){Qt(t,e,7,[s,n])}const pf=Bl();let mf=0;function gf(t,e,s){const n=t.type,r=(e?e.appContext:t.appContext)||pf,i={uid:mf++,vnode:t,type:n,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ul(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Kl(n,r),emitsOptions:ec(n,r),emit:null,emitted:null,propsDefaults:Ne,inheritAttrs:n.inheritAttrs,ctx:Ne,data:Ne,props:Ne,attrs:Ne,slots:Ne,refs:Ne,setupState:Ne,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=sf.bind(null,i),t.ce&&t.ce(i),i}let ft=null;const ic=()=>ft||Ot;let wr,xi;{const t=$r(),e=(s,n)=>{let r;return(r=t[s])||(r=t[s]=[]),r.push(n),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};wr=e("__VUE_INSTANCE_SETTERS__",s=>ft=s),xi=e("__VUE_SSR_SETTERS__",s=>Nn=s)}const Hn=t=>{const e=ft;return wr(t),t.scope.on(),()=>{t.scope.off(),wr(e)}},Go=()=>{ft&&ft.scope.off(),wr(null)};function oc(t){return t.vnode.shapeFlag&4}let Nn=!1;function vf(t,e=!1,s=!1){e&&xi(e);const{props:n,children:r}=t.vnode,i=oc(t);Vd(t,n,i,e),Kd(t,r,s||e);const o=i?yf(t,e):void 0;return e&&xi(!1),o}function yf(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Ud);const{setup:n}=s;if(n){ls();const r=t.setupContext=n.length>1?_f(t):null,i=Hn(t),o=Vn(n,t,0,[t.props,r]),c=nl(o);if(cs(),i(),(c||t.sp)&&!kn(t)&&Nl(t),c){if(o.then(Go,Go),e)return o.then(l=>{Ko(t,l)}).catch(l=>{Rr(l,t,0)});t.asyncDep=o}else Ko(t,o)}else ac(t)}function Ko(t,e,s){xe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:De(e)&&(t.setupState=Tl(e)),ac(t)}function ac(t,e,s){const n=t.type;t.render||(t.render=n.render||Yt);{const r=Hn(t);ls();try{jd(t)}finally{cs(),r()}}}const bf={get(t,e){return dt(t,"get",""),t[e]}};function _f(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,bf),slots:t.slots,emit:t.emit,expose:e}}function Dr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Tl(to(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in An)return An[s](t)},has(e,s){return s in e||s in An}})):t.proxy}function wf(t,e=!0){return xe(t)?t.displayName||t.name:t.name||e&&t.__name}function xf(t){return xe(t)&&"__vccOpts"in t}const ie=(t,e)=>dd(t,e,Nn);function lc(t,e,s){try{br(-1);const n=arguments.length;return n===2?De(e)&&!ve(e)?_r(e)?Q(t,null,[e]):Q(t,e):Q(t,null,e):(n>3?s=Array.prototype.slice.call(arguments,2):n===3&&_r(s)&&(s=[s]),Q(t,e,s))}finally{br(1)}}const Sf="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Si;const Wo=typeof window<"u"&&window.trustedTypes;if(Wo)try{Si=Wo.createPolicy("vue",{createHTML:t=>t})}catch{}const cc=Si?t=>Si.createHTML(t):t=>t,kf="http://www.w3.org/2000/svg",Af="http://www.w3.org/1998/Math/MathML",ss=typeof document<"u"?document:null,Jo=ss&&ss.createElement("template"),Ef={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,n)=>{const r=e==="svg"?ss.createElementNS(kf,t):e==="mathml"?ss.createElementNS(Af,t):s?ss.createElement(t,{is:s}):ss.createElement(t);return t==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:t=>ss.createTextNode(t),createComment:t=>ss.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ss.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,n,r,i){const o=s?s.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),s),!(r===i||!(r=r.nextSibling)););else{Jo.innerHTML=cc(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const c=Jo.content;if(n==="svg"||n==="mathml"){const l=c.firstChild;for(;l.firstChild;)c.appendChild(l.firstChild);c.removeChild(l)}e.insertBefore(c,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},Cf=Symbol("_vtc");function Of(t,e,s){const n=t[Cf];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const zo=Symbol("_vod"),Tf=Symbol("_vsh"),$f=Symbol(""),Pf=/(?:^|;)\s*display\s*:/;function Rf(t,e,s){const n=t.style,r=Xe(s);let i=!1;if(s&&!r){if(e)if(Xe(e))for(const o of e.split(";")){const c=o.slice(0,o.indexOf(":")).trim();s[c]==null&&ur(n,c,"")}else for(const o in e)s[o]==null&&ur(n,o,"");for(const o in s)o==="display"&&(i=!0),ur(n,o,s[o])}else if(r){if(e!==s){const o=n[$f];o&&(s+=";"+o),n.cssText=s,i=Pf.test(s)}}else e&&t.removeAttribute("style");zo in t&&(t[zo]=i?n.display:"",t[Tf]&&(n.display="none"))}const Yo=/\s*!important$/;function ur(t,e,s){if(ve(s))s.forEach(n=>ur(t,e,n));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const n=Uf(t,e);Yo.test(s)?t.setProperty(Es(n),s.replace(Yo,""),"important"):t[n]=s}}const Xo=["Webkit","Moz","ms"],Qr={};function Uf(t,e){const s=Qr[e];if(s)return s;let n=Ut(e);if(n!=="filter"&&n in t)return Qr[e]=n;n=Tr(n);for(let r=0;r<Xo.length;r++){const i=Xo[r]+n;if(i in t)return Qr[e]=i}return e}const Qo="http://www.w3.org/1999/xlink";function Zo(t,e,s,n,r,i=Nu(e)){n&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(Qo,e.slice(6,e.length)):t.setAttributeNS(Qo,e,s):s==null||i&&!al(s)?t.removeAttribute(e):t.setAttribute(e,i?"":Xt(s)?String(s):s)}function ea(t,e,s,n,r){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?cc(s):s);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?t.getAttribute("value")||"":t.value,l=s==null?t.type==="checkbox"?"on":"":String(s);(c!==l||!("_value"in t))&&(t.value=l),s==null&&t.removeAttribute(e),t._value=s;return}let o=!1;if(s===""||s==null){const c=typeof t[e];c==="boolean"?s=al(s):s==null&&c==="string"?(s="",o=!0):c==="number"&&(s=0,o=!0)}try{t[e]=s}catch{}o&&t.removeAttribute(r||e)}function os(t,e,s,n){t.addEventListener(e,s,n)}function jf(t,e,s,n){t.removeEventListener(e,s,n)}const ta=Symbol("_vei");function If(t,e,s,n,r=null){const i=t[ta]||(t[ta]={}),o=i[e];if(n&&o)o.value=n;else{const[c,l]=Nf(e);if(n){const u=i[e]=Ff(n,r);os(t,c,u,l)}else o&&(jf(t,c,o,l),i[e]=void 0)}}const sa=/(?:Once|Passive|Capture)$/;function Nf(t){let e;if(sa.test(t)){e={};let n;for(;n=t.match(sa);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Es(t.slice(2)),e]}let Zr=0;const Df=Promise.resolve(),Lf=()=>Zr||(Df.then(()=>Zr=0),Zr=Date.now());function Ff(t,e){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;Qt(Mf(n,s.value),e,5,[n])};return s.value=t,s.attached=Lf(),s}function Mf(t,e){if(ve(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(n=>r=>!r._stopped&&n&&n(r))}else return e}const na=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Bf=(t,e,s,n,r,i)=>{const o=r==="svg";e==="class"?Of(t,n,o):e==="style"?Rf(t,s,n):Cr(e)?qi(e)||If(t,e,s,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Vf(t,e,n,o))?(ea(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Zo(t,e,n,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Xe(n))?ea(t,Ut(e),n,i,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),Zo(t,e,n,o))};function Vf(t,e,s,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&na(e)&&xe(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return na(e)&&Xe(s)?!1:e in t}const ks=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ve(e)?s=>or(e,s):e};function Hf(t){t.target.composing=!0}function ra(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Rt=Symbol("_assign"),$e={created(t,{modifiers:{lazy:e,trim:s,number:n}},r){t[Rt]=ks(r);const i=n||r.props&&r.props.type==="number";os(t,e?"change":"input",o=>{if(o.target.composing)return;let c=t.value;s&&(c=c.trim()),i&&(c=dr(c)),t[Rt](c)}),s&&os(t,"change",()=>{t.value=t.value.trim()}),e||(os(t,"compositionstart",Hf),os(t,"compositionend",ra),os(t,"change",ra))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:s,modifiers:{lazy:n,trim:r,number:i}},o){if(t[Rt]=ks(o),t.composing)return;const c=(i||t.type==="number")&&!/^0\d/.test(t.value)?dr(t.value):t.value,l=e??"";c!==l&&(document.activeElement===t&&t.type!=="range"&&(n&&e===s||r&&t.value.trim()===l)||(t.value=l))}},zt={deep:!0,created(t,e,s){t[Rt]=ks(s),os(t,"change",()=>{const n=t._modelValue,r=on(t),i=t.checked,o=t[Rt];if(ve(n)){const c=Wi(n,r),l=c!==-1;if(i&&!l)o(n.concat(r));else if(!i&&l){const u=[...n];u.splice(c,1),o(u)}}else if(un(n)){const c=new Set(n);i?c.add(r):c.delete(r),o(c)}else o(uc(t,i))})},mounted:ia,beforeUpdate(t,e,s){t[Rt]=ks(s),ia(t,e,s)}};function ia(t,{value:e,oldValue:s},n){t._modelValue=e;let r;if(ve(e))r=Wi(e,n.props.value)>-1;else if(un(e))r=e.has(n.props.value);else{if(e===s)return;r=Bs(e,uc(t,!0))}t.checked!==r&&(t.checked=r)}const Be={created(t,{value:e},s){t.checked=Bs(e,s.props.value),t[Rt]=ks(s),os(t,"change",()=>{t[Rt](on(t))})},beforeUpdate(t,{value:e,oldValue:s},n){t[Rt]=ks(n),e!==s&&(t.checked=Bs(e,n.props.value))}},As={deep:!0,created(t,{value:e,modifiers:{number:s}},n){const r=un(e);os(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>s?dr(on(o)):on(o));t[Rt](t.multiple?r?new Set(i):i:i[0]),t._assigning=!0,Ur(()=>{t._assigning=!1})}),t[Rt]=ks(n)},mounted(t,{value:e}){oa(t,e)},beforeUpdate(t,e,s){t[Rt]=ks(s)},updated(t,{value:e}){t._assigning||oa(t,e)}};function oa(t,e){const s=t.multiple,n=ve(e);if(!(s&&!n&&!un(e))){for(let r=0,i=t.options.length;r<i;r++){const o=t.options[r],c=on(o);if(s)if(n){const l=typeof c;l==="string"||l==="number"?o.selected=e.some(u=>String(u)===String(c)):o.selected=Wi(e,c)>-1}else o.selected=e.has(c);else if(Bs(on(o),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!s&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function on(t){return"_value"in t?t._value:t.value}function uc(t,e){const s=e?"_trueValue":"_falseValue";return s in t?t[s]:e}const qf={created(t,e,s){Yn(t,e,s,null,"created")},mounted(t,e,s){Yn(t,e,s,null,"mounted")},beforeUpdate(t,e,s,n){Yn(t,e,s,n,"beforeUpdate")},updated(t,e,s,n){Yn(t,e,s,n,"updated")}};function Gf(t,e){switch(t){case"SELECT":return As;case"TEXTAREA":return $e;default:switch(e){case"checkbox":return zt;case"radio":return Be;default:return $e}}}function Yn(t,e,s,n,r){const o=Gf(t.tagName,s.props&&s.props.type)[r];o&&o(t,e,s,n)}const Kf=["ctrl","shift","alt","meta"],Wf={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Kf.some(s=>t[`${s}Key`]&&!e.includes(s))},Ze=(t,e)=>{const s=t._withMods||(t._withMods={}),n=e.join(".");return s[n]||(s[n]=((r,...i)=>{for(let o=0;o<e.length;o++){const c=Wf[e[o]];if(c&&c(r,e))return}return t(r,...i)}))},Jf={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},at=(t,e)=>{const s=t._withKeys||(t._withKeys={}),n=e.join(".");return s[n]||(s[n]=(r=>{if(!("key"in r))return;const i=Es(r.key);if(e.some(o=>o===i||Jf[o]===i))return t(r)}))},zf=ht({patchProp:Bf},Ef);let aa;function Yf(){return aa||(aa=Jd(zf))}const Xf=((...t)=>{const e=Yf().createApp(...t),{mount:s}=e;return e.mount=n=>{const r=Zf(n);if(!r)return;const i=e._component;!xe(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=s(r,!1,Qf(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e});function Qf(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Zf(t){return Xe(t)?document.querySelector(t):t}const eh={__name:"App",setup(t){return(e,s)=>{const n=oo("router-view");return C(),co(n)}}};/*!
 * vue-router v4.6.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const Xs=typeof document<"u";function dc(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function th(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&dc(t.default)}const je=Object.assign;function ei(t,e){const s={};for(const n in e){const r=e[n];s[n]=qt(r)?r.map(t):t(r)}return s}const Cn=()=>{},qt=Array.isArray;function la(t,e){const s={};for(const n in t)s[n]=n in e?e[n]:t[n];return s}const fc=/#/g,sh=/&/g,nh=/\//g,rh=/=/g,ih=/\?/g,hc=/\+/g,oh=/%5B/g,ah=/%5D/g,pc=/%5E/g,lh=/%60/g,mc=/%7B/g,ch=/%7C/g,gc=/%7D/g,uh=/%20/g;function fo(t){return t==null?"":encodeURI(""+t).replace(ch,"|").replace(oh,"[").replace(ah,"]")}function dh(t){return fo(t).replace(mc,"{").replace(gc,"}").replace(pc,"^")}function ki(t){return fo(t).replace(hc,"%2B").replace(uh,"+").replace(fc,"%23").replace(sh,"%26").replace(lh,"`").replace(mc,"{").replace(gc,"}").replace(pc,"^")}function fh(t){return ki(t).replace(rh,"%3D")}function hh(t){return fo(t).replace(fc,"%23").replace(ih,"%3F")}function ph(t){return hh(t).replace(nh,"%2F")}function Dn(t){if(t==null)return null;try{return decodeURIComponent(""+t)}catch{}return""+t}const mh=/\/$/,gh=t=>t.replace(mh,"");function ti(t,e,s="/"){let n,r={},i="",o="";const c=e.indexOf("#");let l=e.indexOf("?");return l=c>=0&&l>c?-1:l,l>=0&&(n=e.slice(0,l),i=e.slice(l,c>0?c:e.length),r=t(i.slice(1))),c>=0&&(n=n||e.slice(0,c),o=e.slice(c,e.length)),n=_h(n??e,s),{fullPath:n+i+o,path:n,query:r,hash:Dn(o)}}function vh(t,e){const s=e.query?t(e.query):"";return e.path+(s&&"?")+s+(e.hash||"")}function ca(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function yh(t,e,s){const n=e.matched.length-1,r=s.matched.length-1;return n>-1&&n===r&&an(e.matched[n],s.matched[r])&&vc(e.params,s.params)&&t(e.query)===t(s.query)&&e.hash===s.hash}function an(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function vc(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(!bh(t[s],e[s]))return!1;return!0}function bh(t,e){return qt(t)?ua(t,e):qt(e)?ua(e,t):t===e}function ua(t,e){return qt(e)?t.length===e.length&&t.every((s,n)=>s===e[n]):t.length===1&&t[0]===e}function _h(t,e){if(t.startsWith("/"))return t;if(!t)return e;const s=e.split("/"),n=t.split("/"),r=n[n.length-1];(r===".."||r===".")&&n.push("");let i=s.length-1,o,c;for(o=0;o<n.length;o++)if(c=n[o],c!==".")if(c==="..")i>1&&i--;else break;return s.slice(0,i).join("/")+"/"+n.slice(o).join("/")}const hs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Ai=(function(t){return t.pop="pop",t.push="push",t})({}),si=(function(t){return t.back="back",t.forward="forward",t.unknown="",t})({});function wh(t){if(!t)if(Xs){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),gh(t)}const xh=/^[^#]+#/;function Sh(t,e){return t.replace(xh,"#")+e}function kh(t,e){const s=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-s.left-(e.left||0),top:n.top-s.top-(e.top||0)}}const Lr=()=>({left:window.scrollX,top:window.scrollY});function Ah(t){let e;if("el"in t){const s=t.el,n=typeof s=="string"&&s.startsWith("#"),r=typeof s=="string"?n?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!r)return;e=kh(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function da(t,e){return(history.state?history.state.position-e:-1)+t}const Ei=new Map;function Eh(t,e){Ei.set(t,e)}function Ch(t){const e=Ei.get(t);return Ei.delete(t),e}function Oh(t){return typeof t=="string"||t&&typeof t=="object"}function yc(t){return typeof t=="string"||typeof t=="symbol"}let He=(function(t){return t[t.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",t[t.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",t[t.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",t[t.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",t[t.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",t})({});const bc=Symbol("");He.MATCHER_NOT_FOUND+"",He.NAVIGATION_GUARD_REDIRECT+"",He.NAVIGATION_ABORTED+"",He.NAVIGATION_CANCELLED+"",He.NAVIGATION_DUPLICATED+"";function ln(t,e){return je(new Error,{type:t,[bc]:!0},e)}function ts(t,e){return t instanceof Error&&bc in t&&(e==null||!!(t.type&e))}const Th=["params","query","hash"];function $h(t){if(typeof t=="string")return t;if(t.path!=null)return t.path;const e={};for(const s of Th)s in t&&(e[s]=t[s]);return JSON.stringify(e,null,2)}function Ph(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let n=0;n<s.length;++n){const r=s[n].replace(hc," "),i=r.indexOf("="),o=Dn(i<0?r:r.slice(0,i)),c=i<0?null:Dn(r.slice(i+1));if(o in e){let l=e[o];qt(l)||(l=e[o]=[l]),l.push(c)}else e[o]=c}return e}function fa(t){let e="";for(let s in t){const n=t[s];if(s=fh(s),n==null){n!==void 0&&(e+=(e.length?"&":"")+s);continue}(qt(n)?n.map(r=>r&&ki(r)):[n&&ki(n)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+s,r!=null&&(e+="="+r))})}return e}function Rh(t){const e={};for(const s in t){const n=t[s];n!==void 0&&(e[s]=qt(n)?n.map(r=>r==null?null:""+r):n==null?n:""+n)}return e}const Uh=Symbol(""),ha=Symbol(""),Fr=Symbol(""),_c=Symbol(""),Ci=Symbol("");function vn(){let t=[];function e(n){return t.push(n),()=>{const r=t.indexOf(n);r>-1&&t.splice(r,1)}}function s(){t=[]}return{add:e,list:()=>t.slice(),reset:s}}function ys(t,e,s,n,r,i=o=>o()){const o=n&&(n.enterCallbacks[r]=n.enterCallbacks[r]||[]);return()=>new Promise((c,l)=>{const u=h=>{h===!1?l(ln(He.NAVIGATION_ABORTED,{from:s,to:e})):h instanceof Error?l(h):Oh(h)?l(ln(He.NAVIGATION_GUARD_REDIRECT,{from:e,to:h})):(o&&n.enterCallbacks[r]===o&&typeof h=="function"&&o.push(h),c())},d=i(()=>t.call(n&&n.instances[r],e,s,u));let f=Promise.resolve(d);t.length<3&&(f=f.then(u)),f.catch(h=>l(h))})}function ni(t,e,s,n,r=i=>i()){const i=[];for(const o of t)for(const c in o.components){let l=o.components[c];if(!(e!=="beforeRouteEnter"&&!o.instances[c]))if(dc(l)){const u=(l.__vccOpts||l)[e];u&&i.push(ys(u,s,n,o,c,r))}else{let u=l();i.push(()=>u.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${c}" at "${o.path}"`);const f=th(d)?d.default:d;o.mods[c]=d,o.components[c]=f;const h=(f.__vccOpts||f)[e];return h&&ys(h,s,n,o,c,r)()}))}}return i}function jh(t,e){const s=[],n=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const c=e.matched[o];c&&(t.matched.find(u=>an(u,c))?n.push(c):s.push(c));const l=t.matched[o];l&&(e.matched.find(u=>an(u,l))||r.push(l))}return[s,n,r]}/*!
 * vue-router v4.6.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Ih=()=>location.protocol+"//"+location.host;function wc(t,e){const{pathname:s,search:n,hash:r}=e,i=t.indexOf("#");if(i>-1){let o=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(o);return c[0]!=="/"&&(c="/"+c),ca(c,"")}return ca(s,t)+n+r}function Nh(t,e,s,n){let r=[],i=[],o=null;const c=({state:h})=>{const p=wc(t,location),g=s.value,v=e.value;let k=0;if(h){if(s.value=p,e.value=h,o&&o===g){o=null;return}k=v?h.position-v.position:0}else n(p);r.forEach(P=>{P(s.value,g,{delta:k,type:Ai.pop,direction:k?k>0?si.forward:si.back:si.unknown})})};function l(){o=s.value}function u(h){r.push(h);const p=()=>{const g=r.indexOf(h);g>-1&&r.splice(g,1)};return i.push(p),p}function d(){if(document.visibilityState==="hidden"){const{history:h}=window;if(!h.state)return;h.replaceState(je({},h.state,{scroll:Lr()}),"")}}function f(){for(const h of i)h();i=[],window.removeEventListener("popstate",c),window.removeEventListener("pagehide",d),document.removeEventListener("visibilitychange",d)}return window.addEventListener("popstate",c),window.addEventListener("pagehide",d),document.addEventListener("visibilitychange",d),{pauseListeners:l,listen:u,destroy:f}}function pa(t,e,s,n=!1,r=!1){return{back:t,current:e,forward:s,replaced:n,position:window.history.length,scroll:r?Lr():null}}function Dh(t){const{history:e,location:s}=window,n={value:wc(t,s)},r={value:e.state};r.value||i(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,u,d){const f=t.indexOf("#"),h=f>-1?(s.host&&document.querySelector("base")?t:t.slice(f))+l:Ih()+t+l;try{e[d?"replaceState":"pushState"](u,"",h),r.value=u}catch(p){console.error(p),s[d?"replace":"assign"](h)}}function o(l,u){i(l,je({},e.state,pa(r.value.back,l,r.value.forward,!0),u,{position:r.value.position}),!0),n.value=l}function c(l,u){const d=je({},r.value,e.state,{forward:l,scroll:Lr()});i(d.current,d,!0),i(l,je({},pa(n.value,l,null),{position:d.position+1},u),!1),n.value=l}return{location:n,state:r,push:c,replace:o}}function Lh(t){t=wh(t);const e=Dh(t),s=Nh(t,e.state,e.location,e.replace);function n(i,o=!0){o||s.pauseListeners(),history.go(i)}const r=je({location:"",base:t,go:n,createHref:Sh.bind(null,t)},e,s);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Fh(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),Lh(t)}let Ds=(function(t){return t[t.Static=0]="Static",t[t.Param=1]="Param",t[t.Group=2]="Group",t})({});var et=(function(t){return t[t.Static=0]="Static",t[t.Param=1]="Param",t[t.ParamRegExp=2]="ParamRegExp",t[t.ParamRegExpEnd=3]="ParamRegExpEnd",t[t.EscapeNext=4]="EscapeNext",t})(et||{});const Mh={type:Ds.Static,value:""},Bh=/[a-zA-Z0-9_]/;function Vh(t){if(!t)return[[]];if(t==="/")return[[Mh]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(p){throw new Error(`ERR (${s})/"${u}": ${p}`)}let s=et.Static,n=s;const r=[];let i;function o(){i&&r.push(i),i=[]}let c=0,l,u="",d="";function f(){u&&(s===et.Static?i.push({type:Ds.Static,value:u}):s===et.Param||s===et.ParamRegExp||s===et.ParamRegExpEnd?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Ds.Param,value:u,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function h(){u+=l}for(;c<t.length;){if(l=t[c++],l==="\\"&&s!==et.ParamRegExp){n=s,s=et.EscapeNext;continue}switch(s){case et.Static:l==="/"?(u&&f(),o()):l===":"?(f(),s=et.Param):h();break;case et.EscapeNext:h(),s=n;break;case et.Param:l==="("?s=et.ParamRegExp:Bh.test(l)?h():(f(),s=et.Static,l!=="*"&&l!=="?"&&l!=="+"&&c--);break;case et.ParamRegExp:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:s=et.ParamRegExpEnd:d+=l;break;case et.ParamRegExpEnd:f(),s=et.Static,l!=="*"&&l!=="?"&&l!=="+"&&c--,d="";break;default:e("Unknown state");break}}return s===et.ParamRegExp&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),r}const ma="[^/]+?",Hh={sensitive:!1,strict:!1,start:!0,end:!0};var vt=(function(t){return t[t._multiplier=10]="_multiplier",t[t.Root=90]="Root",t[t.Segment=40]="Segment",t[t.SubSegment=30]="SubSegment",t[t.Static=40]="Static",t[t.Dynamic=20]="Dynamic",t[t.BonusCustomRegExp=10]="BonusCustomRegExp",t[t.BonusWildcard=-50]="BonusWildcard",t[t.BonusRepeatable=-20]="BonusRepeatable",t[t.BonusOptional=-8]="BonusOptional",t[t.BonusStrict=.7000000000000001]="BonusStrict",t[t.BonusCaseSensitive=.25]="BonusCaseSensitive",t})(vt||{});const qh=/[.+*?^${}()[\]/\\]/g;function Gh(t,e){const s=je({},Hh,e),n=[];let r=s.start?"^":"";const i=[];for(const u of t){const d=u.length?[]:[vt.Root];s.strict&&!u.length&&(r+="/");for(let f=0;f<u.length;f++){const h=u[f];let p=vt.Segment+(s.sensitive?vt.BonusCaseSensitive:0);if(h.type===Ds.Static)f||(r+="/"),r+=h.value.replace(qh,"\\$&"),p+=vt.Static;else if(h.type===Ds.Param){const{value:g,repeatable:v,optional:k,regexp:P}=h;i.push({name:g,repeatable:v,optional:k});const R=P||ma;if(R!==ma){p+=vt.BonusCustomRegExp;try{`${R}`}catch(x){throw new Error(`Invalid custom RegExp for param "${g}" (${R}): `+x.message)}}let S=v?`((?:${R})(?:/(?:${R}))*)`:`(${R})`;f||(S=k&&u.length<2?`(?:/${S})`:"/"+S),k&&(S+="?"),r+=S,p+=vt.Dynamic,k&&(p+=vt.BonusOptional),v&&(p+=vt.BonusRepeatable),R===".*"&&(p+=vt.BonusWildcard)}d.push(p)}n.push(d)}if(s.strict&&s.end){const u=n.length-1;n[u][n[u].length-1]+=vt.BonusStrict}s.strict||(r+="/?"),s.end?r+="$":s.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,s.sensitive?"":"i");function c(u){const d=u.match(o),f={};if(!d)return null;for(let h=1;h<d.length;h++){const p=d[h]||"",g=i[h-1];f[g.name]=p&&g.repeatable?p.split("/"):p}return f}function l(u){let d="",f=!1;for(const h of t){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const p of h)if(p.type===Ds.Static)d+=p.value;else if(p.type===Ds.Param){const{value:g,repeatable:v,optional:k}=p,P=g in u?u[g]:"";if(qt(P)&&!v)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const R=qt(P)?P.join("/"):P;if(!R)if(k)h.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);d+=R}}return d||"/"}return{re:o,score:n,keys:i,parse:c,stringify:l}}function Kh(t,e){let s=0;for(;s<t.length&&s<e.length;){const n=e[s]-t[s];if(n)return n;s++}return t.length<e.length?t.length===1&&t[0]===vt.Static+vt.Segment?-1:1:t.length>e.length?e.length===1&&e[0]===vt.Static+vt.Segment?1:-1:0}function xc(t,e){let s=0;const n=t.score,r=e.score;for(;s<n.length&&s<r.length;){const i=Kh(n[s],r[s]);if(i)return i;s++}if(Math.abs(r.length-n.length)===1){if(ga(n))return 1;if(ga(r))return-1}return r.length-n.length}function ga(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const Wh={strict:!1,end:!0,sensitive:!1};function Jh(t,e,s){const n=Gh(Vh(t.path),s),r=je(n,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function zh(t,e){const s=[],n=new Map;e=la(Wh,e);function r(f){return n.get(f)}function i(f,h,p){const g=!p,v=ya(f);v.aliasOf=p&&p.record;const k=la(e,f),P=[v];if("alias"in f){const x=typeof f.alias=="string"?[f.alias]:f.alias;for(const j of x)P.push(ya(je({},v,{components:p?p.record.components:v.components,path:j,aliasOf:p?p.record:v})))}let R,S;for(const x of P){const{path:j}=x;if(h&&j[0]!=="/"){const I=h.record.path,_=I[I.length-1]==="/"?"":"/";x.path=h.record.path+(j&&_+j)}if(R=Jh(x,h,k),p?p.alias.push(R):(S=S||R,S!==R&&S.alias.push(R),g&&f.name&&!ba(R)&&o(f.name)),Sc(R)&&l(R),v.children){const I=v.children;for(let _=0;_<I.length;_++)i(I[_],R,p&&p.children[_])}p=p||R}return S?()=>{o(S)}:Cn}function o(f){if(yc(f)){const h=n.get(f);h&&(n.delete(f),s.splice(s.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=s.indexOf(f);h>-1&&(s.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function c(){return s}function l(f){const h=Qh(f,s);s.splice(h,0,f),f.record.name&&!ba(f)&&n.set(f.record.name,f)}function u(f,h){let p,g={},v,k;if("name"in f&&f.name){if(p=n.get(f.name),!p)throw ln(He.MATCHER_NOT_FOUND,{location:f});k=p.record.name,g=je(va(h.params,p.keys.filter(S=>!S.optional).concat(p.parent?p.parent.keys.filter(S=>S.optional):[]).map(S=>S.name)),f.params&&va(f.params,p.keys.map(S=>S.name))),v=p.stringify(g)}else if(f.path!=null)v=f.path,p=s.find(S=>S.re.test(v)),p&&(g=p.parse(v),k=p.record.name);else{if(p=h.name?n.get(h.name):s.find(S=>S.re.test(h.path)),!p)throw ln(He.MATCHER_NOT_FOUND,{location:f,currentLocation:h});k=p.record.name,g=je({},h.params,f.params),v=p.stringify(g)}const P=[];let R=p;for(;R;)P.unshift(R.record),R=R.parent;return{name:k,path:v,params:g,matched:P,meta:Xh(P)}}t.forEach(f=>i(f));function d(){s.length=0,n.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:d,getRoutes:c,getRecordMatcher:r}}function va(t,e){const s={};for(const n of e)n in t&&(s[n]=t[n]);return s}function ya(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:Yh(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function Yh(t){const e={},s=t.props||!1;if("component"in t)e.default=s;else for(const n in t.components)e[n]=typeof s=="object"?s[n]:s;return e}function ba(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Xh(t){return t.reduce((e,s)=>je(e,s.meta),{})}function Qh(t,e){let s=0,n=e.length;for(;s!==n;){const i=s+n>>1;xc(t,e[i])<0?n=i:s=i+1}const r=Zh(t);return r&&(n=e.lastIndexOf(r,n-1)),n}function Zh(t){let e=t;for(;e=e.parent;)if(Sc(e)&&xc(t,e)===0)return e}function Sc({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function _a(t){const e=Ht(Fr),s=Ht(_c),n=ie(()=>{const l=ne(t.to);return e.resolve(l)}),r=ie(()=>{const{matched:l}=n.value,{length:u}=l,d=l[u-1],f=s.matched;if(!d||!f.length)return-1;const h=f.findIndex(an.bind(null,d));if(h>-1)return h;const p=wa(l[u-2]);return u>1&&wa(d)===p&&f[f.length-1].path!==p?f.findIndex(an.bind(null,l[u-2])):h}),i=ie(()=>r.value>-1&&np(s.params,n.value.params)),o=ie(()=>r.value>-1&&r.value===s.matched.length-1&&vc(s.params,n.value.params));function c(l={}){if(sp(l)){const u=e[ne(t.replace)?"replace":"push"](ne(t.to)).catch(Cn);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:n,href:ie(()=>n.value.href),isActive:i,isExactActive:o,navigate:c}}function ep(t){return t.length===1?t[0]:t}const tp=Il({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:_a,setup(t,{slots:e}){const s=$t(_a(t)),{options:n}=Ht(Fr),r=ie(()=>({[xa(t.activeClass,n.linkActiveClass,"router-link-active")]:s.isActive,[xa(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const i=e.default&&ep(e.default(s));return t.custom?i:lc("a",{"aria-current":s.isExactActive?t.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:r.value},i)}}}),bt=tp;function sp(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function np(t,e){for(const s in e){const n=e[s],r=t[s];if(typeof n=="string"){if(n!==r)return!1}else if(!qt(r)||r.length!==n.length||n.some((i,o)=>i!==r[o]))return!1}return!0}function wa(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const xa=(t,e,s)=>t??e??s,rp=Il({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:s}){const n=Ht(Ci),r=ie(()=>t.route||n.value),i=Ht(ha,0),o=ie(()=>{let u=ne(i);const{matched:d}=r.value;let f;for(;(f=d[u])&&!f.components;)u++;return u}),c=ie(()=>r.value.matched[o.value]);ar(ha,ie(()=>o.value+1)),ar(Uh,c),ar(Ci,r);const l=z();return qe(()=>[l.value,c.value,t.name],([u,d,f],[h,p,g])=>{d&&(d.instances[f]=u,p&&p!==d&&u&&u===h&&(d.leaveGuards.size||(d.leaveGuards=p.leaveGuards),d.updateGuards.size||(d.updateGuards=p.updateGuards))),u&&d&&(!p||!an(d,p)||!h)&&(d.enterCallbacks[f]||[]).forEach(v=>v(u))},{flush:"post"}),()=>{const u=r.value,d=t.name,f=c.value,h=f&&f.components[d];if(!h)return Sa(s.default,{Component:h,route:u});const p=f.props[d],g=p?p===!0?u.params:typeof p=="function"?p(u):p:null,k=lc(h,je({},g,e,{onVnodeUnmounted:P=>{P.component.isUnmounted&&(f.instances[d]=null)},ref:l}));return Sa(s.default,{Component:k,route:u})||k}}});function Sa(t,e){if(!t)return null;const s=t(e);return s.length===1?s[0]:s}const ip=rp;function op(t){const e=zh(t.routes,t),s=t.parseQuery||Ph,n=t.stringifyQuery||fa,r=t.history,i=vn(),o=vn(),c=vn(),l=rd(hs);let u=hs;Xs&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=ei.bind(null,m=>""+m),f=ei.bind(null,ph),h=ei.bind(null,Dn);function p(m,$){let q,te;return yc(m)?(q=e.getRecordMatcher(m),te=$):te=m,e.addRoute(te,q)}function g(m){const $=e.getRecordMatcher(m);$&&e.removeRoute($)}function v(){return e.getRoutes().map(m=>m.record)}function k(m){return!!e.getRecordMatcher(m)}function P(m,$){if($=je({},$||l.value),typeof m=="string"){const O=ti(s,m,$.path),M=e.resolve({path:O.path},$),V=r.createHref(O.fullPath);return je(O,M,{params:h(M.params),hash:Dn(O.hash),redirectedFrom:void 0,href:V})}let q;if(m.path!=null)q=je({},m,{path:ti(s,m.path,$.path).path});else{const O=je({},m.params);for(const M in O)O[M]==null&&delete O[M];q=je({},m,{params:f(O)}),$.params=f($.params)}const te=e.resolve(q,$),le=m.hash||"";te.params=d(h(te.params));const b=vh(n,je({},m,{hash:dh(le),path:te.path})),w=r.createHref(b);return je({fullPath:b,hash:le,query:n===fa?Rh(m.query):m.query||{}},te,{redirectedFrom:void 0,href:w})}function R(m){return typeof m=="string"?ti(s,m,l.value.path):je({},m)}function S(m,$){if(u!==m)return ln(He.NAVIGATION_CANCELLED,{from:$,to:m})}function x(m){return _(m)}function j(m){return x(je(R(m),{replace:!0}))}function I(m,$){const q=m.matched[m.matched.length-1];if(q&&q.redirect){const{redirect:te}=q;let le=typeof te=="function"?te(m,$):te;return typeof le=="string"&&(le=le.includes("?")||le.includes("#")?le=R(le):{path:le},le.params={}),je({query:m.query,hash:m.hash,params:le.path!=null?{}:m.params},le)}}function _(m,$){const q=u=P(m),te=l.value,le=m.state,b=m.force,w=m.replace===!0,O=I(q,te);if(O)return _(je(R(O),{state:typeof O=="object"?je({},le,O.state):le,force:b,replace:w}),$||q);const M=q;M.redirectedFrom=$;let V;return!b&&yh(n,te,q)&&(V=ln(He.NAVIGATION_DUPLICATED,{to:M,from:te}),_e(te,te,!0,!1)),(V?Promise.resolve(V):G(M,te)).catch(H=>ts(H)?ts(H,He.NAVIGATION_GUARD_REDIRECT)?H:Ee(H):re(H,M,te)).then(H=>{if(H){if(ts(H,He.NAVIGATION_GUARD_REDIRECT))return _(je({replace:w},R(H.to),{state:typeof H.to=="object"?je({},le,H.to.state):le,force:b}),$||M)}else H=J(M,te,!0,w,le);return K(M,te,H),H})}function U(m,$){const q=S(m,$);return q?Promise.reject(q):Promise.resolve()}function B(m){const $=Z.values().next().value;return $&&typeof $.runWithContext=="function"?$.runWithContext(m):m()}function G(m,$){let q;const[te,le,b]=jh(m,$);q=ni(te.reverse(),"beforeRouteLeave",m,$);for(const O of te)O.leaveGuards.forEach(M=>{q.push(ys(M,m,$))});const w=U.bind(null,m,$);return q.push(w),A(q).then(()=>{q=[];for(const O of i.list())q.push(ys(O,m,$));return q.push(w),A(q)}).then(()=>{q=ni(le,"beforeRouteUpdate",m,$);for(const O of le)O.updateGuards.forEach(M=>{q.push(ys(M,m,$))});return q.push(w),A(q)}).then(()=>{q=[];for(const O of b)if(O.beforeEnter)if(qt(O.beforeEnter))for(const M of O.beforeEnter)q.push(ys(M,m,$));else q.push(ys(O.beforeEnter,m,$));return q.push(w),A(q)}).then(()=>(m.matched.forEach(O=>O.enterCallbacks={}),q=ni(b,"beforeRouteEnter",m,$,B),q.push(w),A(q))).then(()=>{q=[];for(const O of o.list())q.push(ys(O,m,$));return q.push(w),A(q)}).catch(O=>ts(O,He.NAVIGATION_CANCELLED)?O:Promise.reject(O))}function K(m,$,q){c.list().forEach(te=>B(()=>te(m,$,q)))}function J(m,$,q,te,le){const b=S(m,$);if(b)return b;const w=$===hs,O=Xs?history.state:{};q&&(te||w?r.replace(m.fullPath,je({scroll:w&&O&&O.scroll},le)):r.push(m.fullPath,le)),l.value=m,_e(m,$,q,w),Ee()}let ce;function ge(){ce||(ce=r.listen((m,$,q)=>{if(!N.listening)return;const te=P(m),le=I(te,N.currentRoute.value);if(le){_(je(le,{replace:!0,force:!0}),te).catch(Cn);return}u=te;const b=l.value;Xs&&Eh(da(b.fullPath,q.delta),Lr()),G(te,b).catch(w=>ts(w,He.NAVIGATION_ABORTED|He.NAVIGATION_CANCELLED)?w:ts(w,He.NAVIGATION_GUARD_REDIRECT)?(_(je(R(w.to),{force:!0}),te).then(O=>{ts(O,He.NAVIGATION_ABORTED|He.NAVIGATION_DUPLICATED)&&!q.delta&&q.type===Ai.pop&&r.go(-1,!1)}).catch(Cn),Promise.reject()):(q.delta&&r.go(-q.delta,!1),re(w,te,b))).then(w=>{w=w||J(te,b,!1),w&&(q.delta&&!ts(w,He.NAVIGATION_CANCELLED)?r.go(-q.delta,!1):q.type===Ai.pop&&ts(w,He.NAVIGATION_ABORTED|He.NAVIGATION_DUPLICATED)&&r.go(-1,!1)),K(te,b,w)}).catch(Cn)}))}let Se=vn(),Ae=vn(),fe;function re(m,$,q){Ee(m);const te=Ae.list();return te.length?te.forEach(le=>le(m,$,q)):console.error(m),Promise.reject(m)}function we(){return fe&&l.value!==hs?Promise.resolve():new Promise((m,$)=>{Se.add([m,$])})}function Ee(m){return fe||(fe=!m,ge(),Se.list().forEach(([$,q])=>m?q(m):$()),Se.reset()),m}function _e(m,$,q,te){const{scrollBehavior:le}=t;if(!Xs||!le)return Promise.resolve();const b=!q&&Ch(da(m.fullPath,0))||(te||!q)&&history.state&&history.state.scroll||null;return Ur().then(()=>le(m,$,b)).then(w=>w&&Ah(w)).catch(w=>re(w,m,$))}const Te=m=>r.go(m);let Ue;const Z=new Set,N={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:k,getRoutes:v,resolve:P,options:t,push:x,replace:j,go:Te,back:()=>Te(-1),forward:()=>Te(1),beforeEach:i.add,beforeResolve:o.add,afterEach:c.add,onError:Ae.add,isReady:we,install(m){m.component("RouterLink",bt),m.component("RouterView",ip),m.config.globalProperties.$router=N,Object.defineProperty(m.config.globalProperties,"$route",{enumerable:!0,get:()=>ne(l)}),Xs&&!Ue&&l.value===hs&&(Ue=!0,x(r.location).catch(te=>{}));const $={};for(const te in hs)Object.defineProperty($,te,{get:()=>l.value[te],enumerable:!0});m.provide(Fr,N),m.provide(_c,Cl($)),m.provide(Ci,l);const q=m.unmount;Z.add(m),m.unmount=function(){Z.delete(m),Z.size<1&&(u=hs,ce&&ce(),ce=null,l.value=hs,Ue=!1,fe=!1),q()}}};function A(m){return m.reduce(($,q)=>$.then(()=>B(q)),Promise.resolve())}return N}function ap(){return Ht(Fr)}const lp={class:"w-full py-4 bg-gray-200 text-center shadow"},pt={__name:"Header",setup(t){return(e,s)=>(C(),T("header",lp,[Q(ne(bt),{to:"/",class:"hover:underline"},{default:Ge(()=>[...s[0]||(s[0]=[a("h1",{class:"text-3xl font-bold text-black"},"Music Tutor Studio",-1)])]),_:1})]))}},cp={class:"w-full py-4 bg-base-300 text-base-content text-center mt-auto"},up={class:"flex flex-col items-center gap-2"},dp={class:"text-xs"},kc={__name:"FooterBase",props:{metaText:{type:String,default:"A Work in Process. Release: vue-src-alpha - Music Tutor Studio  2025"}},setup(t){return(e,s)=>(C(),T("footer",cp,[a("div",up,[a("span",dp,D(t.metaText),1)])]))}},fp={__name:"FooterMain",setup(t){return(e,s)=>(C(),co(kc))}},hp={class:"bg-base-200 flex flex-col min-h-screen"},pp={class:"container mx-auto p-4 flex-1"},mp={class:"flex flex-col gap-4 max-w-xs mx-auto"},gp={__name:"Home",setup(t){return(e,s)=>(C(),T("div",hp,[Q(pt),a("main",pp,[a("div",mp,[Q(ne(bt),{to:"/creator",class:"btn btn-primary shadow-lg"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"edit_square",-1),X(" Creator ",-1)])]),_:1}),Q(ne(bt),{to:"/practice",class:"btn btn-secondary shadow-lg"},{default:Ge(()=>[...s[1]||(s[1]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"music_note",-1),X(" Practice ",-1)])]),_:1}),Q(ne(bt),{to:"/lessons",class:"btn btn-accent shadow-lg"},{default:Ge(()=>[...s[2]||(s[2]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"menu_book",-1),X(" Lessons ",-1)])]),_:1}),Q(ne(bt),{to:"/preferences",class:"btn btn-info shadow-lg"},{default:Ge(()=>[...s[3]||(s[3]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"settings",-1),X(" Preferences ",-1)])]),_:1}),Q(ne(bt),{to:"/about",class:"btn btn-warning shadow-lg"},{default:Ge(()=>[...s[4]||(s[4]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"info",-1),X(" About ",-1)])]),_:1})])]),Q(fp)]))}},vp={class:"w-full py-4 bg-base-300 text-base-content text-center mt-auto"},yp={class:"flex flex-col items-center gap-2"},_t={__name:"FooterStandard",setup(t){return(e,s)=>(C(),T("footer",vp,[a("div",yp,[Q(ne(bt),{to:"/",class:"btn btn-circle btn-primary shadow",title:"Home"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined text-2xl"},"home",-1)])]),_:1}),Q(kc)])]))}},bp={class:"bg-base-200 flex flex-col min-h-screen"},_p={class:"container mx-auto p-4 flex-1"},wp={class:"flex flex-col gap-6 max-w-xs mx-auto mt-8",style:{display:"flex","flex-direction":"column",gap:"1.5em","max-width":"400px",margin:"2em auto"}},xp={__name:"Practice",setup(t){return(e,s)=>{const n=oo("RouterLink");return C(),T("div",bp,[Q(pt),a("main",_p,[s[3]||(s[3]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatPracticePages"},[a("span",{class:"material-symbols-outlined"},"music_note"),a("span",{class:"text-2xl font-bold"},"Practice")],-1)),a("div",wp,[Q(n,{to:"/practice-active-unit",class:"mtsFormatPracticeButtons"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"play_circle",-1),X(" Active Unit Practice ",-1)])]),_:1}),Q(n,{to:"/practice-recall-practice-unit",class:"mtsFormatPracticeButtons"},{default:Ge(()=>[...s[1]||(s[1]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"download",-1),X(" Recall Saved Practice Unit ",-1)])]),_:1}),Q(n,{to:"/practice-notes",class:"mtsFormatPracticeButtons"},{default:Ge(()=>[...s[2]||(s[2]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"sticky_note_2",-1),X(" Student Notes ",-1)])]),_:1})])]),Q(_t)])}}},Sp={style:{"max-width":"400px",margin:"2em auto"}},Ac={__name:"PracticeReturn",setup(t){return(e,s)=>(C(),T("div",Sp,[Q(ne(bt),{to:"/practice",class:"mtsFormatPracticeButtons"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined align-middle mr-2","aria-hidden":"true"},"music_note",-1),X(" Return to Practice ",-1)])]),_:1})]))}};/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Ec;const Mr=t=>Ec=t,Cc=Symbol();function Oi(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var On;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(On||(On={}));function kp(){const t=dl(!0),e=t.run(()=>z({}));let s=[],n=[];const r=to({install(i){Mr(r),r._a=i,i.provide(Cc,r),i.config.globalProperties.$pinia=r,n.forEach(o=>s.push(o)),n=[]},use(i){return this._a?s.push(i):n.push(i),this},_p:s,_a:null,_e:t,_s:new Map,state:e});return r}const Oc=()=>{};function ka(t,e,s,n=Oc){t.push(e);const r=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),n())};return!s&&fl()&&Lu(r),r}function Hs(t,...e){t.slice().forEach(s=>{s(...e)})}const Ap=t=>t(),Aa=Symbol(),ri=Symbol();function Ti(t,e){t instanceof Map&&e instanceof Map?e.forEach((s,n)=>t.set(n,s)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const s in e){if(!e.hasOwnProperty(s))continue;const n=e[s],r=t[s];Oi(r)&&Oi(n)&&t.hasOwnProperty(s)&&!We(n)&&!ws(n)?t[s]=Ti(r,n):t[s]=n}return t}const Ep=Symbol();function Cp(t){return!Oi(t)||!Object.prototype.hasOwnProperty.call(t,Ep)}const{assign:ms}=Object;function Op(t){return!!(We(t)&&t.effect)}function Tp(t,e,s,n){const{state:r,actions:i,getters:o}=e,c=s.state.value[t];let l;function u(){c||(s.state.value[t]=r?r():{});const d=ad(s.state.value[t]);return ms(d,i,Object.keys(o||{}).reduce((f,h)=>(f[h]=to(ie(()=>{Mr(s);const p=s._s.get(t);return o[h].call(p,p)})),f),{}))}return l=Tc(t,u,e,s,n,!0),l}function Tc(t,e,s={},n,r,i){let o;const c=ms({actions:{}},s),l={deep:!0};let u,d,f=[],h=[],p;const g=n.state.value[t];!i&&!g&&(n.state.value[t]={}),z({});let v;function k(U){let B;u=d=!1,typeof U=="function"?(U(n.state.value[t]),B={type:On.patchFunction,storeId:t,events:p}):(Ti(n.state.value[t],U),B={type:On.patchObject,payload:U,storeId:t,events:p});const G=v=Symbol();Ur().then(()=>{v===G&&(u=!0)}),d=!0,Hs(f,B,n.state.value[t])}const P=i?function(){const{state:B}=s,G=B?B():{};this.$patch(K=>{ms(K,G)})}:Oc;function R(){o.stop(),f=[],h=[],n._s.delete(t)}const S=(U,B="")=>{if(Aa in U)return U[ri]=B,U;const G=function(){Mr(n);const K=Array.from(arguments),J=[],ce=[];function ge(fe){J.push(fe)}function Se(fe){ce.push(fe)}Hs(h,{args:K,name:G[ri],store:j,after:ge,onError:Se});let Ae;try{Ae=U.apply(this&&this.$id===t?this:j,K)}catch(fe){throw Hs(ce,fe),fe}return Ae instanceof Promise?Ae.then(fe=>(Hs(J,fe),fe)).catch(fe=>(Hs(ce,fe),Promise.reject(fe))):(Hs(J,Ae),Ae)};return G[Aa]=!0,G[ri]=B,G},x={_p:n,$id:t,$onAction:ka.bind(null,h),$patch:k,$reset:P,$subscribe(U,B={}){const G=ka(f,U,B.detached,()=>K()),K=o.run(()=>qe(()=>n.state.value[t],J=>{(B.flush==="sync"?d:u)&&U({storeId:t,type:On.direct,events:p},J)},ms({},l,B)));return G},$dispose:R},j=$t(x);n._s.set(t,j);const _=(n._a&&n._a.runWithContext||Ap)(()=>n._e.run(()=>(o=dl()).run(()=>e({action:S}))));for(const U in _){const B=_[U];if(We(B)&&!Op(B)||ws(B))i||(g&&Cp(B)&&(We(B)?B.value=g[U]:Ti(B,g[U])),n.state.value[t][U]=B);else if(typeof B=="function"){const G=S(B,U);_[U]=G,c.actions[U]=B}}return ms(j,_),ms(Pe(j),_),Object.defineProperty(j,"$state",{get:()=>n.state.value[t],set:U=>{k(B=>{ms(B,U)})}}),n._p.forEach(U=>{ms(j,o.run(()=>U({store:j,app:n._a,pinia:n,options:c})))}),g&&i&&s.hydrate&&s.hydrate(j.$state,g),u=!0,d=!0,j}/*! #__NO_SIDE_EFFECTS__ */function ho(t,e,s){let n;const r=typeof e=="function";n=r?s:e;function i(o,c){const l=Bd();return o=o||(l?Ht(Cc,null):null),o&&Mr(o),o=Ec,o._s.has(t)||(r?Tc(t,e,n,o):Tp(t,n,o)),o._s.get(t)}return i.$id=t,i}var $i=function(t,e){return $i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=n[r])},$i(t,e)};function $c(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$i(t,e);function s(){this.constructor=t}t.prototype=e===null?Object.create(e):(s.prototype=e.prototype,new s)}var xr=function(){return xr=Object.assign||function(e){for(var s,n=1,r=arguments.length;n<r;n++){s=arguments[n];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},xr.apply(this,arguments)};function dn(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s}function Pc(t,e,s,n){var r=arguments.length,i=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,s):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,s,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(r<3?o(i):r>3?o(e,s,i):o(e,s))||i);return r>3&&i&&Object.defineProperty(e,s,i),i}function Rc(t,e){return function(s,n){e(s,n,t)}}function Uc(t,e,s,n,r,i){function o(P){if(P!==void 0&&typeof P!="function")throw new TypeError("Function expected");return P}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!e&&t?n.static?t:t.prototype:null,d=e||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),f,h=!1,p=s.length-1;p>=0;p--){var g={};for(var v in n)g[v]=v==="access"?{}:n[v];for(var v in n.access)g.access[v]=n.access[v];g.addInitializer=function(P){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(P||null))};var k=(0,s[p])(c==="accessor"?{get:d.get,set:d.set}:d[l],g);if(c==="accessor"){if(k===void 0)continue;if(k===null||typeof k!="object")throw new TypeError("Object expected");(f=o(k.get))&&(d.get=f),(f=o(k.set))&&(d.set=f),(f=o(k.init))&&r.unshift(f)}else(f=o(k))&&(c==="field"?r.unshift(f):d[l]=f)}u&&Object.defineProperty(u,n.name,d),h=!0}function jc(t,e,s){for(var n=arguments.length>2,r=0;r<e.length;r++)s=n?e[r].call(t,s):e[r].call(t);return n?s:void 0}function Ic(t){return typeof t=="symbol"?t:"".concat(t)}function Nc(t,e,s){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:s?"".concat(s," ",e):e})}function Dc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function de(t,e,s,n){function r(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(d){try{u(n.next(d))}catch(f){o(f)}}function l(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?i(d.value):r(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})}function Lc(t,e){var s={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,r,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(n=1,r&&(i=u[0]&2?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,r=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(u[0]===6&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=e.call(t,s)}catch(d){u=[6,d],r=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Br=Object.create?(function(t,e,s,n){n===void 0&&(n=s);var r=Object.getOwnPropertyDescriptor(e,s);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[s]}}),Object.defineProperty(t,n,r)}):(function(t,e,s,n){n===void 0&&(n=s),t[n]=e[s]});function Fc(t,e){for(var s in t)s!=="default"&&!Object.prototype.hasOwnProperty.call(e,s)&&Br(e,t,s)}function Sr(t){var e=typeof Symbol=="function"&&Symbol.iterator,s=e&&t[e],n=0;if(s)return s.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function po(t,e){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var n=s.call(t),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return i}function Mc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(po(arguments[e]));return t}function Bc(){for(var t=0,e=0,s=arguments.length;e<s;e++)t+=arguments[e].length;for(var n=Array(t),r=0,e=0;e<s;e++)for(var i=arguments[e],o=0,c=i.length;o<c;o++,r++)n[r]=i[o];return n}function Vc(t,e,s){if(s||arguments.length===2)for(var n=0,r=e.length,i;n<r;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function cn(t){return this instanceof cn?(this.v=t,this):new cn(t)}function Hc(t,e,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=s.apply(t,e||[]),r,i=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(p){return function(g){return Promise.resolve(g).then(p,f)}}function c(p,g){n[p]&&(r[p]=function(v){return new Promise(function(k,P){i.push([p,v,k,P])>1||l(p,v)})},g&&(r[p]=g(r[p])))}function l(p,g){try{u(n[p](g))}catch(v){h(i[0][3],v)}}function u(p){p.value instanceof cn?Promise.resolve(p.value.v).then(d,f):h(i[0][2],p)}function d(p){l("next",p)}function f(p){l("throw",p)}function h(p,g){p(g),i.shift(),i.length&&l(i[0][0],i[0][1])}}function qc(t){var e,s;return e={},n("next"),n("throw",function(r){throw r}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(r,i){e[r]=t[r]?function(o){return(s=!s)?{value:cn(t[r](o)),done:!1}:i?i(o):o}:i}}function Gc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],s;return e?e.call(t):(t=typeof Sr=="function"?Sr(t):t[Symbol.iterator](),s={},n("next"),n("throw"),n("return"),s[Symbol.asyncIterator]=function(){return this},s);function n(i){s[i]=t[i]&&function(o){return new Promise(function(c,l){o=t[i](o),r(c,l,o.done,o.value)})}}function r(i,o,c,l){Promise.resolve(l).then(function(u){i({value:u,done:c})},o)}}function Kc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var $p=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},Pi=function(t){return Pi=Object.getOwnPropertyNames||function(e){var s=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(s[s.length]=n);return s},Pi(t)};function Wc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var s=Pi(t),n=0;n<s.length;n++)s[n]!=="default"&&Br(e,t,s[n]);return $p(e,t),e}function Jc(t){return t&&t.__esModule?t:{default:t}}function zc(t,e,s,n){if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?n:s==="a"?n.call(t):n?n.value:e.get(t)}function Yc(t,e,s,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,s):r?r.value=s:e.set(t,s),s}function Xc(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Qc(t,e,s){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,r;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],s&&(r=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");r&&(n=function(){try{r.call(this)}catch(i){return Promise.reject(i)}}),t.stack.push({value:e,dispose:n,async:s})}else s&&t.stack.push({async:!0});return e}var Pp=typeof SuppressedError=="function"?SuppressedError:function(t,e,s){var n=new Error(s);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};function Zc(t){function e(i){t.error=t.hasError?new Pp(i,t.error,"An error was suppressed during disposal."):i,t.hasError=!0}var s,n=0;function r(){for(;s=t.stack.pop();)try{if(!s.async&&n===1)return n=0,t.stack.push(s),Promise.resolve().then(r);if(s.dispose){var i=s.dispose.call(s.value);if(s.async)return n|=2,Promise.resolve(i).then(r,function(o){return e(o),r()})}else n|=1}catch(o){e(o)}if(n===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return r()}function eu(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,n,r,i,o){return n?e?".jsx":".js":r&&(!i||!o)?s:r+i+"."+o.toLowerCase()+"js"}):t}const Rp={__extends:$c,__assign:xr,__rest:dn,__decorate:Pc,__param:Rc,__esDecorate:Uc,__runInitializers:jc,__propKey:Ic,__setFunctionName:Nc,__metadata:Dc,__awaiter:de,__generator:Lc,__createBinding:Br,__exportStar:Fc,__values:Sr,__read:po,__spread:Mc,__spreadArrays:Bc,__spreadArray:Vc,__await:cn,__asyncGenerator:Hc,__asyncDelegator:qc,__asyncValues:Gc,__makeTemplateObject:Kc,__importStar:Wc,__importDefault:Jc,__classPrivateFieldGet:zc,__classPrivateFieldSet:Yc,__classPrivateFieldIn:Xc,__addDisposableResource:Qc,__disposeResources:Zc,__rewriteRelativeImportExtension:eu},Up=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Qc,get __assign(){return xr},__asyncDelegator:qc,__asyncGenerator:Hc,__asyncValues:Gc,__await:cn,__awaiter:de,__classPrivateFieldGet:zc,__classPrivateFieldIn:Xc,__classPrivateFieldSet:Yc,__createBinding:Br,__decorate:Pc,__disposeResources:Zc,__esDecorate:Uc,__exportStar:Fc,__extends:$c,__generator:Lc,__importDefault:Jc,__importStar:Wc,__makeTemplateObject:Kc,__metadata:Dc,__param:Rc,__propKey:Ic,__read:po,__rest:dn,__rewriteRelativeImportExtension:eu,__runInitializers:jc,__setFunctionName:Nc,__spread:Mc,__spreadArray:Vc,__spreadArrays:Bc,__values:Sr,default:Rp},Symbol.toStringTag,{value:"Module"})),jp=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class mo extends Error{constructor(e,s="FunctionsError",n){super(e),this.name=s,this.context=n}}class Ea extends mo{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ca extends mo{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Oa extends mo{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ri;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Ri||(Ri={}));class Ip{constructor(e,{headers:s={},customFetch:n,region:r=Ri.Any}={}){this.url=e,this.headers=s,this.region=r,this.fetch=jp(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return de(this,arguments,void 0,function*(s,n={}){var r;try{const{headers:i,method:o,body:c,signal:l}=n;let u={},{region:d}=n;d||(d=this.region);const f=new URL(`${this.url}/${s}`);d&&d!=="any"&&(u["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let h;c&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",h=c):typeof c=="string"?(u["Content-Type"]="text/plain",h=c):typeof FormData<"u"&&c instanceof FormData?h=c:(u["Content-Type"]="application/json",h=JSON.stringify(c)):h=c;const p=yield this.fetch(f.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),i),body:h,signal:l}).catch(P=>{throw P.name==="AbortError"?P:new Ea(P)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new Ca(p);if(!p.ok)throw new Oa(p);let v=((r=p.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return v==="application/json"?k=yield p.json():v==="application/octet-stream"||v==="application/pdf"?k=yield p.blob():v==="text/event-stream"?k=p:v==="multipart/form-data"?k=yield p.formData():k=yield p.text(),{data:k,error:null,response:p}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new Ea(i)}:{data:null,error:i,response:i instanceof Oa||i instanceof Ca?i.context:void 0}}})}}function Np(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Dp(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var s=function n(){var r=!1;try{r=this instanceof n}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(s,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),s}var lt={};const fn=Dp(Up);var Xn={},Qn={},Zn={},er={},tr={},sr={},Ta;function tu(){if(Ta)return sr;Ta=1,Object.defineProperty(sr,"__esModule",{value:!0});class t extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return sr.default=t,sr}var $a;function su(){if($a)return tr;$a=1,Object.defineProperty(tr,"__esModule",{value:!0});const e=fn.__importDefault(tu());class s{constructor(r){var i,o;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(i=r.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=r.signal,this.isMaybeSingle=(o=r.isMaybeSingle)!==null&&o!==void 0?o:!1,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,i){return this.headers=new Headers(this.headers),this.headers.set(r,i),this}then(r,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let c=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var u,d,f,h;let p=null,g=null,v=null,k=l.status,P=l.statusText;if(l.ok){if(this.method!=="HEAD"){const j=await l.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?g=j:g=JSON.parse(j))}const S=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),x=(f=l.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");S&&x&&x.length>1&&(v=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,v=null,k=406,P="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const S=await l.text();try{p=JSON.parse(S),Array.isArray(p)&&l.status===404&&(g=[],p=null,k=200,P="OK")}catch{l.status===404&&S===""?(k=204,P="No Content"):p={message:S}}if(p&&this.isMaybeSingle&&(!((h=p?.details)===null||h===void 0)&&h.includes("0 rows"))&&(p=null,k=200,P="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:g,count:v,status:k,statusText:P}});return this.shouldThrowOnError||(c=c.catch(l=>{var u,d,f;return{error:{message:`${(u=l?.name)!==null&&u!==void 0?u:"FetchError"}: ${l?.message}`,details:`${(d=l?.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(f=l?.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),c.then(r,i)}returns(){return this}overrideTypes(){return this}}return tr.default=s,tr}var Pa;function nu(){if(Pa)return er;Pa=1,Object.defineProperty(er,"__esModule",{value:!0});const e=fn.__importDefault(su());class s extends e.default{select(r){let i=!1;const o=(r??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:i=!0,nullsFirst:o,foreignTable:c,referencedTable:l=c}={}){const u=l?`${l}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${r}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:i,referencedTable:o=i}={}){const c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${r}`),this}range(r,i,{foreignTable:o,referencedTable:c=o}={}){const l=typeof c>"u"?"offset":`${c}.offset`,u=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(l,`${r}`),this.url.searchParams.set(u,`${i-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:i=!1,settings:o=!1,buffers:c=!1,wal:l=!1,format:u="text"}={}){var d;const f=[r?"analyze":null,i?"verbose":null,o?"settings":null,c?"buffers":null,l?"wal":null].filter(Boolean).join("|"),h=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return er.default=s,er}var Ra;function go(){if(Ra)return Zn;Ra=1,Object.defineProperty(Zn,"__esModule",{value:!0});const e=fn.__importDefault(nu()),s=new RegExp("[,()]");class n extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}in(i,o){const c=Array.from(new Set(o)).map(l=>typeof l=="string"&&s.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(i,`in.(${c})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:c,type:l}={}){let u="";l==="plain"?u="pl":l==="phrase"?u="ph":l==="websearch"&&(u="w");const d=c===void 0?"":`(${c})`;return this.url.searchParams.append(i,`${u}fts${d}.${o}`),this}match(i){return Object.entries(i).forEach(([o,c])=>{this.url.searchParams.append(o,`eq.${c}`)}),this}not(i,o,c){return this.url.searchParams.append(i,`not.${o}.${c}`),this}or(i,{foreignTable:o,referencedTable:c=o}={}){const l=c?`${c}.or`:"or";return this.url.searchParams.append(l,`(${i})`),this}filter(i,o,c){return this.url.searchParams.append(i,`${o}.${c}`),this}}return Zn.default=n,Zn}var Ua;function ru(){if(Ua)return Qn;Ua=1,Object.defineProperty(Qn,"__esModule",{value:!0});const e=fn.__importDefault(go());class s{constructor(r,{headers:i={},schema:o,fetch:c}){this.url=r,this.headers=new Headers(i),this.schema=o,this.fetch=c}select(r,i){const{head:o=!1,count:c}=i??{},l=o?"HEAD":"GET";let u=!1;const d=(r??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",d),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:i,defaultToNull:o=!0}={}){var c;const l="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const u=r.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(r,{onConflict:i,ignoreDuplicates:o=!1,count:c,defaultToNull:l=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),c&&this.headers.append("Prefer",`count=${c}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const f=r.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(f.length>0){const h=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(r,{count:i}={}){var o;const c="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:r}={}){var i;const o="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return Qn.default=s,Qn}var ja;function Lp(){if(ja)return Xn;ja=1,Object.defineProperty(Xn,"__esModule",{value:!0});const t=fn,e=t.__importDefault(ru()),s=t.__importDefault(go());class n{constructor(i,{headers:o={},schema:c,fetch:l}={}){this.url=i,this.headers=new Headers(o),this.schemaName=c,this.fetch=l}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:c=!1,get:l=!1,count:u}={}){var d;let f;const h=new URL(`${this.url}/rpc/${i}`);let p;c||l?(f=c?"HEAD":"GET",Object.entries(o).filter(([v,k])=>k!==void 0).map(([v,k])=>[v,Array.isArray(k)?`{${k.join(",")}}`:`${k}`]).forEach(([v,k])=>{h.searchParams.append(v,k)})):(f="POST",p=o);const g=new Headers(this.headers);return u&&g.set("Prefer",`count=${u}`),new s.default({method:f,url:h,headers:g,schema:this.schemaName,body:p,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Xn.default=n,Xn}var Ia;function Fp(){if(Ia)return lt;Ia=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.PostgrestError=lt.PostgrestBuilder=lt.PostgrestTransformBuilder=lt.PostgrestFilterBuilder=lt.PostgrestQueryBuilder=lt.PostgrestClient=void 0;const t=fn,e=t.__importDefault(Lp());lt.PostgrestClient=e.default;const s=t.__importDefault(ru());lt.PostgrestQueryBuilder=s.default;const n=t.__importDefault(go());lt.PostgrestFilterBuilder=n.default;const r=t.__importDefault(nu());lt.PostgrestTransformBuilder=r.default;const i=t.__importDefault(su());lt.PostgrestBuilder=i.default;const o=t.__importDefault(tu());return lt.PostgrestError=o.default,lt.default={PostgrestClient:e.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:i.default,PostgrestError:o.default},lt}var iu=Fp();const ou=Np(iu),Mp=Eu({__proto__:null,default:ou},[iu]),{PostgrestClient:Bp,PostgrestQueryBuilder:QS,PostgrestFilterBuilder:ZS,PostgrestTransformBuilder:ek,PostgrestBuilder:tk,PostgrestError:sk}=ou||Mp;class Vp{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const n=s.node,r=parseInt(n.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let s=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(s+=`

Suggested solution: ${e.workaround}`),new Error(s)}static createWebSocket(e,s){const n=this.getWebSocketConstructor();return new n(e,s)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Hp="2.80.0",qp=`realtime-js/${Hp}`,Gp="1.0.0",Ui=1e4,Kp=1e3,Wp=100;var Tn;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Tn||(Tn={}));var tt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(tt||(tt={}));var Bt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Bt||(Bt={}));var ji;(function(t){t.websocket="websocket"})(ji||(ji={}));var Is;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Is||(Is={}));class Jp{constructor(){this.HEADER_LENGTH=1}decode(e,s){return e.constructor===ArrayBuffer?s(this._binaryDecode(e)):s(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const s=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,s,n)}_decodeBroadcast(e,s,n){const r=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const c=n.decode(e.slice(o,o+r));o=o+r;const l=n.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:c,event:l,payload:u}}}class au{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Fe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Fe||(Fe={}));const Na=(t,e,s={})=>{var n;const r=(n=s.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=zp(o,t,e,r),i),{}):{}},zp=(t,e,s,n)=>{const r=e.find(c=>c.name===t),i=r?.type,o=s[t];return i&&!n.includes(i)?lu(i,o):Ii(o)},lu=(t,e)=>{if(t.charAt(0)==="_"){const s=t.slice(1,t.length);return Zp(e,s)}switch(t){case Fe.bool:return Yp(e);case Fe.float4:case Fe.float8:case Fe.int2:case Fe.int4:case Fe.int8:case Fe.numeric:case Fe.oid:return Xp(e);case Fe.json:case Fe.jsonb:return Qp(e);case Fe.timestamp:return em(e);case Fe.abstime:case Fe.date:case Fe.daterange:case Fe.int4range:case Fe.int8range:case Fe.money:case Fe.reltime:case Fe.text:case Fe.time:case Fe.timestamptz:case Fe.timetz:case Fe.tsrange:case Fe.tstzrange:return Ii(e);default:return Ii(e)}},Ii=t=>t,Yp=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Xp=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Qp=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Zp=(t,e)=>{if(typeof t!="string")return t;const s=t.length-1,n=t[s];if(t[0]==="{"&&n==="}"){let i;const o=t.slice(1,s);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>lu(e,c))}return t},em=t=>typeof t=="string"?t.replace(" ","T"):t,cu=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class ii{constructor(e,s,n={},r=Ui){this.channel=e,this.event=s,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var n;return this._hasReceived(e)&&s((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Da;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Da||(Da={}));class $n{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},r=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=$n.syncState(this.state,r,i,o),this.pendingDiffs.forEach(l=>{this.state=$n.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=$n.syncDiff(this.state,r,i,o),c())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,n,r){const i=this.cloneDeep(e),o=this.transformState(s),c={},l={};return this.map(i,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const f=i[u];if(f){const h=d.map(k=>k.presence_ref),p=f.map(k=>k.presence_ref),g=d.filter(k=>p.indexOf(k.presence_ref)<0),v=f.filter(k=>h.indexOf(k.presence_ref)<0);g.length>0&&(c[u]=g),v.length>0&&(l[u]=v)}else c[u]=d}),this.syncDiff(i,{joins:c,leaves:l},n,r)}static syncDiff(e,s,n,r){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(i,(c,l)=>{var u;const d=(u=e[c])!==null&&u!==void 0?u:[];if(e[c]=this.cloneDeep(l),d.length>0){const f=e[c].map(p=>p.presence_ref),h=d.filter(p=>f.indexOf(p.presence_ref)<0);e[c].unshift(...h)}n(c,d,l)}),this.map(o,(c,l)=>{let u=e[c];if(!u)return;const d=l.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),e[c]=u,r(c,u,l),u.length===0&&delete e[c]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(n=>s(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,n)=>{const r=e[n];return"metas"in r?s[n]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[n]=r,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var La;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(La||(La={}));var Pn;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Pn||(Pn={}));var ns;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ns||(ns={}));class vo{constructor(e,s={config:{}},n){var r,i;if(this.topic=e,this.params=s,this.socket=n,this.bindings={},this.state=tt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new ii(this,Bt.join,this.params,this.timeout),this.rejoinTimer=new au(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=tt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=tt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=tt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Bt.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new $n(this),this.broadcastEndpointURL=cu(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,s=this.timeout){var n,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==tt.closed){const{config:{broadcast:o,presence:c,private:l}}=this.params,u=(r=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&r!==void 0?r:[],d=!!this.bindings[Pn.PRESENCE]&&this.bindings[Pn.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},h={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>e?.(ns.CHANNEL_ERROR,p)),this._onClose(()=>e?.(ns.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){e?.(ns.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,k=(g=v?.length)!==null&&g!==void 0?g:0,P=[];for(let R=0;R<k;R++){const S=v[R],{filter:{event:x,schema:j,table:I,filter:_}}=S,U=p&&p[R];if(U&&U.event===x&&U.schema===j&&U.table===I&&U.filter===_)P.push(Object.assign(Object.assign({},S),{id:U.id}));else{this.unsubscribe(),this.state=tt.errored,e?.(ns.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=P,e&&e(ns.SUBSCRIBED);return}}).receive("error",p=>{this.state=tt.errored,e?.(ns.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e?.(ns.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,n){return this.state===tt.joined&&e===Pn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,s,n)}async httpSend(e,s,n={}){var r;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:s,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);if(c.status===202)return{success:!0};let l=c.statusText;try{const u=await c.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(e,s={}){var n,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,l;const u=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=tt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Bt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(r=>{n=new ii(this,Bt.leave,{},e),n.receive("ok",()=>{s(),r("ok")}).receive("timeout",()=>{s(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=tt.closed,this.bindings={}}async _fetchWithTimeout(e,s,n){const r=new AbortController,i=setTimeout(()=>r.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:r.signal}));return clearTimeout(i),o}_push(e,s,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new ii(this,e,s,n);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Wp){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(e,s,n){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,n){var r,i;const o=e.toLocaleLowerCase(),{close:c,error:l,leave:u,join:d}=Bt;if(n&&[c,l,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,s,n);if(s&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var g,v,k;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((k=(v=p.filter)===null||v===void 0?void 0:v.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(p=>p.callback(h,n)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var g,v,k,P,R,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const x=p.id,j=(g=p.filter)===null||g===void 0?void 0:g.event;return x&&((v=s.ids)===null||v===void 0?void 0:v.includes(x))&&(j==="*"||j?.toLocaleLowerCase()===((k=s.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const x=(R=(P=p?.filter)===null||P===void 0?void 0:P.event)===null||R===void 0?void 0:R.toLocaleLowerCase();return x==="*"||x===((S=s?.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:v,table:k,commit_timestamp:P,type:R,errors:S}=g;h=Object.assign(Object.assign({},{schema:v,table:k,commit_timestamp:P,eventType:R,new:{},old:{},errors:S}),this._getPayloadRecords(g))}p.callback(h,n)})}_isClosed(){return this.state===tt.closed}_isJoined(){return this.state===tt.joined}_isJoining(){return this.state===tt.joining}_isLeaving(){return this.state===tt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,n){const r=e.toLocaleLowerCase(),i={type:r,filter:s,callback:n};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,s){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&vo.isEqual(r.filter,s))})),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const n in e)if(e[n]!==s[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Bt.close,{},e)}_onError(e){this._on(Bt.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=tt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=Na(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=Na(e.columns,e.old_record)),s}}const oi=()=>{},nr={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},tm=[1e3,2e3,5e3,1e4],sm=1e4,nm=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class rm{constructor(e,s){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ui,this.transport=null,this.heartbeatIntervalMs=nr.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=oi,this.ref=0,this.reconnectTimer=null,this.logger=oi,this.conn=null,this.sendBuffer=[],this.serializer=new Jp,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((n=s?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${e}/${ji.websocket}`,this.httpEndpoint=cu(e),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Vp.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const s=e.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Gp}))}disconnect(e,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,s??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,n){this.logger(e,s,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Tn.connecting:return Is.Connecting;case Tn.open:return Is.Open;case Tn.closing:return Is.Closing;default:return Is.Closed}}isConnected(){return this.connectionState()===Is.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,s={config:{}}){const n=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===n);if(r)return r;{const i=new vo(`realtime:${e}`,s,this);return this.channels.push(i),i}}push(e){const{topic:s,event:n,payload:r,ref:i}=e,o=()=>{this.encode(e,c=>{var l;(l=this.conn)===null||l===void 0||l.send(c)})};this.log("push",`${s} ${n} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Kp,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},nr.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:r,payload:i,ref:o}=s,c=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${r} ${c}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(r,i,o)),this._triggerStateCallbacks("message",s)})}_clearTimer(e){var s;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var s;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Bt.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const n=e.match(/\?/)?"&":"?",r=new URLSearchParams(s);return`${e}${n}${r}`}_workerObjectUrl(e){let s;if(e)s=e;else{const n=new Blob([nm],{type:"application/javascript"});s=URL.createObjectURL(n)}return s}_setConnectionState(e,s=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(e=null){let s;e?s=e:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(n=>{const r={access_token:s,version:qp};s&&n.updateJoinPayload(r),n.joinedOnce&&n._isJoined()&&n._push(Bt.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${e}`,s)})}_triggerStateCallbacks(e,s){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(s)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new au(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},nr.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var s,n,r,i,o,c,l,u,d;if(this.transport=(s=e?.transport)!==null&&s!==void 0?s:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:Ui,this.heartbeatIntervalMs=(r=e?.heartbeatIntervalMs)!==null&&r!==void 0?r:nr.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:oi,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:(f=>tm[f-1]||sm),this.encode=(u=e?.encode)!==null&&u!==void 0?u:((f,h)=>h(JSON.stringify(f))),this.decode=(d=e?.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class yo extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ve(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class im extends yo{constructor(e,s,n){super(e),this.name="StorageApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ni extends yo{constructor(e,s){super(e),this.name="StorageUnknownError",this.originalError=s}}const bo=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),om=()=>Response,Di=t=>{if(Array.isArray(t))return t.map(s=>Di(s));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([s,n])=>{const r=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=Di(n)}),e},am=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},ai=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},lm=(t,e,s)=>de(void 0,void 0,void 0,function*(){const n=yield om();t instanceof n&&!s?.noResolveJson?t.json().then(r=>{const i=t.status||500,o=r?.statusCode||i+"";e(new im(ai(r),i,o))}).catch(r=>{e(new Ni(ai(r),r))}):e(new Ni(ai(t),t))}),cm=(t,e,s,n)=>{const r={method:t,headers:e?.headers||{}};return t==="GET"||!n?r:(am(n)?(r.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(n)):r.body=n,e?.duplex&&(r.duplex=e.duplex),Object.assign(Object.assign({},r),s))};function qn(t,e,s,n,r,i){return de(this,void 0,void 0,function*(){return new Promise((o,c)=>{t(s,cm(e,n,r,i)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>lm(l,c,n))})})}function Ln(t,e,s,n){return de(this,void 0,void 0,function*(){return qn(t,"GET",e,s,n)})}function Mt(t,e,s,n,r){return de(this,void 0,void 0,function*(){return qn(t,"POST",e,n,r,s)})}function Li(t,e,s,n,r){return de(this,void 0,void 0,function*(){return qn(t,"PUT",e,n,r,s)})}function um(t,e,s,n){return de(this,void 0,void 0,function*(){return qn(t,"HEAD",e,Object.assign(Object.assign({},s),{noResolveJson:!0}),n)})}function _o(t,e,s,n,r){return de(this,void 0,void 0,function*(){return qn(t,"DELETE",e,n,r,s)})}class dm{constructor(e,s){this.downloadFn=e,this.shouldThrowOnError=s}then(e,s){return this.execute().then(e,s)}execute(){return de(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ve(e))return{data:null,error:e};throw e}})}}var uu;class fm{constructor(e,s){this.downloadFn=e,this.shouldThrowOnError=s,this[uu]="BlobDownloadBuilder",this.promise=null}asStream(){return new dm(this.downloadFn,this.shouldThrowOnError)}then(e,s){return this.getPromise().then(e,s)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return de(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ve(e))return{data:null,error:e};throw e}})}}uu=Symbol.toStringTag;const hm={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Fa={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class pm{constructor(e,s={},n,r){this.shouldThrowOnError=!1,this.url=e,this.headers=s,this.bucketId=n,this.fetch=bo(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,s,n,r){return de(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Fa),r);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(l))):(i=n,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,l&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),r?.headers&&(c=Object.assign(Object.assign({},c),r.headers));const u=this._removeEmptyFolders(s),d=this._getFinalPath(u),f=yield(e=="PUT"?Li:Mt)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ve(i))return{data:null,error:i};throw i}})}upload(e,s,n){return de(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,s,n)})}uploadToSignedUrl(e,s,n,r){return de(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",s);try{let l;const u=Object.assign({upsert:Fa.upsert},r),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield Li(this.fetch,c.toString(),l,{headers:d});return{data:{path:i,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ve(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,s){return de(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);s?.upsert&&(r["x-upsert"]="true");const i=yield Mt(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:r}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new yo("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ve(n))return{data:null,error:n};throw n}})}update(e,s,n){return de(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,s,n)})}move(e,s,n){return de(this,void 0,void 0,function*(){try{return{data:yield Mt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ve(r))return{data:null,error:r};throw r}})}copy(e,s,n){return de(this,void 0,void 0,function*(){try{return{data:{path:(yield Mt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ve(r))return{data:null,error:r};throw r}})}createSignedUrl(e,s,n){return de(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield Mt(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:s},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ve(r))return{data:null,error:r};throw r}})}createSignedUrls(e,s,n){return de(this,void 0,void 0,function*(){try{const r=yield Mt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:e},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ve(r))return{data:null,error:r};throw r}})}download(e,s){const r=typeof s?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(s?.transform||{}),o=i?`?${i}`:"",c=this._getFinalPath(e),l=()=>Ln(this.fetch,`${this.url}/${r}/${c}${o}`,{headers:this.headers,noResolveJson:!0});return new fm(l,this.shouldThrowOnError)}info(e){return de(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{const n=yield Ln(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Di(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ve(n))return{data:null,error:n};throw n}})}exists(e){return de(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{return yield um(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ve(n)&&n instanceof Ni){const r=n.originalError;if([400,404].includes(r?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,s){const n=this._getFinalPath(e),r=[],i=s?.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&r.push(i);const c=typeof s?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(s?.transform||{});l!==""&&r.push(l);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${n}${u}`)}}}remove(e){return de(this,void 0,void 0,function*(){try{return{data:yield _o(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}list(e,s,n){return de(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},hm),s),{prefix:e||""});return{data:yield Mt(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ve(r))return{data:null,error:r};throw r}})}listV2(e,s){return de(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Mt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ve(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const s=[];return e.width&&s.push(`width=${e.width}`),e.height&&s.push(`height=${e.height}`),e.resize&&s.push(`resize=${e.resize}`),e.format&&s.push(`format=${e.format}`),e.quality&&s.push(`quality=${e.quality}`),s.join("&")}}const du="2.80.0",fu={"X-Client-Info":`storage-js/${du}`};class mm{constructor(e,s={},n,r){this.shouldThrowOnError=!1;const i=new URL(e);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fu),s),this.fetch=bo(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return de(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(e);return{data:yield Ln(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}getBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield Ln(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}createBucket(e){return de(this,arguments,void 0,function*(s,n={public:!1}){try{return{data:yield Mt(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ve(r))return{data:null,error:r};throw r}})}updateBucket(e,s){return de(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ve(n))return{data:null,error:n};throw n}})}emptyBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield Mt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}deleteBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield _o(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(e){const s={};return e&&("limit"in e&&(s.limit=String(e.limit)),"offset"in e&&(s.offset=String(e.offset)),e.search&&(s.search=e.search),e.sortColumn&&(s.sortColumn=e.sortColumn),e.sortOrder&&(s.sortOrder=e.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class gm{constructor(e,s={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fu),s),this.fetch=bo(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield Mt(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}listBuckets(e){return de(this,void 0,void 0,function*(){try{const s=new URLSearchParams;e?.limit!==void 0&&s.set("limit",e.limit.toString()),e?.offset!==void 0&&s.set("offset",e.offset.toString()),e?.sortColumn&&s.set("sortColumn",e.sortColumn),e?.sortOrder&&s.set("sortOrder",e.sortOrder),e?.search&&s.set("search",e.search);const n=s.toString(),r=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Ln(this.fetch,r,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}deleteBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield _o(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ve(s))return{data:null,error:s};throw s}})}}const wo={"X-Client-Info":`storage-js/${du}`,"Content-Type":"application/json"};class hu extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Et(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class li extends hu{constructor(e,s,n){super(e),this.name="StorageVectorsApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class vm extends hu{constructor(e,s){super(e),this.name="StorageVectorsUnknownError",this.originalError=s}}var Ma;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Ma||(Ma={}));const xo=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ym=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Ba=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),bm=(t,e,s)=>de(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!s?.noResolveJson){const r=t.status||500,i=t;if(typeof i.json=="function")i.json().then(o=>{const c=o?.statusCode||o?.code||r+"";e(new li(Ba(o),r,c))}).catch(()=>{const o=r+"",c=i.statusText||`HTTP ${r} error`;e(new li(c,r,o))});else{const o=r+"",c=i.statusText||`HTTP ${r} error`;e(new li(c,r,o))}}else e(new vm(Ba(t),t))}),_m=(t,e,s,n)=>{const r={method:t,headers:e?.headers||{}};return n?(ym(n)?(r.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(n)):r.body=n,Object.assign(Object.assign({},r),s)):r};function wm(t,e,s,n,r,i){return de(this,void 0,void 0,function*(){return new Promise((o,c)=>{t(s,_m(e,n,r,i)).then(l=>{if(!l.ok)throw l;if(n?.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>bm(l,c,n))})})}function Ct(t,e,s,n,r){return de(this,void 0,void 0,function*(){return wm(t,"POST",e,n,r,s)})}class xm{constructor(e,s={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wo),s),this.fetch=xo(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return de(this,void 0,void 0,function*(){try{return{data:(yield Ct(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}getIndex(e,s){return de(this,void 0,void 0,function*(){try{return{data:yield Ct(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:s},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}listIndexes(e){return de(this,void 0,void 0,function*(){try{return{data:yield Ct(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}deleteIndex(e,s){return de(this,void 0,void 0,function*(){try{return{data:(yield Ct(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:s},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}}class Sm{constructor(e,s={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wo),s),this.fetch=xo(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return de(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Ct(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}getVectors(e){return de(this,void 0,void 0,function*(){try{return{data:yield Ct(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}listVectors(e){return de(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Ct(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}queryVectors(e){return de(this,void 0,void 0,function*(){try{return{data:yield Ct(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}deleteVectors(e){return de(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Ct(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}}class km{constructor(e,s={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wo),s),this.fetch=xo(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return de(this,void 0,void 0,function*(){try{return{data:(yield Ct(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}getBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield Ct(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}listBuckets(){return de(this,arguments,void 0,function*(e={}){try{return{data:yield Ct(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}deleteBucket(e){return de(this,void 0,void 0,function*(){try{return{data:(yield Ct(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}}class Am extends km{constructor(e,s={}){super(e,s.headers||{},s.fetch)}from(e){return new Em(this.url,this.headers,e,this.fetch)}}class Em extends xm{constructor(e,s,n,r){super(e,s,r),this.vectorBucketName=n}createIndex(e){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return de(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return de(this,arguments,void 0,function*(s={}){return e.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return de(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return de(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Cm(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Cm extends Sm{constructor(e,s,n,r,i){super(e,s,i),this.vectorBucketName=n,this.indexName=r}putVectors(e){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return de(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return de(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return de(this,arguments,void 0,function*(s={}){return e.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return de(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return de(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Om extends mm{constructor(e,s={},n,r){super(e,s,n,r)}from(e){return new pm(this.url,this.headers,e,this.fetch)}get vectors(){return new Am(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new gm(this.url+"/iceberg",this.headers,this.fetch)}}const Tm="2.80.0";let bn="";typeof Deno<"u"?bn="deno":typeof document<"u"?bn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?bn="react-native":bn="node";const $m={"X-Client-Info":`supabase-js-${bn}/${Tm}`},Pm={headers:$m},Rm={schema:"public"},Um={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jm={},Im=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Nm=()=>Headers,Dm=(t,e,s)=>{const n=Im(s),r=Nm();return async(i,o)=>{var c;const l=(c=await e())!==null&&c!==void 0?c:t;let u=new r(o?.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:u}))}};function Lm(t){return t.endsWith("/")?t:t+"/"}function Fm(t,e){var s,n;const{db:r,auth:i,realtime:o,global:c}=t,{db:l,auth:u,realtime:d,global:f}=e,h={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),c),{headers:Object.assign(Object.assign({},(s=f?.headers)!==null&&s!==void 0?s:{}),(n=c?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}function Mm(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Lm(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const pu="2.80.0",Qs=30*1e3,Fi=3,ci=Fi*Qs,Bm="http://localhost:9999",Vm="supabase.auth.token",Hm={"X-Client-Info":`gotrue-js/${pu}`},Mi="X-Supabase-Api-Version",mu={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},qm=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Gm=600*1e3;class Fn extends Error{constructor(e,s,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=n}}function pe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Km extends Fn{constructor(e,s,n){super(e,s,n),this.name="AuthApiError",this.status=s,this.code=n}}function Wm(t){return pe(t)&&t.name==="AuthApiError"}class Ns extends Fn{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class Cs extends Fn{constructor(e,s,n,r){super(e,n,r),this.name=s,this.status=n}}class Lt extends Cs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Jm(t){return pe(t)&&t.name==="AuthSessionMissingError"}class qs extends Cs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rr extends Cs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ir extends Cs{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function zm(t){return pe(t)&&t.name==="AuthImplicitGrantRedirectError"}class Va extends Cs{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bi extends Cs{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function ui(t){return pe(t)&&t.name==="AuthRetryableFetchError"}class Ha extends Cs{constructor(e,s,n){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=n}}class Vi extends Cs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),qa=` 	
\r=`.split(""),Ym=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<qa.length;e+=1)t[qa[e].charCodeAt(0)]=-2;for(let e=0;e<kr.length;e+=1)t[kr[e].charCodeAt(0)]=e;return t})();function Ga(t,e,s){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;s(kr[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;s(kr[n]),e.queuedBits-=6}}function gu(t,e,s){const n=Ym[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Ka(t){const e=[],s=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=o=>{Zm(o,n,s)};for(let o=0;o<t.length;o+=1)gu(t.charCodeAt(o),r,i);return e.join("")}function Xm(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Qm(t,e){for(let s=0;s<t.length;s+=1){let n=t.charCodeAt(s);if(n>55295&&n<=56319){const r=(n-55296)*1024&65535;n=(t.charCodeAt(s+1)-56320&65535|r)+65536,s+=1}Xm(n,e)}}function Zm(t,e,s){if(e.utf8seq===0){if(t<=127){s(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function nn(t){const e=[],s={queue:0,queuedBits:0},n=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)gu(t.charCodeAt(r),s,n);return new Uint8Array(e)}function eg(t){const e=[];return Qm(t,s=>e.push(s)),new Uint8Array(e)}function Ls(t){const e=[],s={queue:0,queuedBits:0},n=r=>{e.push(r)};return t.forEach(r=>Ga(r,s,n)),Ga(null,s,n),e.join("")}function tg(t){return Math.round(Date.now()/1e3)+t}function sg(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const ct=()=>typeof window<"u"&&typeof document<"u",Ps={tested:!1,writable:!1},vu=()=>{if(!ct())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ps.tested)return Ps.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ps.tested=!0,Ps.writable=!0}catch{Ps.tested=!0,Ps.writable=!1}return Ps.writable};function ng(t){const e={},s=new URL(t);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return s.searchParams.forEach((n,r)=>{e[r]=n}),e}const yu=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),rg=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Zs=async(t,e,s)=>{await t.setItem(e,JSON.stringify(s))},Rs=async(t,e)=>{const s=await t.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},ps=async(t,e)=>{await t.removeItem(e)};class Vr{constructor(){this.promise=new Vr.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}Vr.promiseConstructor=Promise;function di(t){const e=t.split(".");if(e.length!==3)throw new Vi("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!qm.test(e[n]))throw new Vi("JWT not in base64url format");return{header:JSON.parse(Ka(e[0])),payload:JSON.parse(Ka(e[1])),signature:nn(e[2]),raw:{header:e[0],payload:e[1]}}}async function ig(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function og(t,e){return new Promise((n,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function ag(t){return("0"+t.toString(16)).substr(-2)}function lg(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=s.length;let r="";for(let i=0;i<56;i++)r+=s.charAt(Math.floor(Math.random()*n));return r}return crypto.getRandomValues(e),Array.from(e,ag).join("")}async function cg(t){const s=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",s),r=new Uint8Array(n);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function ug(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const s=await cg(t);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gs(t,e,s=!1){const n=lg();let r=n;s&&(r+="/PASSWORD_RECOVERY"),await Zs(t,`${e}-code-verifier`,r);const i=await ug(n);return[i,n===i?"plain":"s256"]}const dg=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function fg(t){const e=t.headers.get(Mi);if(!e||!e.match(dg))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function hg(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function pg(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const mg=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ks(t){if(!mg.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function fi(){const t={};return new Proxy(t,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const n=s.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function gg(t,e){return new Proxy(t,{get:(s,n,r)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,n,r)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(s,n,r)}})}function Wa(t){return JSON.parse(JSON.stringify(t))}const js=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),vg=[502,503,504];async function Ja(t){var e;if(!rg(t))throw new Bi(js(t),0);if(vg.includes(t.status))throw new Bi(js(t),t.status);let s;try{s=await t.json()}catch(i){throw new Ns(js(i),i)}let n;const r=fg(t);if(r&&r.getTime()>=mu["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?n=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(n=s.error_code),n){if(n==="weak_password")throw new Ha(js(s),t.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Lt}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ha(js(s),t.status,s.weak_password.reasons);throw new Km(js(s),t.status||500,n)}const yg=(t,e,s,n)=>{const r={method:t,headers:e?.headers||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),r.body=JSON.stringify(n),Object.assign(Object.assign({},r),s))};async function ye(t,e,s,n){var r;const i=Object.assign({},n?.headers);i[Mi]||(i[Mi]=mu["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(r=n?.query)!==null&&r!==void 0?r:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await bg(t,e,s+c,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function bg(t,e,s,n,r,i){const o=yg(e,n,r,i);let c;try{c=await t(s,Object.assign({},o))}catch(l){throw console.error(l),new Bi(js(l),0)}if(c.ok||await Ja(c),n?.noResolveJson)return c;try{return await c.json()}catch(l){await Ja(l)}}function Ft(t){var e;let s=null;xg(t)&&(s=Object.assign({},t),t.expires_at||(s.expires_at=tg(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:s,user:n},error:null}}function za(t){const e=Ft(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((s,n)=>s&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function bs(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function _g(t){return{data:t,error:null}}function wg(t){const{action_link:e,email_otp:s,hashed_token:n,redirect_to:r,verification_type:i}=t,o=dn(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:s,hashed_token:n,redirect_to:r,verification_type:i},l=Object.assign({},o);return{data:{properties:c,user:l},error:null}}function Ya(t){return t}function xg(t){return t.access_token&&t.refresh_token&&t.expires_in}const hi=["global","local","others"];class Sg{constructor({url:e="",headers:s={},fetch:n}){this.url=e,this.headers=s,this.fetch=yu(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,s=hi[0]){if(hi.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hi.join(", ")}`);try{return await ye(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(pe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,s={}){try{return await ye(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:bs})}catch(n){if(pe(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:s}=e,n=dn(e,["options"]),r=Object.assign(Object.assign({},n),s);return"newEmail"in n&&(r.new_email=n?.newEmail,delete r.newEmail),await ye(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:wg,redirectTo:s?.redirectTo})}catch(s){if(pe(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await ye(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:bs})}catch(s){if(pe(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,n,r,i,o,c,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ye(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(s=e?.page)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:"",per_page:(i=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:Ya});if(d.error)throw d.error;const f=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(g.split(";")[1].split("=")[1]);u[`${k}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(pe(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Ks(e);try{return await ye(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:bs})}catch(s){if(pe(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){Ks(e);try{return await ye(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:bs})}catch(n){if(pe(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,s=!1){Ks(e);try{return await ye(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:bs})}catch(n){if(pe(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Ks(e.userId);try{const{data:s,error:n}=await ye(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:s,error:n}}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _deleteFactor(e){Ks(e.userId),Ks(e.id);try{return{data:await ye(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _listOAuthClients(e){var s,n,r,i,o,c,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ye(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(s=e?.page)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:"",per_page:(i=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:Ya});if(d.error)throw d.error;const f=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(g.split(";")[1].split("=")[1]);u[`${k}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(pe(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ye(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _getOAuthClient(e){try{return await ye(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _updateOAuthClient(e,s){try{return await ye(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:s,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(pe(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await ye(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(e){try{return await ye(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(pe(s))return{data:null,error:s};throw s}}}function Xa(t={}){return{getItem:e=>t[e]||null,setItem:(e,s)=>{t[e]=s},removeItem:e=>{delete t[e]}}}const Ws={debug:!!(globalThis&&vu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bu extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class kg extends bu{}async function Ag(t,e,s){Ws.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Ws.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async r=>{if(r){Ws.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await s()}finally{Ws.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw Ws.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new kg(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ws.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function Eg(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function _u(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function Cg(t){return parseInt(t,16)}function Og(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function Tg(t){var e;const{chainId:s,domain:n,expirationTime:r,issuedAt:i=new Date,nonce:o,notBefore:c,requestId:l,resources:u,scheme:d,uri:f,version:h}=t;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=_u(t.address),g=d?`${d}://${n}`:n,v=t.statement?`${t.statement}
`:"",k=`${g} wants you to sign in with your Ethereum account:
${p}

${v}`;let P=`URI: ${f}
Version: ${h}
Chain ID: ${s}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(r&&(P+=`
Expiration Time: ${r.toISOString()}`),c&&(P+=`
Not Before: ${c.toISOString()}`),l&&(P+=`
Request ID: ${l}`),u){let R=`
Resources:`;for(const S of u){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);R+=`
- ${S}`}P+=R}return`${k}
${P}`}class ze extends Error{constructor({message:e,code:s,cause:n,name:r}){var i;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=r??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=s}}class Ar extends ze{constructor(e,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:e}),this.name="WebAuthnUnknownError",this.originalError=s}}function $g({error:t,options:e}){var s,n,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ze({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new ze({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new ze({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new ze({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new ze({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new ze({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new ze({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new ze({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(wu(o)){if(i.rp.id!==o)return new ze({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ze({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new ze({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new ze({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new ze({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Pg({error:t,options:e}){const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ze({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new ze({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(wu(n)){if(s.rpId!==n)return new ze({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ze({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new ze({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new ze({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Rg{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Ug=new Rg;function jg(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:s,excludeCredentials:n}=t,r=dn(t,["challenge","user","excludeCredentials"]),i=nn(e).buffer,o=Object.assign(Object.assign({},s),{id:nn(s.id).buffer}),c=Object.assign(Object.assign({},r),{challenge:i,user:o});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const u=n[l];c.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:nn(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return c}function Ig(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:s}=t,n=dn(t,["challenge","allowCredentials"]),r=nn(e).buffer,i=Object.assign(Object.assign({},n),{challenge:r});if(s&&s.length>0){i.allowCredentials=new Array(s.length);for(let o=0;o<s.length;o++){const c=s[o];i.allowCredentials[o]=Object.assign(Object.assign({},c),{id:nn(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function Ng(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const s=t;return{id:t.id,rawId:t.id,response:{attestationObject:Ls(new Uint8Array(t.response.attestationObject)),clientDataJSON:Ls(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=s.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Dg(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const s=t,n=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Ls(new Uint8Array(r.authenticatorData)),clientDataJSON:Ls(new Uint8Array(r.clientDataJSON)),signature:Ls(new Uint8Array(r.signature)),userHandle:r.userHandle?Ls(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=s.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function wu(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Qa(){var t,e;return!!(ct()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Lg(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ar("Browser returned unexpected credential type",e)}:{data:null,error:new Ar("Empty credential response",e)}}catch(e){return{data:null,error:$g({error:e,options:t})}}}async function Fg(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ar("Browser returned unexpected credential type",e)}:{data:null,error:new Ar("Empty credential response",e)}}catch(e){return{data:null,error:Pg({error:e,options:t})}}}const Mg={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Bg={userVerification:"preferred",hints:["security-key"]};function Er(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),s=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),n={};for(const r of t)if(r)for(const i in r){const o=r[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(s(o))n[i]=o;else if(e(o)){const c=n[i];e(c)?n[i]=Er(c,o):n[i]=Er(o)}else n[i]=o}return n}function Vg(t,e){return Er(Mg,t,e||{})}function Hg(t,e){return Er(Bg,t,e||{})}class qg{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:s,friendlyName:n,signal:r},i){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:s});if(!o)return{data:null,error:c};const l=r??Ug.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=Vg(o.webauthn.credential_options.publicKey,i?.create),{data:d,error:f}=await Lg({publicKey:u,signal:l});return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=Hg(o.webauthn.credential_options.publicKey,i?.request),{data:d,error:f}=await Fg(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(o){return pe(o)?{data:null,error:o}:{data:null,error:new Ns("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:s,webauthn:n}){return this.client.mfa.verify({factorId:s,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:r}},i){if(!s)return{data:null,error:new Fn("rpId is required for WebAuthn authentication")};try{if(!Qa())return{data:null,error:new Ns("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:e,webauthn:{rpId:s,rpOrigins:n},signal:r},{request:i});if(!o)return{data:null,error:c};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:s,rpOrigins:n,credential_response:l.credential_response}})}catch(o){return pe(o)?{data:null,error:o}:{data:null,error:new Ns("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:r},i){if(!s)return{data:null,error:new Fn("rpId is required for WebAuthn registration")};try{if(!Qa())return{data:null,error:new Ns("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===e&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d?.id}):void 0),{data:null,error:c};const{data:l,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:s,rpOrigins:n},signal:r},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:s,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(o){return pe(o)?{data:null,error:o}:{data:null,error:new Ns("Unexpected error in register",o)}}}}Eg();const Gg={url:Bm,storageKey:Vm,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Hm,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Za(t,e,s){return await s()}const Js={};class Mn{get jwks(){var e,s;return(s=(e=Js[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){Js[this.storageKey]=Object.assign(Object.assign({},Js[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=Js[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Js[this.storageKey]=Object.assign(Object.assign({},Js[this.storageKey]),{cachedAt:e})}constructor(e){var s,n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},Gg),e);if(this.storageKey=i.storageKey,this.instanceID=(s=Mn.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,Mn.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&ct()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Sg({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=yu(i.fetch),this.lock=i.lock||Za,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:ct()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=Ag:this.lock=Za,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new qg(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:vu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Xa(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Xa(this.memoryStorage)),ct()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${pu}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let s={},n="none";if(ct()&&(s=ng(window.location.href),this._isImplicitGrantCallback(s)?n="implicit":await this._isPKCECallback(s)&&(n="pkce")),ct()&&this.detectSessionInUrl&&n!=="none"){const{data:r,error:i}=await this._getSessionFromURL(s,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),zm(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return pe(s)?this._returnResult({error:s}):this._returnResult({error:new Ns("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,n,r;try{const i=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(s=e?.options)===null||s===void 0?void 0:s.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(r=e?.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ft}),{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(pe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var s,n,r;try{let i;if("email"in e){const{email:d,password:f,options:h}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Gs(this.storage,this.storageKey)),i=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:d,password:f,data:(s=h?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:p,code_challenge_method:g},xform:Ft})}else if("phone"in e){const{phone:d,password:f,options:h}=e;i=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(r=h?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Ft})}else throw new rr("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(pe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let s;if("email"in e){const{email:i,password:o,options:c}=e;s=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:za})}else if("phone"in e){const{phone:i,password:o,options:c}=e;s=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:za})}else throw new rr("You must provide either an email or phone number and a password");const{data:n,error:r}=s;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!n||!n.session||!n.user){const i=new qs;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r})}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(e){var s,n,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;switch(s){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(e){var s,n,r,i,o,c,l,u,d,f,h;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:v,wallet:k,statement:P,options:R}=e;let S;if(ct())if(typeof k=="object")S=k;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")S=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=k}const x=new URL((s=R?.url)!==null&&s!==void 0?s:window.location.href),j=await S.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=_u(j[0]);let _=(n=R?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!_){const B=await S.request({method:"eth_chainId"});_=Cg(B)}const U={domain:x.host,address:I,statement:P,uri:x.href,version:"1",chainId:_,nonce:(r=R?.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(i=R?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=R?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(l=R?.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=R?.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=R?.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=Tg(U),g=await S.request({method:"personal_sign",params:[Og(p),I]})}try{const{data:v,error:k}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ft});if(k)throw k;if(!v||!v.session||!v.user){const P=new qs;return this._returnResult({data:{user:null,session:null},error:P})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:k})}catch(v){if(pe(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(e){var s,n,r,i,o,c,l,u,d,f,h,p;let g,v;if("message"in e)g=e.message,v=e.signature;else{const{chain:k,wallet:P,statement:R,options:S}=e;let x;if(ct())if(typeof P=="object")x=P;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))x=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=P}const j=new URL((s=S?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in x&&x.signIn){const I=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),R?{statement:R}:null));let _;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")_=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)_=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)g=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),v=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${j.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...R?["",R,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(r=(n=S?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=S?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((o=S?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((c=S?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((l=S?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((u=S?.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((f=(d=S?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...S.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const I=await x.signMessage(new TextEncoder().encode(g),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=I}}try{const{data:k,error:P}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Ls(v)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ft});if(P)throw P;if(!k||!k.session||!k.user){const R=new qs;return this._returnResult({data:{user:null,session:null},error:R})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:P})}catch(k){if(pe(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async _exchangeCodeForSession(e){const s=await Rs(this.storage,`${this.storageKey}-code-verifier`),[n,r]=(s??"").split("/");try{const{data:i,error:o}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Ft});if(await ps(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const c=new qs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}catch(i){if(pe(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:s,provider:n,token:r,access_token:i,nonce:o}=e,c=await ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Ft}),{data:l,error:u}=c;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new qs;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(e){var s,n,r,i,o;try{if("email"in e){const{email:c,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Gs(this.storage,this.storageKey));const{error:f}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in e){const{phone:c,options:l}=e,{data:u,error:d}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u?.message_id},error:d})}throw new rr("You must provide either an email or phone number.")}catch(c){if(pe(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var s,n;try{let r,i;"options"in e&&(r=(s=e.options)===null||s===void 0?void 0:s.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:c}=await ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Ft});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var s,n,r;try{let i=null,o=null;this.flowType==="pkce"&&([i,o]=await Gs(this.storage,this.storageKey));const c=await ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&n!==void 0?n:void 0}),!((r=e?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:_g});return this._returnResult(c)}catch(i){if(pe(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:n}=e;if(n)throw n;if(!s)throw new Lt;const{error:r}=await ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(pe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:n,type:r,options:i}=e,{error:o}=await ye(this.fetch,"POST",s,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:n,type:r,options:i}=e,{data:o,error:c}=await ye(this.fetch,"POST",s,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:c})}throw new rr("You must provide either an email or phone number and a type")}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await n,await s()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=s();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await Rs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<ci:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await Rs(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=fi()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=gg(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:bs}):await this._useSession(async s=>{var n,r,i;const{data:o,error:c}=s;if(c)throw c;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Lt}:await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:bs})})}catch(s){if(pe(s))return Jm(s)&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async n=>{const{data:r,error:i}=n;if(i)throw i;if(!r.session)throw new Lt;const o=r.session;let c=null,l=null;this.flowType==="pkce"&&e.email!=null&&([c,l]=await Gs(this.storage,this.storageKey));const{data:u,error:d}=await ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:l}),jwt:o.access_token,xform:bs});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(pe(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Lt;const s=Date.now()/1e3;let n=s,r=!0,i=null;const{payload:o}=di(e.access_token);if(o.exp&&(n=o.exp,r=n<=s),r){const{data:c,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-s,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(s){if(pe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var n;if(!e){const{data:o,error:c}=s;if(c)throw c;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Lt;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(e,s){try{if(!ct())throw new ir("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ir(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Va("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ir("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Va("No code detected.");const{data:R,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:R.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:c,expires_at:l,token_type:u}=e;if(!i||!c||!o||!u)throw new ir("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(c);let h=d+f;l&&(h=parseInt(l));const p=h-d;p*1e3<=Qs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const g=h-f;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,d);const{data:v,error:k}=await this._getUser(i);if(k)throw k;const P={provider_token:n,provider_refresh_token:r,access_token:i,expires_in:f,expires_at:h,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:P,redirectType:e.type},error:null})}catch(n){if(pe(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await Rs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var n;const{data:r,error:i}=s;if(i)return this._returnResult({error:i});const o=(n=r.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(Wm(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const s=sg(),n={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async s=>{var n,r;try{const{data:{session:i},error:o}=s;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,s={}){let n=null,r=null;this.flowType==="pkce"&&([n,r]=await Gs(this.storage,this.storageKey,!0));try{return await ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(pe(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:s,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var s;try{const{data:n,error:r}=await this._useSession(async i=>{var o,c,l,u,d;const{data:f,error:h}=i;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ye(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(r)throw r;return ct()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:e.provider,url:n?.url},error:null})}catch(n){if(pe(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async s=>{var n;try{const{error:r,data:{session:i}}=s;if(r)throw r;const{options:o,provider:c,token:l,access_token:u,nonce:d}=e,f=await ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Ft}),{data:h,error:p}=f;return p?this._returnResult({data:{user:null,session:null},error:p}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new qs}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:p}))}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async s=>{var n,r;const{data:i,error:o}=s;if(o)throw o;return await ye(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&r!==void 0?r:void 0})})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const n=Date.now();return await og(async r=>(r>0&&await ig(200*Math.pow(2,r-1)),this._debug(s,"refreshing attempt",r),await ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ft})),(r,i)=>{const o=200*Math.pow(2,r);return i&&ui(i)&&Date.now()+o-n<Qs})}catch(n){if(this._debug(s,"error",n),pe(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",n),ct()&&!s.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,s;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Rs(this.storage,this.storageKey);if(r&&this.userStorage){let o=await Rs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await Zs(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o?.user)!==null&&e!==void 0?e:fi()}else if(r&&!r.user&&!r.user){const o=await Rs(this.storage,this.storageKey+"-user");o&&o?.user?(r.user=o.user,await ps(this.storage,this.storageKey+"-user"),await Zs(this.storage,this.storageKey,r)):r.user=fi()}if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const i=((s=r.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<ci;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${ci}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),ui(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(r.access_token);!c&&o?.user?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var s,n;if(!e)throw new Lt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Vr;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Lt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(r,"error",i),pe(i)){const o={data:null,error:i};return ui(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,s,n=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",s,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,s)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const s=Object.assign({},e),n=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&s.user&&await Zs(this.userStorage,this.storageKey+"-user",{user:s.user});const r=Object.assign({},s);delete r.user;const i=Wa(r);await Zs(this.storage,this.storageKey,i)}else{const r=Wa(s);await Zs(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await ps(this.storage,this.storageKey),await ps(this.storage,this.storageKey+"-code-verifier"),await ps(this.storage,this.storageKey+"-user"),this.userStorage&&await ps(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ct()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Qs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:n}}=s;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((n.expires_at*1e3-e)/Qs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Qs}ms, refresh threshold is ${Fi} ticks`),r<=Fi&&await this._callRefreshToken(n.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bu)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ct()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,n){const r=[`provider=${encodeURIComponent(s)}`];if(n?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&r.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await Gs(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(c.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);r.push(i.toString())}return n?.skipBrowserRedirect&&r.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var n;const{data:r,error:i}=s;return i?this._returnResult({data:null,error:i}):await ye(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=r?.session)===null||n===void 0?void 0:n.access_token})})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(e){try{return await this._useSession(async s=>{var n,r;const{data:i,error:o}=s;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await ye(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&l.type==="totp"&&(!((r=l?.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:r,error:i}=s;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Ng(e.webauthn.credential_response):Dg(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:l}=await ye(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=r?.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:l}))})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:r,error:i}=s;if(i)return this._returnResult({data:null,error:i});const o=await ye(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=r?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:jg(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:Ig(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(e){const{data:s,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){var e;const{data:{user:s},error:n}=await this.getUser();if(n)return{data:null,error:n};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=s?.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,s;const{data:{session:n},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=di(n.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((s=(e=n.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async s=>{const{data:{session:n},error:r}=s;return r?this._returnResult({data:null,error:r}):n?await ye(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Lt})})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(e,s){try{return await this._useSession(async n=>{const{data:{session:r},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new Lt});const o=await ye(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&ct()&&!s?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(pe(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,s){try{return await this._useSession(async n=>{const{data:{session:r},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new Lt});const o=await ye(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&ct()&&!s?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(pe(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,s={keys:[]}){let n=s.keys.find(c=>c.kid===e);if(n)return n;const r=Date.now();if(n=this.jwks.keys.find(c=>c.kid===e),n&&this.jwks_cached_at+Gm>r)return n;const{data:i,error:o}=await ye(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,n=i.keys.find(c=>c.kid===e),!n)?null:n}async getClaims(e,s={}){try{let n=e;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});n=p.session.access_token}const{header:r,payload:i,signature:o,raw:{header:c,payload:l}}=di(n);s?.allowExpired||hg(i.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:r,signature:o},error:null}}const d=pg(r.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,o,eg(`${c}.${l}`)))throw new Vi("Invalid JWT signature");return{data:{claims:i,header:r,signature:o},error:null}}catch(n){if(pe(n))return this._returnResult({data:null,error:n});throw n}}}Mn.nextInstanceID={};const Kg=Mn;class Wg extends Kg{constructor(e){super(e)}}class Jg{constructor(e,s,n){var r,i,o;this.supabaseUrl=e,this.supabaseKey=s;const c=Mm(e);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:Rm,realtime:jm,auth:Object.assign(Object.assign({},Um),{storageKey:l}),global:Pm},d=Fm(n??{},u);this.storageKey=(r=d.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=Dm(s,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Bp(new URL("rest/v1",c).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Om(this.storageUrl.href,this.headers,this.fetch,n?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Ip(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,s={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,s,n)}channel(e,s={config:{}}){return this.realtime.channel(e,s)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,s;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(s=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:s,detectSessionInUrl:n,storage:r,userStorage:i,storageKey:o,flowType:c,lock:l,debug:u,throwOnError:d},f,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Wg({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),f),storageKey:o,autoRefreshToken:e,persistSession:s,detectSessionInUrl:n,storage:r,userStorage:i,flowType:c,lock:l,debug:u,throwOnError:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new rm(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,n)=>{this._handleTokenChanged(s,"CLIENT",n?.access_token)})}_handleTokenChanged(e,s,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zg=(t,e,s)=>new Jg(t,e,s);function Yg(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Yg()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Xg="https://rlcepiyvbxfzjtrxpqad.supabase.co",Qg="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJsY2VwaXl2Ynhmemp0cnhwcWFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NDYzNzgsImV4cCI6MjA3ODAyMjM3OH0.OHVFiRYMPNdplLsH4Wp1TO9oxkWiGJ4QDQiVSH3PUJE",ke=zg(Xg,Qg,{db:{schema:"public"}}),Hr=ho("lessonStore",{state:()=>({lessonName:"",availableUnits:[],availableLessons:[],loading:!1,error:null,lessonsLoading:!1,lessonsError:null,selectedUnits:[]}),getters:{isReady(t){return!t.loading&&!t.error}},actions:{async fetchPracticeUnits(){this.loading=!0,this.error=null;try{const{data:t,error:e}=await ke.auth.getSession();if(e)throw e;const s=t?.session?.user;if(!s)throw new Error("Not authenticated");const{data:n,error:r}=await ke.from("practice_units").select("practice_unit_id, name, type, unit_json, last_modified").eq("user_id",s.id).order("last_modified",{ascending:!1});if(r)throw r;this.availableUnits=(n||[]).map(i=>{let o=null;try{const c=i.unit_json||{};o=c?.practiceUnitHeader?.instrument||c?.instrument||null}catch{o=null}return{practice_unit_id:i.practice_unit_id,name:i.name,type:i.type,instrument:o,unit_json:i.unit_json,last_modified:i.last_modified}})}catch(t){console.warn("[lessonStore] fetchPracticeUnits failed; falling back to localStorage",t),this.error=t?.message?`[lessonStore] ${t.message}  falling back to localStorage`:"[lessonStore] Failed to fetch practice units from database; falling back to localStorage";try{const e=localStorage.getItem("mts.practiceUnits.export");if(e){const s=JSON.parse(e);this.availableUnits=(Array.isArray(s)?s:[]).map(n=>({practice_unit_id:n.practice_unit_id||n.id||crypto.randomUUID?.(),name:n.name||n.practice_name||"(untitled)",type:n.type||n.practice_unit_type||"Scale",instrument:n.instrument||n?.unit_json?.practiceUnitHeader?.instrument||null,unit_json:n.unit_json||n,last_modified:n.last_modified||new Date().toISOString()}))}else this.availableUnits=[]}catch(e){console.warn("[lessonStore] localStorage fallback failed",e),this.availableUnits=[],this.error=e?.message||t?.message||"Unable to load practice units"}}finally{this.loading=!1}},addUnit(t){if(!t)return;this.selectedUnits.some(s=>s.practice_unit_id===t.practice_unit_id)||this.selectedUnits.push(t)},removeUnit(t){this.selectedUnits=this.selectedUnits.filter(e=>e.practice_unit_id!==t)},moveUnit(t,e){if(t<0||e<0||t>=this.selectedUnits.length||e>=this.selectedUnits.length)return;const[s]=this.selectedUnits.splice(t,1);this.selectedUnits.splice(e,0,s)},clear(){this.lessonName="",this.selectedUnits=[]},async saveLesson(){if(!this.lessonName?.trim())throw new Error("Lesson name is required");if(this.selectedUnits.length===0)throw new Error("Add at least one Practice Unit");const{data:t,error:e}=await ke.auth.getSession();if(e)throw e;const s=t?.session?.user;if(!s)throw new Error("Not authenticated");const n={user_id:s.id,lesson_name:this.lessonName.trim()},{data:r,error:i}=await ke.from("lessons").insert(n).select("lesson_id").single();if(i)throw i;const o=r.lesson_id,c=this.selectedUnits.map((u,d)=>({lesson_id:o,practice_unit_id:u.practice_unit_id,sort_order:d})),{error:l}=await ke.from("lesson_units").insert(c);if(l)throw l;return{lessonId:o}},async fetchLessons(){this.lessonsLoading=!0,this.lessonsError=null;try{const{data:t,error:e}=await ke.auth.getSession();if(e)throw e;const s=t?.session?.user;if(!s)throw new Error("Not authenticated");const{data:n,error:r}=await ke.from("lessons").select("lesson_id, lesson_name, created_at, updated_at").eq("user_id",s.id).order("created_at",{ascending:!1});if(r)throw r;this.availableLessons=n||[]}catch(t){console.warn("[lessonStore] fetchLessons failed",t),this.availableLessons=[],this.lessonsError=t?.message||"Unable to load lessons"}finally{this.lessonsLoading=!1}},async updateLessonName(t,e){if(!t)throw new Error("lessonId required");try{const{data:s,error:n}=await ke.from("lessons").update({lesson_name:e}).eq("lesson_id",t);if(n)throw n;return await this.fetchLessons(),s}catch(s){throw console.warn("[lessonStore] updateLessonName failed",s),s}},async deleteLesson(t){if(!t)throw new Error("lessonId required");try{const{error:e}=await ke.from("lesson_units").delete().eq("lesson_id",t);if(e)throw e;const{error:s}=await ke.from("lessons").delete().eq("lesson_id",t);if(s)throw s;return await this.fetchLessons(),!0}catch(e){throw console.warn("[lessonStore] deleteLesson failed",e),e}},async fetchLessonUnits(t){if(!t)throw new Error("lessonId required");try{const{data:e,error:s}=await ke.from("lesson_units").select("practice_unit_id, sort_order").eq("lesson_id",t).order("sort_order",{ascending:!0});if(s)throw s;const n=(e||[]).map(c=>c.practice_unit_id).filter(Boolean);if(n.length===0)return[];const{data:r,error:i}=await ke.from("practice_units").select("practice_unit_id, name, type, unit_json").in("practice_unit_id",n);if(i)throw i;const o=(r||[]).reduce((c,l)=>(c[l.practice_unit_id]=l,c),{});return(e||[]).map(c=>({practice_unit_id:c.practice_unit_id,sort_order:c.sort_order,...o[c.practice_unit_id]}))}catch(e){throw console.warn("[lessonStore] fetchLessonUnits failed",e),e}},async updateLessonUnits(t,e){if(!t)throw new Error("lessonId required");if(!Array.isArray(e))throw new Error("orderedPracticeUnitIds must be an array");try{const{error:s}=await ke.from("lesson_units").delete().eq("lesson_id",t);if(s)throw s;const n=e.map((i,o)=>({lesson_id:t,practice_unit_id:i,sort_order:o}));if(n.length===0)return!0;const{error:r}=await ke.from("lesson_units").insert(n);if(r)throw r;return!0}catch(s){throw console.warn("[lessonStore] updateLessonUnits failed",s),s}}}}),ds=ho("practiceUnitScale",{state:()=>({practiceUnitHeader:{practiceName:"",practiceUnitId:"",lastModified:"",practiceUnitType:"Scale",tempo:120,keySignature:"C",timeSignature:"4/4",instrument:null,staffDisplayOptions:{showAccidentals:!0,showOverlays:!0,measuresPerLineMax:2},sourceURL:"",noteColorDesignation:{},User:"",shareMusic:!1,contentType:"Major",direction:"ascending",startingOctave:"C4",numberOfOctaves:1,rangeStart:null,rangeEnd:null,composer:"",sourceWork:"",techniqueFocus:[],tagSource:"",repetitionCount:null,sourceMusicXML:"",instrumentOverride:""},noteArray:[],title:"Create Scale",instruments:[],scaleSelections:null}),actions:{async loadInstruments(){try{const t=await fetch("/alpha-vue-SPA/data/instruments.json");if(!t.ok)throw new Error("Failed to load instruments.json");const e=await t.json();this.instruments=e}catch(t){console.error("Instrument fetch error:",t)}},setInstrument(t){this.practiceUnitHeader.instrument=t},setTitle(t){this.title=t},setNoteColorDesignation(t){const e=["red","blue","green","orange","gray","purple"],s={};try{if(t&&typeof t=="object")for(const n of e){const r=t[n];typeof r=="string"&&r.trim().length&&(s[n]=r.trim())}}catch{}this.practiceUnitHeader.noteColorDesignation=s},composePracticeUnit(){return{practiceUnitHeader:{...this.practiceUnitHeader},noteArray:[...this.noteArray]}},loadPracticeUnit(t){t.practiceUnitHeader&&(this.practiceUnitHeader={...this.practiceUnitHeader,...t.practiceUnitHeader}),Array.isArray(t.noteArray)&&(this.noteArray=t.noteArray.map(e=>({...e})))}}}),Zg={class:"bg-base-200 flex flex-col min-h-screen"},ev={class:"container mx-auto p-4 flex-1"},tv={class:"max-w-2xl mx-auto mb-4"},sv={class:"card bg-base-100 shadow-sm"},nv={class:"card-body"},rv={key:0,class:"alert alert-warning mb-2"},iv={class:"form-control mb-2"},ov={class:"textarea textarea-bordered w-full min-h-48 bg-base-200 overflow-y-auto p-0"},av={key:0,class:"p-4"},lv={key:1,class:"p-4 text-gray-500"},cv={key:2,class:"p-2 space-y-1"},uv={class:"flex items-center justify-between w-full p-2 rounded border",style:"background-color: white; border-color: #e5e7eb;"},dv={class:"flex items-center gap-2 flex-1"},fv={class:"badge badge-outline"},hv={class:"font-medium"},pv={key:0,class:"text-xs text-gray-500"},mv=["onClick","title"],gv={class:"max-w-2xl mx-auto mt-4"},vv={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mt-4 rounded-xl"},yv={class:"collapse-content px-4"},bv={class:"bg-base-100 p-4 rounded text-xs overflow-x-auto max-h-96"},_v={__name:"PracticeExercises",setup(t){const e=Hr(),s=ds(),n=z("");function r(u){const d=u?.instrument;return d?typeof d=="string"?d:typeof d=="object"&&(d.instrument||d.name)||"":""}const i=ie(()=>{const u=(n.value||"").toLowerCase().trim(),d=e.availableUnits||[];return u?d.filter(f=>{const h=(f.name||"").toLowerCase(),p=(f.type||"").toLowerCase(),g=r(f).toLowerCase();return h.includes(u)||p.includes(u)||g.includes(u)}):d}),o=ie(()=>{try{return s.composePracticeUnit()}catch{return{}}}),c=z(!1);function l(u){try{if(!u?.unit_json){alert("Invalid practice unit data.");return}s.loadPracticeUnit(u.unit_json),c.value=!0,alert(`Loaded: ${u.name}`)}catch(d){console.warn("[PracticeExercises] loadUnit exception",d),alert("Failed to load practice unit.")}}return Ye(()=>{e.fetchPracticeUnits().catch(u=>console.warn("Failed to load practice units",u))}),(u,d)=>(C(),T("div",Zg,[Q(pt),a("main",ev,[d[8]||(d[8]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatPracticePages"},[a("span",{class:"material-symbols-outlined"},"music_note"),a("span",{class:"text-2xl"},"Practice Exercises")],-1)),a("div",tv,[a("div",sv,[a("div",nv,[d[5]||(d[5]=a("h3",{class:"card-title"},"Your Saved Practice Units",-1)),d[6]||(d[6]=a("div",{class:"text-xs text-gray-500 mb-2"}," Filter and load a saved practice unit into Active Unit memory ",-1)),ne(e).error?(C(),T("div",rv,[a("span",null,D(ne(e).error),1),a("button",{class:"btn btn-xs ml-auto",onClick:d[0]||(d[0]=f=>ne(e).fetchPracticeUnits())}," Retry ")])):me("",!0),a("div",iv,[ae(a("input",{type:"text","onUpdate:modelValue":d[1]||(d[1]=f=>n.value=f),class:"input input-bordered w-full",placeholder:"Filter by name, type, instrument"},null,512),[[$e,n.value]])]),a("div",ov,[ne(e).loading?(C(),T("div",av,[...d[3]||(d[3]=[a("span",{class:"loading loading-spinner loading-md"},null,-1),a("span",{class:"ml-2"},"Loading practice units",-1)])])):i.value.length===0?(C(),T("div",lv," No Practice Units found. ")):(C(),T("ul",cv,[(C(!0),T(Re,null,st(i.value,f=>(C(),T("li",{key:f.practice_unit_id},[a("div",uv,[a("div",dv,[a("span",fv,D(f.type),1),a("span",hv,D(f.name),1),r(f)?(C(),T("span",pv," "+D(r(f)),1)):me("",!0)]),a("button",{class:"btn btn-sm btn-circle",onClick:h=>l(f),title:`Load '${f.name}' into Active Unit`},[...d[4]||(d[4]=[a("span",{class:"material-symbols-outlined text-base"},"download",-1)])],8,mv)])]))),128))]))])])])]),a("div",gv,[a("div",vv,[ae(a("input",{type:"checkbox",class:"peer","onUpdate:modelValue":d[2]||(d[2]=f=>c.value=f)},null,512),[[zt,c.value]]),d[7]||(d[7]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Behind the Curtain: practiceUnit.json")],-1)),a("div",yv,[a("pre",bv,D(JSON.stringify(o.value,null,2)),1)])])]),Q(Ac)]),Q(_t)]))}},Zt=ho("testStaffNote",{state:()=>({noteArray:[],selectedNote:null}),actions:{addNote(t){this.noteArray.push(t)},selectNote(t){this.selectedNote=t},clearNotes(){this.noteArray=[],this.selectedNote=null}}});let zs=null;async function wv(){if(zs)return zs;try{const t="/alpha-vue-SPA/staff-format.json",e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}`);return zs=await e.json(),zs}catch(t){return console.warn("[staffFormat] Using fallback defaults:",t),zs={staff:{x:10,y:40,width:560,height:200,clef:"treble",backgroundColor:"#f3f4f6",containerPadding:10,containerBorderRadius:12,containerShadow:"0 2px 8px 0 rgba(0,0,0,0.07)",verticalCenter:!1,enforceLedgerLimits:!1,ledgerLines:{above:3,below:3},noteSpacing:{mode:"default"}},noteColors:["black","blue","orange","green"]},zs}}function So({scaleStore:t,notesStore:e,name:s="Untitled Scale"}){const n=t?.scaleSelections||{},r=n?.staffOptions&&typeof n.staffOptions=="object"?n.staffOptions:{};return{practiceUnitHeader:{practiceName:s,practiceUnitId:"guid-placeholder",lastModified:new Date().toISOString(),practiceUnitType:"Scale",tempo:120,keySignature:n.key||"C",timeSignature:n.timeSignature||"4/4",instrument:t?.instrument||null,staffDisplayOptions:{...r,measuresPerLineMax:(()=>{const o=Number(n.maxMeasuresPerLine);return Number.isFinite(o)?Math.min(4,Math.max(1,o)):2})()},sourceURL:"",noteColorDesignation:(()=>{const o=t?.noteColorDesignation||{},c=["red","blue","green","orange","gray","purple"],l={};try{for(const u of c){const d=o[u];typeof d=="string"&&d.trim().length&&(l[u]=d.trim())}}catch{}return l})()},practiceUnitScale:{scaleType:n.scaleType||"major",scaleRange:{startingOctave:n.startingOctave||"C4",octaveCount:n.octaveCount||1},direction:n.direction||"Ascending"},noteArray:Array.isArray(e?.noteArray)?e.noteArray:[]}}const Gn={__name:"StaffPreview",props:{practiceOverlayMode:{type:String,default:"none"},practiceOverlayTooltipOnly:{type:Boolean,default:!1},practiceEnableClickToCycle:{type:Boolean,default:!1},practiceColorCycle:{type:Array,default:()=>["black","blue","orange","green","purple","red","brown","gray"]}},setup(t){const e=t,s=z(null),n=Zt(),r=ds(),i=$t({staff:{x:10,y:30,width:560,height:160,clef:"treble",backgroundColor:"#ffffff",containerPadding:16,containerBorderRadius:12,containerShadow:"0 0 0 0 rgba(0,0,0,0)",verticalCenter:!1,ledgerLines:{above:3,below:3}}}),o=ie(()=>({backgroundColor:i.staff.backgroundColor||"#ffffff",padding:(i.staff.containerPadding??16)+"px",borderRadius:(i.staff.containerBorderRadius??12)+"px",boxShadow:i.staff.containerShadow||"none"})),c=ie(()=>i.staff.height??160);function l(_){try{const U=String(_||"C").trim(),B=U.match(/^([A-Ga-g])([#b]?)(?:\s*(major|minor))?$/);if(B){const G=B[1].toUpperCase();let K=B[2]||"";K===""&&(K="b"),K===""&&(K="#");const J=(B[3]||"").toLowerCase();return G+K+(J==="minor"?"m":"")}if(/^[A-G][#b]?m?$/i.test(U))return U}catch{}return"C"}function u(){const _=r?.scaleSelections?.key||"C";return l(_)}function d(_,U=!0){const B=r?.scaleSelections?.staffOptions||{};return typeof B[_]=="boolean"?B[_]:U}function f(_){const U=_.match(/^([A-G])([#b]?)\d$/);return U&&U[2]||null}function h(_){try{if(typeof globalThis<"u"&&globalThis&&typeof globalThis.spnToMidi=="function"){const J=_.includes("/")?_:_.replace(/([A-G][#b]?)(\d)/,"$1/$2");return globalThis.spnToMidi(J)}}catch{}const U=String(_).match(/^([A-G])([#b]?)(\d)$/);if(!U)return Number.NaN;const B={C:0,D:2,E:4,F:5,G:7,A:9,B:11}[U[1]]??0;let G=0;return U[2]==="#"?G=1:U[2]==="b"&&(G=-1),12*(Number(U[3])+1)+B+G}function p(_){return String(_).replace(/([A-G][#b]?(?=\d))(\d)/,"$1/$2")}function g(_){return{"C#":"Db",Db:"C#","D#":"Eb",Eb:"D#","F#":"Gb",Gb:"F#","G#":"Ab",Ab:"G#","A#":"Bb",Bb:"A#"}[_]||null}function v(_){try{const U=r?.instrument,B=U&&U.fingering?U.fingering:null;if(!B)return[];const G=String(_||""),K=p(G),J=G,ce=G.match(/^([A-G][#b]?)/),ge=ce?ce[1]:null,Se=ge?g(ge):null,Ae=Se?K.replace(/^([A-G][#b]?)/,Se):null,fe=Se?J.replace(/^([A-G][#b]?)/,Se):null;if(Array.isArray(B[J]))return B[J];if(Array.isArray(B[K]))return B[K];if(fe&&Array.isArray(B[fe]))return B[fe];if(Ae&&Array.isArray(B[Ae]))return B[Ae]}catch{}return[]}function k(_,U){const B=_.match(/^([A-G])[#b]?(\d)$/);if(!B)return 0;const G=B[1],K=Number(B[2]),J={C:0,D:1,E:2,F:3,G:4,A:5,B:6},ce=J[G];if(ce==null)return 0;let ge,Se;return U==="bass"?(ge=J.G,Se=2):(ge=J.E,Se=4),(K-Se)*7+(ce-ge)}function P(_){return _<=9?0:Math.ceil((_-9)/2)}function R(_){return _>=-1?0:Math.ceil(-(_+1)/2)}function S(_,U,B){const G=k(_,U),K=P(G),J=R(G),ce=Number(B?.above??3),ge=Number(B?.below??3);return K<=ce&&J<=ge}async function x(){if(!s.value)return;s.value.innerHTML="";const _=globalThis.Vex?globalThis.Vex.Flow:null;if(!_){console.error("[VexFlow] Not available on globalThis");return}const U=i.staff.width??560;let B=i.staff.height??160;const G=new _.Renderer(s.value,_.Renderer.Backends.SVG);G.resize(U,B);const K=G.getContext(),J=i.staff.verticalCenter?Math.max(0,Math.floor(B/2-40)):i.staff.y??30,ce=i.staff.x??10,ge=r?.instrument?.clef||i.staff.clef||"treble";let Se="4/4";try{const oe=So({scaleStore:r,notesStore:n})?.practiceUnitHeader||{};Se=oe.timeSignature||(typeof oe.keySignature=="string"&&/^\d+\/\d+$/.test(oe.keySignature)?oe.keySignature:"4/4")}catch{}const[Ae,fe]=(Se||"4/4").split("/"),re=Number(Ae)||4,we=Number(fe)||4,Ee=re*(4/we);function _e(Y){const oe=String(Y||"").match(/^([whqes])(r)?(\.)?$/);return oe?{base:oe[1],isRest:!!oe[2],dotted:!!oe[3]}:{base:"q",isRest:!1,dotted:!1}}function Te(Y){const{base:oe,dotted:Ce}=_e(Y);let Ke=1;switch(oe){case"w":Ke=4;break;case"h":Ke=2;break;case"q":Ke=1;break;case"e":Ke=.5;break;case"s":Ke=.25;break}return Ce?Ke*1.5:Ke}const Ue=d("barLines",!0),Z=Array.isArray(n.noteArray)?n.noteArray:[];if(!Z.length)return;const N=i.staff.ledgerLines||{above:3,below:3},A=r?.scaleSelections?.staffOptions?.enforceLedgerLimits,m=typeof A=="boolean"?A:!!(i.staff?.enforceLedgerLimits??!1),$=Z.map((Y,oe)=>({n:Y,i:oe})).filter(Y=>Y.n?.pitch&&Y.n?.duration),q=$.filter(Y=>S(Y.n.pitch,ge,N)),te=m?q:$;m&&!q.length&&console.warn("[StaffPreview] All notes outside ledger limits; strict enforcement active.",{limits:N,clef:ge,total:Z.length});const le=String(e.practiceOverlayMode||"none"),b=!e.practiceOverlayTooltipOnly;function w(Y){try{if(le==="names"){const oe=String(Y.pitch||"").match(/^([A-G][#b]?)/);return oe?oe[1]:String(Y.pitch||"")}else{if(le==="pitch")return String(Y.pitch||"");if(le==="midi"){if(Y.midi!=null&&Y.midi!=="")return String(Y.midi);const oe=h(String(Y.pitch||""));return Number.isFinite(oe)?String(oe):""}else if(le==="cmt"){if(Y.cmt)return String(Y.cmt);const oe=String(Y.duration||"q");return String(Y.pitch||"")+oe}else if(le==="fingering"||le==="fingering-alt"){if(le==="fingering-alt"&&Array.isArray(Y.fingeringAlt))return Y.fingeringAlt.join("/");if(Array.isArray(Y.fingering))return Y.fingering[0]??"";if(typeof Y.fingering=="string")return Y.fingering;const oe=v(Y.pitch);return le==="fingering-alt"&&oe.length?oe.join("/"):oe[0]??""}}}catch{}return""}if(le&&le!=="none")for(const{n:Y,i:oe}of $){const Ce=w(Y);if((Y.overlay||"")!==Ce){try{Array.isArray(r.noteArray)&&r.noteArray[oe]&&(r.noteArray[oe]={...r.noteArray[oe],overlay:Ce})}catch{}try{Y.overlay=Ce}catch{}}}else for(const{n:Y,i:oe}of $)if(Y.overlay){try{Array.isArray(r.noteArray)&&r.noteArray[oe]&&(r.noteArray[oe]={...r.noteArray[oe],overlay:""})}catch{}try{Y.overlay=""}catch{}}function O(Y){const oe=_e(Y.duration),{base:Ce,dotted:Ke,isRest:Je}=oe,jt=Je?"B/4":Y.pitch.replace(/([A-G][#b]?)\/(\d)/,"$1/$2").replace(/([A-G][#b]??)(\d)/,"$1/$2");let mt;switch(Ce){case"e":mt="8";break;case"s":mt="16";break;default:mt=Ce}Je&&(mt=`${mt}r`);const Le=new _.StaveNote({keys:[jt],duration:mt,clef:ge});if(Ke)try{typeof Le.addDotToAll=="function"?Le.addDotToAll():_?.Dot&&typeof _.Dot.buildAndAttach=="function"?_.Dot.buildAndAttach([Le],{all:!0}):typeof Le.addDot=="function"&&Le.addDot(0)}catch{}if(Le.__mtsDur=Y.duration,!Je&&d("accidentals",!0)){const Os=f(Y.pitch);Os&&Le.addModifier(0,new _.Accidental(Os))}return Y.noteColor&&Le.setStyle({fillStyle:Y.noteColor,strokeStyle:Y.noteColor}),Y.overlay&&b&&Le.addAnnotation(0,new _.Annotation(Y.overlay).setVerticalJustification(_.Annotation.VerticalJustify.TOP)),Le}function M(Y,oe,Ce){if(!oe.length)return;const Ke=i.staff.noteSpacing||{mode:"proportional",justify:!0},Je=new _.Voice({time:{num:re,beat_value:we}});Je.setMode(_.Voice.Mode.SOFT),Je.addTickables(oe);const jt=new _.Formatter;jt.joinVoices([Je]);const mt=Ke.mode||"default";if(mt==="default"||mt==="auto")jt.formatToStave([Je],Y);else if(mt==="fixedPerNote"){for(const Dt of oe)Dt&&typeof Dt.setIgnoreTicks=="function"&&Dt.setIgnoreTicks(!0);const Le=typeof Y.getNoteStartX=="function"?Y.getNoteStartX():Y.getX()+24,Os=typeof Y.getWidth=="function"?Y.getX()+Y.getWidth()-12:Le+Math.max(0,Ce-12),It=Math.max(10,Os-Le);let xt=Number(i.staff?.noteSpacing?.pixelsPerNote??50);(!Number.isFinite(xt)||xt<=0)&&(xt=50),xt*(oe.length-1)>It&&(xt=It/Math.max(1,oe.length-1)),jt.format([Je],Ce);let Nt=0;for(const Dt of oe){const hn=Le+Nt*xt;typeof Dt.setX=="function"&&Dt.setX(hn),Nt++}}else if(mt==="fixedPerBeat"){let hn=function(Qe){const{base:Gt,dotted:pn}=_e(Qe);let St=Le;switch(Gt){case"w":St=Le*4;break;case"h":St=Le*2;break;case"q":St=Le;break;case"e":St=Le/2;break;case"s":St=Le/4;break}return pn?St*3/2:St};for(const Qe of oe)Qe&&typeof Qe.setIgnoreTicks=="function"&&Qe.setIgnoreTicks(!0);const Le=_.Flow.RESOLUTION,Os=Le*4/we;let It=re;we===8&&re%3===0&&re>=6&&(It=Math.floor(re/3));const xt=typeof Y.getNoteStartX=="function"?Y.getNoteStartX():Y.getX()+24,Kn=typeof Y.getWidth=="function"?Y.getX()+Y.getWidth()-12:xt+Math.max(0,Ce-12),Dt=Math.max(10,Kn-xt)/Math.max(1,It),Co=Array.from({length:It},()=>[]);let Oo=0;const ku=we===8&&re%3===0&&re>=6?Le*3/2:Os;for(const Qe of oe){const Gt=Qe.__mtsDur||(typeof Qe.getDuration=="function"?Qe.getDuration():"q"),pn=hn(Gt),St=Math.min(It-1,Math.floor(Oo/ku));Co[St].push(Qe),Oo+=pn}const To=new Map;for(let Qe=0;Qe<It;Qe++){const Gt=Co[Qe],pn=Gt.length+1;for(let St=0;St<Gt.length;St++){const Au=xt+Qe*Dt+(St+1)*(Dt/pn);To.set(Gt[St],Au)}}jt.format([Je],Ce);for(const Qe of oe){const Gt=To.get(Qe);typeof Qe.setX=="function"&&typeof Gt=="number"&&Qe.setX(Gt)}}else mt==="proportional"&&Ke.justify?jt.formatToStave([Je],Y):mt==="proportional"?jt.formatToStave([Je],Y):jt.format([Je],Ce);Je.draw(K,Y)}const V=[],H=new Map;if(le&&le!=="none")for(const{n:Y,i:oe}of $){const Ce=e.practiceOverlayTooltipOnly?w(Y):(Y.overlay||"").trim();Ce&&H.set(oe,String(Ce))}if(!Ue){const Y=new _.Stave(ce,J,U-ce*2);if(Y.addClef(ge),d("keySignature",!0))try{Y.addKeySignature(u())}catch(Ce){console.warn("[VexFlow] Invalid key signature:",u(),Ce)}if(d("timeSignature",!0))try{Y.addTimeSignature(Se)}catch{}Y.setContext(K).draw();const oe=te.map(({n:Ce,i:Ke})=>(V.push(Ke),O(Ce)));M(Y,oe,U-ce*2),j(V,H);return}const se=[],ee=[];let E=[],y=[],L=0;for(const Y of te){const oe=Y?.n;if(!oe?.pitch||!oe?.duration)continue;const Ce=Te(oe.duration);L+Ce-Ee>1e-6&&E.length&&(se.push(E),ee.push(y),E=[],y=[],L=0),E.push(O(oe)),y.push(Y.i),L+=Ce,Math.abs(L-Ee)<1e-6&&(se.push(E),ee.push(y),E=[],y=[],L=0)}E.length&&(se.push(E),ee.push(y));const F=U-ce*2,W=Math.max(1,se.length),ue=r?.scaleSelections?.maxMeasuresPerLine??2,he=Math.min(4,Math.max(1,Number(ue)));let be=0;try{const Y=new _.Stave(0,0,120);if(Y.addClef(ge),d("keySignature",!0))try{Y.addKeySignature(u())}catch{}if(d("timeSignature",!0))try{Y.addTimeSignature(Se)}catch{}be=typeof Y.getNoteStartX=="function"?Y.getNoteStartX()-Y.getX():0}catch{}const Oe=Math.ceil(W/he),nt=Math.max(120,i.staff.height??160),rt=16,kt=Oe*nt+(Oe-1)*rt+(i.staff.y??30);kt>B&&(B=kt,G.resize(U,B));let wt=ce,fs=J;for(let Y=0;Y<W;Y++){const oe=Y%he===0,Ce=Y%he===he-1||Y===W-1;oe&&Y!==0&&(wt=ce,fs+=nt+rt);const Ke=Math.min(he,W-Math.floor(Y/he)*he),Je=Math.max(60,Math.floor((F-be)/Ke)),jt=be+Je*Ke,mt=F-jt,Le=oe;let It=Je+(Ce?Math.max(0,mt):0);const xt=Le?It+be:It,Kn=se[Y],Nt=new _.Stave(wt,fs,xt);if(Le){if(Nt.addClef(ge),d("keySignature",!0))try{Nt.addKeySignature(u())}catch{}if(d("timeSignature",!0))try{Nt.addTimeSignature(Se)}catch{}}else Nt.setBegBarType(_.Barline.type.SINGLE),Nt.setEndBarType(_.Barline.type.SINGLE);Nt.setContext(K).draw(),M(Nt,Kn,xt);const Dt=ee[Y]||[];for(const hn of Dt)V.push(hn);wt+=xt}j(V,H)}Ye(()=>{wv().then(_=>{_&&_.staff&&Object.assign(i.staff,_.staff)}).finally(()=>{x()})}),qe(()=>[n.noteArray,r?.scaleSelections?.key,r?.scaleSelections?.staffOptions,r?.scaleSelections?.timeSignature,r?.scaleSelections?.maxMeasuresPerLine,r?.instrument?.clef,r?.instrument,i.staff.width,i.staff.height,e.practiceOverlayMode,e.practiceOverlayTooltipOnly,e.practiceEnableClickToCycle,e.practiceColorCycle],()=>{x()},{deep:!0});function j(_,U){try{const B=s.value.querySelectorAll("g.vf-stavenote"),G=Math.min(B.length,_.length);for(let K=0;K<G;K++){const J=B[K],ce=_[K];J&&(e.practiceOverlayTooltipOnly&&U?.has(ce)&&J.setAttribute("title",U.get(ce)),e.practiceEnableClickToCycle&&(J.style.cursor="pointer",J.addEventListener("click",()=>I(ce))))}}catch(B){console.warn("[StaffPreview] attachNoteInteractivity failed",B)}}function I(_){try{if(!Array.isArray(n.noteArray)||!n.noteArray[_])return;const U=n.noteArray[_],B=Array.isArray(e.practiceColorCycle)?e.practiceColorCycle.filter(Se=>typeof Se=="string"&&Se):[];if(!B.length)return;const G=(U.noteColor||"").toLowerCase(),K=B.map(Se=>String(Se).toLowerCase());let J=0;const ce=K.indexOf(G);ce>=0&&(J=(ce+1)%K.length);const ge=B[J];n.noteArray[_]={...U,noteColor:ge};try{Array.isArray(r.noteArray)&&r.noteArray[_]&&(r.noteArray[_]={...r.noteArray[_],noteColor:ge})}catch{}}catch(U){console.warn("[StaffPreview] onNoteClick failed",U)}}return(_,U)=>(C(),T("div",{class:"border border-gray-300",style:as(o.value)},[a("div",{ref_key:"vfContainer",ref:s,class:"w-full",style:as({minHeight:c.value+"px"})},null,4)],4))}},xv={class:"bg-base-200 flex flex-col min-h-screen"},Sv={class:"container mx-auto p-4 flex-1"},kv={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Av={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},Ev={class:"text-right text-base font-normal text-gray-600"},Cv={class:"collapse-content px-4"},Ov={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Tv={class:"collapse-content px-4"},$v={class:"flex flex-wrap gap-4 mb-4"},Pv=["title"],Rv=["title"],Uv=["placeholder","onUpdate:modelValue"],jv={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Iv={class:"collapse-content px-4"},Nv={class:"space-y-3 text-sm"},Dv={class:"flex items-center gap-2"},Lv={class:"grid grid-cols-1 md:grid-cols-2 gap-2"},Fv={class:"flex items-center gap-2"},Mv={class:"flex items-center gap-2"},Bv={class:"flex items-center gap-2"},Vv={class:"flex items-center gap-2"},Hv={class:"flex items-center gap-2"},qv={class:"flex items-center gap-2"},Gv={class:"flex items-center gap-2"},Kv={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Wv={class:"collapse-content px-4 text-sm leading-7"},Jv={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mt-4 rounded-xl"},zv={class:"collapse-content px-4"},Yv={class:"bg-base-100 p-4 rounded text-xs overflow-x-auto max-h-96"},el="practiceScales.overlay",Xv={__name:"PracticeScales",setup(t){const e=ds(),s=Zt();Ye(async()=>{await e.loadInstruments(),Array.isArray(e.noteArray)||(e.noteArray=[]),(!Array.isArray(s.noteArray)||s.noteArray.length===0)&&(Array.isArray(e.noteArray)&&e.noteArray.length>0?s.noteArray=e.noteArray.map(I=>({...I})):s.noteArray=[]);try{if(!e.instrument&&Array.isArray(e.instruments)&&e.instruments.length){const I=document.cookie.split(";").map(B=>B.trim()),_="instrument=";let U="";for(const B of I)if(B.startsWith(_)){U=decodeURIComponent(B.slice(_.length));break}if(U){let B=e.instruments.find(G=>G.instrument===U);if(!B){const G=U.toLowerCase();B=e.instruments.find(K=>typeof K.instrument=="string"&&(K.instrument.toLowerCase()===G||K.instrument.toLowerCase().startsWith(G)||K.instrument.toLowerCase().includes(G)))}B&&(e.instrument=B)}if(!e.instrument){const B=e.instruments.filter(G=>G&&G.fingering&&Object.keys(G.fingering).length>0);B.length===1&&(e.instrument=B[0])}}}catch{}});function n(I){try{const _=String(I).toLowerCase();if(["black","blue","green","purple","red","brown"].includes(_))return"#ffffff";if(["orange","gray","grey","yellow","white"].includes(_))return"#000000"}catch{}return"#000000"}const i=$t([{name:"Black",color:"black"},{name:"Blue",color:"blue"},{name:"Orange",color:"orange"},{name:"Green",color:"green"},{name:"Purple",color:"purple"},{name:"Red",color:"red"},{name:"Brown",color:"brown"},{name:"Gray",color:"gray"}].map(I=>({...I,meaning:""})));function o(){try{const I=localStorage.getItem("noteColorMeanings");if(!I)return;const _=JSON.parse(I)||{};for(const U of i)typeof _[U.color]=="string"&&(U.meaning=_[U.color])}catch{}}function c(){const I={};for(const _ of i)I[_.color]=_.meaning||"";try{localStorage.setItem("noteColorMeanings",JSON.stringify(I))}catch{}}function l(){for(const I of i)I.meaning="";c()}function u(){l(),d();try{Array.isArray(s.noteArray)&&(s.noteArray=s.noteArray.map(I=>({...I,noteColor:"black"})))}catch{}try{Array.isArray(e.noteArray)&&(e.noteArray=e.noteArray.map(I=>({...I,noteColor:"black"})))}catch{}}o(),qe(()=>i.map(I=>I.meaning),()=>c(),{deep:!0});function d(){const I=new Set(["red","blue","green","orange","gray","purple"]),_={};for(const U of i){const B=String(U.color||"").toLowerCase();if(I.has(B)){const G=typeof U.meaning=="string"?U.meaning.trim():"";G&&(_[B]=G)}}e.setNoteColorDesignation(_)}d(),qe(()=>i.map(I=>({color:I.color,meaning:I.meaning})),()=>d(),{deep:!0}),qe(()=>e.noteArray,I=>{if(!Array.isArray(I)){e.noteArray=[];return}(!Array.isArray(s.noteArray)||s.noteArray.length===0)&&(s.noteArray=I.map(_=>({..._})))},{deep:!0,immediate:!0});const f=z(!1),h=z("none");function p(){try{const I=localStorage.getItem(el);if(!I)return;const _=JSON.parse(I)||{};typeof _.tooltipOnly=="boolean"&&(f.value=_.tooltipOnly),typeof _.displayOption=="string"&&(h.value=_.displayOption)}catch{}}function g(){const I={tooltipOnly:f.value,displayOption:h.value};try{localStorage.setItem(el,JSON.stringify(I))}catch{}}p(),qe([f,h],g);const v=ie(()=>{const I=e.instrument;return I&&I.instrument||"Unknown"}),k=I=>typeof I=="string"&&I.length?I[0].toUpperCase()+I.slice(1):I,P=ie(()=>{const I=e.scaleSelections||{};return`${I.key||"C"} ${k(I.scaleType||"major")} Scale`}),R=ie(()=>{const I=e.scaleSelections||{},_=Number(I.octaveCount)||1;return`${_} ${_===1?"octave":"octaves"} starting at ${I.startingOctave||"C4"}`}),S=ie(()=>{const I=e.scaleSelections||{},_=I.direction||"Ascending",B={whole:"Whole",half:"Half",quarter:"Quarter",eighth:"Eighth"}[I.noteDuration]||k(I.noteDuration||"Quarter");return`${_} ${B} Note Scale`}),x=ie(()=>{const I=e.scaleSelections&&e.scaleSelections.staffOptions||{},_=[];I.keySignature&&_.push("Key Signature"),I.barLines&&_.push("Bar Lines"),I.timeSignature&&_.push("Time Signature"),I.accidentals&&_.push("Accidentals");let U="";switch(I.accidentalFamily){case"auto-key":U="Auto: Based on Key";break;case"auto-direction":U="Auto: Based on Asc/Desc";break;case"force-sharps":U="Force: Sharps";break;case"force-flats":U="Force: Flats";break}return _.join(", ")+(U?`, ${U}`:"")}),j=ie(()=>So({scaleStore:e,notesStore:s,name:"Practice Scale"}));return(I,_)=>(C(),T("div",xv,[Q(pt),a("main",Sv,[_[33]||(_[33]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatPracticePages"},[a("span",{class:"material-symbols-outlined"},"music_note"),a("span",{class:"text-2xl"},"Practice")],-1)),a("div",kv,[_[9]||(_[9]=a("input",{type:"checkbox",class:"peer",checked:""},null,-1)),a("div",Av,[_[8]||(_[8]=a("span",null,"Preview",-1)),a("span",Ev,D(ne(e).noteArray&&ne(e).noteArray.length>0?ne(e).noteArray.map(U=>U.pitch).join(", "):"No scale generated yet."),1)]),a("div",Cv,[Q(Gn,{"practice-overlay-mode":h.value,"practice-overlay-tooltip-only":f.value,"practice-enable-click-to-cycle":!0,"practice-color-cycle":i.map(U=>U.color)},null,8,["practice-overlay-mode","practice-overlay-tooltip-only","practice-color-cycle"])])]),a("div",Ov,[_[12]||(_[12]=a("input",{type:"checkbox",class:"peer"},null,-1)),_[13]||(_[13]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Note Colors")],-1)),a("div",Tv,[_[11]||(_[11]=a("div",{class:"mb-3 text-gray-700 text-sm"},` Each color below is used to highlight notes in the scale. You can type a personal meaning for each color (e.g. "too high for me to reach", "can't remember fingering"). `,-1)),a("div",$v,[(C(!0),T(Re,null,st(i,(U,B)=>(C(),T("div",{key:U.color,class:"flex items-center gap-3 border rounded p-2 bg-white"},[a("div",{class:"w-8 h-8 rounded border",style:as({backgroundColor:U.color}),title:U.color},null,12,Pv),a("span",{class:"badge border",style:as({backgroundColor:U.color,color:n(U.color)}),title:U.color},D(U.name),13,Rv),ae(a("input",{class:"input input-sm input-bordered w-64",type:"text",placeholder:`Meaning for ${U.name}`,"onUpdate:modelValue":G=>U.meaning=G},null,8,Uv),[[$e,U.meaning]])]))),128))]),a("button",{class:"btn btn-outline btn-error btn-sm flex items-center gap-2",onClick:u},[..._[10]||(_[10]=[a("span",{class:"material-symbols-outlined"},"restart_alt",-1),X(" Reset Colors ",-1)])])])]),a("div",jv,[_[22]||(_[22]=a("input",{type:"checkbox",class:"peer"},null,-1)),_[23]||(_[23]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Practice Overlays")],-1)),a("div",Iv,[a("div",Nv,[a("label",Dv,[ae(a("input",{type:"checkbox","onUpdate:modelValue":_[0]||(_[0]=U=>f.value=U)},null,512),[[zt,f.value]]),_[14]||(_[14]=X(" Show overlays as note tooltip ONLY ",-1))]),a("div",Lv,[a("label",Fv,[ae(a("input",{type:"radio",name:"display-option",value:"none","onUpdate:modelValue":_[1]||(_[1]=U=>h.value=U)},null,512),[[Be,h.value]]),_[15]||(_[15]=X(" Notes ONLY ",-1))]),a("label",Mv,[ae(a("input",{type:"radio",name:"display-option",value:"names","onUpdate:modelValue":_[2]||(_[2]=U=>h.value=U)},null,512),[[Be,h.value]]),_[16]||(_[16]=X(" Note Names ",-1))]),a("label",Bv,[ae(a("input",{type:"radio",name:"display-option",value:"pitch","onUpdate:modelValue":_[3]||(_[3]=U=>h.value=U)},null,512),[[Be,h.value]]),_[17]||(_[17]=X(" Scientific Pitch Notation (SPN) ",-1))]),a("label",Vv,[ae(a("input",{type:"radio",name:"display-option",value:"cmt","onUpdate:modelValue":_[4]||(_[4]=U=>h.value=U)},null,512),[[Be,h.value]]),_[18]||(_[18]=X(" Compact Music Token (CMT) ",-1))]),a("label",Hv,[ae(a("input",{type:"radio",name:"display-option",value:"midi","onUpdate:modelValue":_[5]||(_[5]=U=>h.value=U)},null,512),[[Be,h.value]]),_[19]||(_[19]=X(" MIDI Note Number ",-1))]),a("label",qv,[ae(a("input",{type:"radio",name:"display-option",value:"fingering","onUpdate:modelValue":_[6]||(_[6]=U=>h.value=U)},null,512),[[Be,h.value]]),_[20]||(_[20]=X(" Standard Fingering ",-1))]),a("label",Gv,[ae(a("input",{type:"radio",name:"display-option",value:"fingering-alt","onUpdate:modelValue":_[7]||(_[7]=U=>h.value=U)},null,512),[[Be,h.value]]),_[21]||(_[21]=X(" Fingering with alternates ",-1))])])])])]),a("div",Kv,[_[29]||(_[29]=a("input",{type:"checkbox",class:"peer"},null,-1)),_[30]||(_[30]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Details")],-1)),a("div",Wv,[a("div",null,[_[24]||(_[24]=a("strong",null,"Instrument:",-1)),X(" "+D(v.value),1)]),a("div",null,[_[25]||(_[25]=a("strong",null,"Scale Selector:",-1)),X(" "+D(P.value),1)]),a("div",null,[_[26]||(_[26]=a("strong",null,"Scale Range:",-1)),X(" "+D(R.value),1)]),a("div",null,[_[27]||(_[27]=a("strong",null,"Duration & Direction:",-1)),X(" "+D(S.value),1)]),a("div",null,[_[28]||(_[28]=a("strong",null,"Staff Formatting:",-1)),X(" "+D(x.value),1)])])]),a("div",Jv,[_[31]||(_[31]=a("input",{type:"checkbox",class:"peer"},null,-1)),_[32]||(_[32]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Behind the Curtain: practiceUnit.json")],-1)),a("div",zv,[a("pre",Yv,D(JSON.stringify(j.value,null,2)),1)])]),Q(Ac)]),Q(_t)]))}},Qv={class:"alert shadow-sm bg-base-100 border border-base-300 flex items-center justify-between"},Zv={class:"flex items-center gap-2"},ey={key:0},ty={key:1},sy={class:"text-sm text-gray-600"},ny={key:2},ry={class:"flex items-center gap-2"},ko={__name:"AuthStatusBanner",props:{onRetry:{type:Function,default:null}},setup(t){const e=ap(),s=z(null),n=z(!0);let r=null;async function i(){n.value=!0;try{const{data:l}=await ke.auth.getSession();s.value=l?.session?.user||null}finally{n.value=!1}}function o(){e.push({name:"preferences"})}async function c(){await ke.auth.signOut(),await i()}return Ye(async()=>{await i();const{data:l}=ke.auth.onAuthStateChange(()=>i());r=l?.subscription}),ro(()=>{try{r?.unsubscribe?.()}catch{}}),(l,u)=>(C(),T("div",Qv,[a("div",Zv,[u[3]||(u[3]=a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"account_circle",-1)),n.value?(C(),T("div",ey,"Checking sign-in")):s.value?(C(),T("div",ty,[u[1]||(u[1]=a("span",{class:"font-medium"},"Signed in: ",-1)),a("span",sy,D(s.value.email),1)])):(C(),T("div",ny,[...u[2]||(u[2]=[a("span",{class:"font-medium"},"You're not signed in",-1)])]))]),a("div",ry,[s.value?(C(),T("button",{key:0,class:"btn btn-xs",onClick:c},"Sign out")):(C(),T("button",{key:1,class:"btn btn-xs",onClick:o},"Sign in")),t.onRetry?(C(),T("button",{key:2,class:"btn btn-xs btn-outline",onClick:u[0]||(u[0]=(...d)=>t.onRetry&&t.onRetry(...d))}," Retry ")):me("",!0)])]))}},iy={class:"bg-base-200 flex flex-col min-h-screen"},oy={class:"container mx-auto p-4 flex-1"},ay={class:"max-w-3xl mx-auto"},ly={class:"mt-6"},cy={class:"collapse-content"},uy={class:"mb-4"},dy={class:"inline-flex items-center mr-4"},fy={class:"mb-4 border p-3 rounded bg-base-100"},hy={class:"form-control mt-2"},py={class:"form-control mt-2"},my={class:"form-control mt-2"},gy={class:"mt-3 flex gap-2"},vy=["disabled"],yy={key:0,class:"text-sm text-gray-500"},by={key:1},_y={key:0,class:"text-sm text-gray-500"},wy={class:"space-y-3"},xy={class:"flex justify-between items-start"},Sy={class:"font-semibold"},ky={class:"text-sm text-gray-600"},Ay={class:"text-xs text-gray-500"},Ey={class:"flex items-center gap-2"},Cy=["onClick"],Oy=["onClick"],Ty=["onClick"],$y={key:0,class:"mt-2 text-sm"},Py={key:1,class:"mt-2"},Ry={class:"flex gap-2"},Uy=["onClick"],jy={style:{"max-width":"400px",margin:"2em auto"}},Iy={__name:"PracticeNotes",setup(t){const e=z([]),s=z(!1),n=z(!1),r=z(!0),i=z(!0),o=z({title:"",detail:"",practice_unit:"N/A"}),c=z(null),l=z({title:"",detail:"",practice_unit:"N/A"});function u(S){if(!S)return"";try{return new Date(S).toLocaleString()}catch{return S}}async function d(){s.value=!0;try{const{data:S}=await ke.auth.getSession(),x=S?.session?.user||null;if(!x){e.value=[];return}let j=ke.from("mts-notes").select("*").order("created_at",{ascending:!1});r.value?j=j.eq("user_id",x.id).eq("status","open"):j=j.eq("user_id",x.id);const{data:I,error:_}=await j;_?(console.error("Error fetching notes:",_),e.value=[]):e.value=I||[]}catch(S){console.error(S),e.value=[]}finally{s.value=!1}}async function f(){if(!(!o.value.title&&!o.value.detail)){n.value=!0;try{const{data:S}=await ke.auth.getSession(),x=S?.session?.user||null;if(!x)return alert("Please sign in to save notes.");const j={title:o.value.title,detail:o.value.detail,practice_unit:o.value.practice_unit||"N/A",user_id:x.id,status:"open"},{error:I}=await ke.from("mts-notes").insert(j);I?(console.error("Insert error:",I),alert("Failed to save note.")):(h(),await d())}finally{n.value=!1}}}function h(){o.value={title:"",detail:"",practice_unit:"N/A"}}function p(S){c.value=S.id,l.value={title:S.title,detail:S.detail,practice_unit:S.practice_unit}}function g(){c.value=null,l.value={title:"",detail:"",practice_unit:"N/A"}}async function v(S){try{const x={title:l.value.title,detail:l.value.detail,practice_unit:l.value.practice_unit,updated_at:new Date().toISOString()},{error:j}=await ke.from("mts-notes").update(x).eq("id",S.id);j?(console.error("Update error:",j),alert("Failed to update note.")):(c.value=null,await d())}catch(x){console.error(x)}}async function k(S){if(!confirm("Delete this note?"))return;const{error:x}=await ke.from("mts-notes").delete().eq("id",S.id);x?(console.error(x),alert("Failed to delete note.")):await d()}async function P(S){const x=S.status==="open"?"closed":"open",{error:j}=await ke.from("mts-notes").update({status:x,updated_at:new Date().toISOString()}).eq("id",S.id);j?(console.error(j),alert("Failed to update status.")):await d()}const R=ie(()=>r.value?e.value.filter(S=>S.status==="open"):e.value);return Ye(async()=>{await d()}),(S,x)=>(C(),T("div",iy,[Q(pt),a("main",oy,[x[15]||(x[15]=a("div",{class:"flex items-center gap-2 mb-4 px-4 py-2 rounded mtsFormatPracticePages"},[a("span",{class:"material-symbols-outlined"},"note_alt"),a("span",{class:"text-2xl font-bold"},"Practice Notes")],-1)),a("div",ay,[Q(ko),x[14]||(x[14]=a("div",{class:"mt-6"},[a("p",{class:"text-sm text-gray-700"},"Use this page to jot down practice notes, observations, or reminders for your current practice sessions.")],-1)),a("div",ly,[a("div",{class:it(["collapse border rounded",{"collapse-open":i.value}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:x[0]||(x[0]=j=>i.value=!i.value)},"Notes"),a("div",cy,[a("div",uy,[a("label",dy,[ae(a("input",{type:"checkbox",class:"checkbox checkbox-sm mr-2","onUpdate:modelValue":x[1]||(x[1]=j=>r.value=j)},null,512),[[zt,r.value]]),x[8]||(x[8]=a("span",{class:"text-sm"},"Show Open Tasks Only",-1))]),a("button",{class:"btn btn-xs btn-outline ml-2",onClick:d},"Refresh")]),a("div",fy,[x[12]||(x[12]=a("h4",{class:"font-medium"},"Add New Note",-1)),a("div",hy,[x[9]||(x[9]=a("label",{class:"label"},[a("span",{class:"label-text"},"Title")],-1)),ae(a("input",{"onUpdate:modelValue":x[2]||(x[2]=j=>o.value.title=j),class:"input input-sm input-bordered",placeholder:"Short title"},null,512),[[$e,o.value.title]])]),a("div",py,[x[10]||(x[10]=a("label",{class:"label"},[a("span",{class:"label-text"},"Detail")],-1)),ae(a("textarea",{"onUpdate:modelValue":x[3]||(x[3]=j=>o.value.detail=j),class:"textarea textarea-sm textarea-bordered",placeholder:"Details or reminders"},null,512),[[$e,o.value.detail]])]),a("div",my,[x[11]||(x[11]=a("label",{class:"label"},[a("span",{class:"label-text"},"Practice Unit")],-1)),ae(a("input",{"onUpdate:modelValue":x[4]||(x[4]=j=>o.value.practice_unit=j),class:"input input-sm input-bordered",placeholder:"Practice Unit or N/A"},null,512),[[$e,o.value.practice_unit]])]),a("div",gy,[a("button",{class:"btn btn-primary btn-sm",onClick:f,disabled:n.value},"Add Note",8,vy),a("button",{class:"btn btn-ghost btn-sm",onClick:h},"Clear")])]),a("div",null,[s.value?(C(),T("div",yy,"Loading notes")):(C(),T("div",by,[e.value.length?me("",!0):(C(),T("div",_y,"No notes saved.")),a("ul",wy,[(C(!0),T(Re,null,st(R.value,j=>(C(),T("li",{key:j.id,class:"border p-3 rounded bg-base-100"},[a("div",xy,[a("div",null,[a("div",Sy,D(j.title||"(no title)"),1),a("div",ky,[X(D(j.practice_unit||"N/A")+"  ",1),a("span",Ay,"Created: "+D(u(j.created_at)),1)])]),a("div",Ey,[a("button",{class:"btn btn-xs",onClick:I=>P(j)},D(j.status==="open"?"Close":"Reopen"),9,Cy),a("button",{class:"btn btn-xs btn-outline",onClick:I=>p(j)},"Edit",8,Oy),a("button",{class:"btn btn-xs btn-error",onClick:I=>k(j)},"Delete",8,Ty)])]),c.value!==j.id?(C(),T("div",$y,D(j.detail),1)):(C(),T("div",Py,[ae(a("input",{"onUpdate:modelValue":x[5]||(x[5]=I=>l.value.title=I),class:"input input-sm input-bordered mb-2"},null,512),[[$e,l.value.title]]),ae(a("textarea",{"onUpdate:modelValue":x[6]||(x[6]=I=>l.value.detail=I),class:"textarea textarea-sm textarea-bordered mb-2"},null,512),[[$e,l.value.detail]]),ae(a("input",{"onUpdate:modelValue":x[7]||(x[7]=I=>l.value.practice_unit=I),class:"input input-sm input-bordered mb-2"},null,512),[[$e,l.value.practice_unit]]),a("div",Ry,[a("button",{class:"btn btn-sm btn-primary",onClick:I=>v(j)},"Save",8,Uy),a("button",{class:"btn btn-sm btn-ghost",onClick:g},"Cancel")])]))]))),128))])]))])])],2)]),a("div",jy,[Q(ne(bt),{to:"/practice",class:"mtsFormatPracticeButtons"},{default:Ge(()=>[...x[13]||(x[13]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"music_note",-1),X(" Return to Practice ",-1)])]),_:1})])])]),Q(_t)]))}},Ny={class:"bg-base-200 flex flex-col min-h-screen"},Dy={class:"container mx-auto p-4 flex-1"},Ly={class:"flex flex-col gap-6 max-w-xs mx-auto mt-8",style:{display:"flex","flex-direction":"column",gap:"1.5em","max-width":"400px",margin:"2em auto"}},Fy={__name:"Creator",setup(t){return(e,s)=>{const n=oo("RouterLink");return C(),T("div",Ny,[Q(pt),a("main",Dy,[s[5]||(s[5]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatCreatorPages"},[a("span",{class:"material-symbols-outlined"},"edit_square"),a("span",{class:"text-2xl font-bold"},"Creator")],-1)),a("div",Ly,[Q(n,{to:"/create-scales",class:"mtsFormatCreatorButtons"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"queue_music",-1),X(" Create Scale ",-1)])]),_:1}),Q(n,{to:"/create-exercises",class:"mtsFormatCreatorButtons"},{default:Ge(()=>[...s[1]||(s[1]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"add_circle",-1),X(" Create Exercise ",-1)])]),_:1}),Q(n,{to:"/create-edit-practice-unit",class:"mtsFormatCreatorButtons"},{default:Ge(()=>[...s[2]||(s[2]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"edit",-1),X(" Edit Practice Unit ",-1)])]),_:1}),Q(n,{to:"/create-practice-unit-view",class:"mtsFormatCreatorButtons"},{default:Ge(()=>[...s[3]||(s[3]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"visibility",-1),X(" Preview Practice Unit ",-1)])]),_:1}),s[4]||(s[4]=a("br",null,null,-1))])]),Q(_t)])}}},My={class:"bg-base-200 flex flex-col min-h-screen"},By={class:"container mx-auto p-4 flex-1"},Vy={class:"flex flex-col gap-6 max-w-xs mx-auto mt-8",style:{display:"flex","flex-direction":"column",gap:"1.5em","max-width":"400px",margin:"2em auto"}},Hy={__name:"Lessons",setup(t){return(e,s)=>(C(),T("div",My,[Q(pt),a("main",By,[s[3]||(s[3]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatLessonPages"},[a("span",{class:"material-symbols-outlined"},"menu_book"),a("span",{class:"text-2xl font-bold"},"Lessons")],-1)),a("div",Vy,[Q(ne(bt),{to:"/lessons-create",class:"mtsFormatLessonButtons"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"add_circle",-1),X(" Create Lessons ",-1)])]),_:1}),Q(ne(bt),{to:"/lessons-manage",class:"mtsFormatLessonButtons"},{default:Ge(()=>[...s[1]||(s[1]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"launch",-1),X(" Manage Lessons ",-1)])]),_:1}),Q(ne(bt),{to:"/lessons-start",class:"mtsFormatLessonButtons"},{default:Ge(()=>[...s[2]||(s[2]=[a("span",{class:"material-symbols-outlined","aria-hidden":"true"},"play_circle",-1),X(" Start Lesson ",-1)])]),_:1})])]),Q(_t)]))}},qy={style:{"max-width":"400px",margin:"2em auto"}},Ao={__name:"LessonsReturn",setup(t){return(e,s)=>(C(),T("div",qy,[Q(ne(bt),{to:"/lessons",class:"mtsFormatLessonButtons"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"menu_book",-1),X(" Return to Lessons ",-1)])]),_:1})]))}},Gy={class:"bg-base-200 flex flex-col min-h-screen"},Ky={class:"container mx-auto p-4 flex-1"},Wy={class:"max-w-3xl mx-auto"},Jy={class:"card bg-base-100 shadow-sm mb-4"},zy={class:"card-body"},Yy={key:0,class:"p-4"},Xy={key:1,class:"p-4"},Qy={class:"alert alert-warning"},Zy={key:2,class:"p-4 text-gray-500"},eb={key:3,class:"space-y-2"},tb={class:"flex items-center gap-3"},sb={class:"font-medium"},nb={class:"text-xs text-gray-500"},rb={class:"flex gap-2"},ib=["onClick"],ob=["onClick"],ab=["onClick"],lb=["onClick"],cb={key:0,class:"modal modal-open"},ub={class:"modal-box max-w-2xl"},db={class:"font-bold text-lg"},fb={class:"py-4"},hb={key:0,class:"p-2"},pb={key:1},mb={class:"space-y-2"},gb=["onDragstart","onDrop"],vb={class:"font-medium"},yb={class:"text-xs text-gray-500"},bb={class:"flex gap-2"},_b=["disabled","onClick"],wb=["disabled","onClick"],xb=["onClick"],Sb={class:"mt-4"},kb={class:"flex gap-2"},Ab=["value"],Eb=["disabled"],Cb={__name:"LessonsManage",setup(t){const e=Hr(),s=z(null),n=z(""),r=z(null),i=z(""),o=z(!1),c=z([]),l=z(""),u=ie(()=>{const G=new Set((c.value||[]).map(K=>K.practice_unit_id));return(e.availableUnits||[]).filter(K=>!G.has(K.practice_unit_id))}),d=z(-1);function f(G,K){try{G.dataTransfer.setData("text/plain",String(K)),G.dataTransfer.setDragImage}catch{}d.value=K}function h(G,K){const J=Number(G.dataTransfer.getData("text/plain"));if(isNaN(J)||J===K)return;const ce=c.value;if(J<0||J>=ce.length||K<0||K>ce.length)return;const[ge]=ce.splice(J,1),Se=J<K?K-1:K;ce.splice(Se,0,ge),d.value=-1}function p(){d.value=-1}function g(){e.fetchLessons()}function v(G){s.value=G.lesson_id,n.value=G.lesson_name||""}function k(){s.value=null,n.value=""}async function P(G){try{await e.updateLessonName(G.lesson_id,n.value.trim()),s.value=null,n.value=""}catch(K){alert(K?.message||"Update failed")}}function R(G){confirm(`Delete lesson "${G.lesson_name}"? This cannot be undone.`)&&e.deleteLesson(G.lesson_id).catch(K=>alert(K?.message||"Delete failed"))}Ye(()=>{g(),(!e.availableUnits||e.availableUnits.length===0)&&e.fetchPracticeUnits().catch(G=>console.warn("Failed to load practice units",G))});async function S(G){if(!(!G||!G.lesson_id)){r.value=G.lesson_id,i.value=G.lesson_name||"",o.value=!0,c.value=[];try{const K=await e.fetchLessonUnits(G.lesson_id);c.value=(K||[]).map(J=>({practice_unit_id:J.practice_unit_id,name:J.name||J.unit_json?.practiceUnitHeader?.title||"(untitled)",type:J.type||J.unit_json?.practiceUnitHeader?.type||"",unit_json:J.unit_json||null,sort_order:J.sort_order}))}catch(K){alert(K?.message||"Failed to load lesson units")}finally{o.value=!1}}}function x(){r.value=null,i.value="",c.value=[],l.value=""}function j(G){if(G<=0)return;const K=c.value,[J]=K.splice(G,1);K.splice(G-1,0,J)}function I(G){if(G<0||G>=c.value.length-1)return;const K=c.value,[J]=K.splice(G,1);K.splice(G+1,0,J)}function _(G){c.value=c.value.filter(K=>K.practice_unit_id!==G)}function U(){const G=l.value;if(!G)return;const K=e.availableUnits.find(J=>J.practice_unit_id===G);K&&(c.value.push({practice_unit_id:K.practice_unit_id,name:K.name,type:K.type,unit_json:K.unit_json}),l.value="")}async function B(){if(r.value)try{const G=(c.value||[]).map(K=>K.practice_unit_id);await e.updateLessonUnits(r.value,G),x(),await e.fetchLessons()}catch(G){alert(G?.message||"Failed to save lesson units")}}return(G,K)=>(C(),T("div",Gy,[Q(pt),a("main",Ky,[K[7]||(K[7]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatLessonPages"},[a("span",{class:"material-symbols-outlined"},"launch"),a("span",{class:"text-2xl font-bold"},"Manage Lessons")],-1)),a("div",Wy,[a("div",Jy,[a("div",zy,[a("div",{class:"flex items-center justify-between"},[K[3]||(K[3]=a("h3",{class:"card-title"},"Your Lessons",-1)),a("div",null,[a("button",{class:"btn btn-sm",onClick:g},"Refresh")])]),ne(e).lessonsLoading?(C(),T("div",Yy,[...K[4]||(K[4]=[a("span",{class:"loading loading-spinner loading-md"},null,-1),a("span",{class:"ml-2"},"Loading lessons",-1)])])):ne(e).lessonsError?(C(),T("div",Xy,[a("div",Qy,[a("div",null,D(ne(e).lessonsError),1),a("div",{class:"ml-auto"},[a("button",{class:"btn btn-xs",onClick:g},"Retry")])])])):ne(e).availableLessons.length===0?(C(),T("div",Zy," No lessons found. ")):(C(),T("ul",eb,[(C(!0),T(Re,null,st(ne(e).availableLessons,J=>(C(),T("li",{key:J.lesson_id,class:"flex items-center justify-between p-2 bg-base-200 rounded"},[a("div",tb,[a("div",sb,[s.value===J.lesson_id?ae((C(),T("input",{key:0,"onUpdate:modelValue":K[0]||(K[0]=ce=>n.value=ce),class:"input input-sm input-bordered"},null,512)),[[$e,n.value]]):(C(),T(Re,{key:1},[X(D(J.lesson_name),1)],64))]),a("div",nb,D(J.created_at?new Date(J.created_at).toLocaleString():""),1)]),a("div",rb,[s.value!==J.lesson_id?(C(),T("button",{key:0,class:"btn btn-xs",onClick:ce=>v(J)},"Edit",8,ib)):(C(),T("button",{key:1,class:"btn btn-xs btn-success",onClick:ce=>P(J)},"Save",8,ob)),s.value===J.lesson_id?(C(),T("button",{key:2,class:"btn btn-xs",onClick:k},"Cancel")):me("",!0),a("button",{class:"btn btn-xs",onClick:ce=>S(J)},"Edit Units",8,ab),a("button",{class:"btn btn-xs btn-error",onClick:ce=>R(J)},"Delete",8,lb)])]))),128))]))])]),r.value?(C(),T("div",cb,[a("div",ub,[a("h3",db,"Edit Practice Units  "+D(i.value),1),a("div",fb,[o.value?(C(),T("div",hb,"Loading units")):(C(),T("div",pb,[a("ul",mb,[(C(!0),T(Re,null,st(c.value,(J,ce)=>(C(),T("li",{key:J.practice_unit_id,class:it(["flex items-center justify-between p-2 bg-base-200 rounded",{"opacity-60":d.value===ce}]),draggable:"true",onDragstart:ge=>f(ge,ce),onDragover:K[1]||(K[1]=Ze(()=>{},["prevent"])),onDrop:ge=>h(ge,ce),onDragend:p},[a("div",null,[a("div",vb,D(J.name||"(untitled)"),1),a("div",yb,D(J.type||""),1)]),a("div",bb,[a("button",{class:"btn btn-xs",disabled:ce===0,onClick:ge=>j(ce)},"",8,_b),a("button",{class:"btn btn-xs",disabled:ce===c.value.length-1,onClick:ge=>I(ce)},"",8,wb),a("button",{class:"btn btn-xs btn-ghost btn-sm text-error",onClick:ge=>_(J.practice_unit_id)},"Remove",8,xb)])],42,gb))),128))]),a("div",Sb,[K[6]||(K[6]=a("label",{class:"block text-sm font-medium mb-1"},"Add Practice Unit",-1)),a("div",kb,[ae(a("select",{"onUpdate:modelValue":K[2]||(K[2]=J=>l.value=J),class:"select select-sm w-full"},[K[5]||(K[5]=a("option",{value:""},"-- choose --",-1)),(C(!0),T(Re,null,st(u.value,J=>(C(),T("option",{key:J.practice_unit_id,value:J.practice_unit_id},D(J.name||"(untitled)")+"  "+D(J.type),9,Ab))),128))],512),[[As,l.value]]),a("button",{class:"btn btn-sm",disabled:!l.value,onClick:U},"Add",8,Eb)])])]))]),a("div",{class:"modal-action"},[a("button",{class:"btn",onClick:x},"Cancel"),a("button",{class:"btn btn-primary",onClick:B},"Save")])])])):me("",!0),Q(Ao)])]),Q(_t)]))}},Ob={class:"bg-base-200 flex flex-col min-h-screen"},Tb={class:"container mx-auto p-4 flex-1"},$b={__name:"LessonsStart",setup(t){return(e,s)=>(C(),T("div",Ob,[Q(pt),a("main",Tb,[s[0]||(s[0]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatLessonPages"},[a("span",{class:"material-symbols-outlined"},"play_circle"),a("span",{class:"text-2xl font-bold"},"Start Lesson")],-1)),Q(Ao)]),Q(_t)]))}},Pb={style:{"max-width":"400px",margin:"2em auto"}},Rb={__name:"CreatorReturn",setup(t){return(e,s)=>(C(),T("div",Pb,[Q(ne(bt),{to:"/creator",class:"mtsFormatCreatorButtons"},{default:Ge(()=>[...s[0]||(s[0]=[a("span",{class:"material-symbols-outlined align-middle mr-2"},"edit_square",-1),X(" Return to Creator ",-1)])]),_:1})]))}},xu=(t,e)=>{const s=t.__vccOpts||t;for(const[n,r]of e)s[n]=r;return s},Ub={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},jb={class:"collapse-title font-bold text-lg px-4 flex justify-between items-center"},Ib={key:0,class:"text-right text-base font-normal text-gray-600"},Nb={class:"collapse-content px-4"},Db=["value"],Lb={__name:"InstrumentDropdown",props:{instruments:{type:Array,required:!0},modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(t,{emit:e}){const s=t,n=e,r=z(s.modelValue?.instrument||"");qe(()=>s.modelValue,o=>{r.value=o?.instrument||""});function i(){const o=s.instruments.find(c=>c.instrument===r.value);n("update:modelValue",o||null)}return(o,c)=>(C(),T("div",Ub,[c[2]||(c[2]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",jb,[c[1]||(c[1]=a("span",null,"Instrument",-1)),r.value?(C(),T("span",Ib,D(r.value.split(",")[0]),1)):me("",!0)]),a("div",Nb,[ae(a("select",{id:"instrument-select","onUpdate:modelValue":c[0]||(c[0]=l=>r.value=l),class:"select select-bordered w-full",onChange:i},[(C(!0),T(Re,null,st(t.instruments,l=>(C(),T("option",{key:l.instrument,value:l.instrument},D(l.instrument),9,Db))),128))],544),[[As,r.value]])])]))}},qr=xu(Lb,[["__scopeId","data-v-2864ec83"]]),Fb={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Mb={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},Bb={key:0,class:"text-right text-base font-normal text-gray-600"},Vb={key:0},Hb={key:1},qb={key:2},Gb={key:3},Kb={key:4},Wb={key:5},Jb={key:6},zb={key:7},Yb={class:"collapse-content"},Xb={class:"mb-4"},Qb={class:"space-y-2 text-sm"},Zb={class:"flex items-center gap-2"},e_={class:"flex items-center gap-2"},t_={key:0,class:"text-red-600 text-xs pl-6",role:"alert"},s_={class:"flex items-center gap-2"},n_={class:"flex items-center gap-2"},r_={class:"flex items-center gap-2"},i_={class:"mb-3"},o_={class:"flex gap-6"},a_={class:"flex items-center gap-2 cursor-pointer"},l_={class:"flex items-center gap-2 cursor-pointer"},c_={class:"flex items-center gap-2 cursor-pointer"},u_={class:"flex items-center gap-2 cursor-pointer"},Su={__name:"CreateScale-ScaleStaffFormatting",props:{scaleSelections:{type:Object,default:()=>({key:"C",scaleType:"major",startingOctave:"C4",octaveCount:1,direction:"Ascending",noteDuration:"quarter",staffOptions:{keySignature:!0,accidentals:!0,barLines:!0,timeSignature:!0,measuresPerLineMax:2,enforceLedgerLimits:!1,accidentalFamily:"auto-key"}})},hideSummaryExtras:{type:Boolean,default:!1}},emits:["update:scaleSelections"],setup(t,{emit:e}){const s=t,n=e,r=ie({get:()=>s.scaleSelections,set:c=>n("update:scaleSelections",c)}),i=ie(()=>"Default"),o=ie(()=>r.value?.staffOptions?.enforceLedgerLimits?"Enforced":"Off");return(c,l)=>(C(),T("div",Fb,[l[29]||(l[29]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",Mb,[l[12]||(l[12]=a("span",null,"Staff Formatting",-1)),r.value.staffOptions?(C(),T("span",Bb,[l[11]||(l[11]=X(" Options: ",-1)),r.value.staffOptions.keySignature?(C(),T("span",Vb,"Key Signature, ")):me("",!0),r.value.staffOptions.barLines?(C(),T("span",Hb,"Bar Lines, ")):me("",!0),r.value.staffOptions.timeSignature?(C(),T("span",qb,"Time Signature, ")):me("",!0),r.value.staffOptions.accidentals?(C(),T("span",Gb,"Accidentals. ")):me("",!0),r.value.staffOptions.accidentalFamily==="auto-key"?(C(),T("span",Kb,"Auto: Based on Key")):r.value.staffOptions.accidentalFamily==="auto-direction"?(C(),T("span",Wb,"Auto: Based on Asc/Desc")):r.value.staffOptions.accidentalFamily==="force-sharps"?(C(),T("span",Jb,"Force: Sharps")):r.value.staffOptions.accidentalFamily==="force-flats"?(C(),T("span",zb,"Force: Flats")):me("",!0),t.hideSummaryExtras?me("",!0):(C(),T(Re,{key:8},[l[9]||(l[9]=a("span",{class:"mx-2"},"|",-1)),a("span",null,"Spacing: "+D(i.value),1),l[10]||(l[10]=a("span",{class:"mx-2"},"|",-1)),a("span",null,"Ledger: "+D(o.value),1)],64))])):me("",!0)]),a("div",Yb,[a("div",Xb,[l[23]||(l[23]=a("div",{class:"font-semibold mb-2"},"Staff Display Options:",-1)),a("div",Qb,[a("label",Zb,[ae(a("input",{type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=u=>r.value.staffOptions.keySignature=u)},null,512),[[zt,r.value.staffOptions.keySignature]]),l[13]||(l[13]=X(" Key Signature ",-1)),l[14]||(l[14]=a("span",{class:"text-blue-600 cursor-help",title:"Shows the key signature at the beginning of the staff"},"",-1))]),a("label",e_,[ae(a("input",{type:"checkbox","onUpdate:modelValue":l[1]||(l[1]=u=>r.value.staffOptions.accidentals=u)},null,512),[[zt,r.value.staffOptions.accidentals]]),l[15]||(l[15]=X(" Accidentals ",-1)),l[16]||(l[16]=a("span",{class:"text-blue-600 cursor-help",title:"Shows individual accidentals next to notes"},"",-1))]),r.value?.staffOptions&&!r.value.staffOptions.keySignature&&!r.value.staffOptions.accidentals?(C(),T("div",t_," If neither Key Signature or Accidentals is selected then notes will not indicate sharps or flats. ")):me("",!0),a("label",s_,[ae(a("input",{type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=u=>r.value.staffOptions.barLines=u)},null,512),[[zt,r.value.staffOptions.barLines]]),l[17]||(l[17]=X(" Bar Lines ",-1)),l[18]||(l[18]=a("span",{class:"text-blue-600 cursor-help",title:"Shows bar lines to separate measures"},"",-1))]),a("label",n_,[ae(a("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=u=>r.value.staffOptions.timeSignature=u)},null,512),[[zt,r.value.staffOptions.timeSignature]]),l[19]||(l[19]=X(" Time Signature ",-1)),l[20]||(l[20]=a("span",{class:"text-blue-600 cursor-help",title:"Shows the time signature at the beginning of the staff"},"",-1))]),a("label",r_,[ae(a("input",{type:"checkbox","onUpdate:modelValue":l[4]||(l[4]=u=>r.value.staffOptions.enforceLedgerLimits=u)},null,512),[[zt,r.value.staffOptions.enforceLedgerLimits]]),l[21]||(l[21]=X(" Enforce Ledger Limits ",-1)),l[22]||(l[22]=a("span",{class:"text-blue-600 cursor-help",title:"When enabled, notes outside configured ledger line limits will not render. When off, all valid notes render."},"",-1))])])]),a("div",i_,[l[28]||(l[28]=a("div",{class:"font-semibold mb-2"},"Accidental Family:",-1)),a("div",o_,[a("label",a_,[ae(a("input",{type:"radio",name:"accidental-family",value:"auto-key",class:"radio radio-primary","onUpdate:modelValue":l[5]||(l[5]=u=>r.value.staffOptions.accidentalFamily=u)},null,512),[[Be,r.value.staffOptions.accidentalFamily]]),l[24]||(l[24]=a("span",null,"Auto: Based on Key",-1))]),a("label",l_,[ae(a("input",{type:"radio",name:"accidental-family",value:"auto-direction",class:"radio radio-primary","onUpdate:modelValue":l[6]||(l[6]=u=>r.value.staffOptions.accidentalFamily=u)},null,512),[[Be,r.value.staffOptions.accidentalFamily]]),l[25]||(l[25]=a("span",null,"Auto: Based on Asc/Desc",-1))]),a("label",c_,[ae(a("input",{type:"radio",name:"accidental-family",value:"force-sharps",class:"radio radio-primary","onUpdate:modelValue":l[7]||(l[7]=u=>r.value.staffOptions.accidentalFamily=u)},null,512),[[Be,r.value.staffOptions.accidentalFamily]]),l[26]||(l[26]=a("span",null,"Force: Sharps",-1))]),a("label",u_,[ae(a("input",{type:"radio",name:"accidental-family",value:"force-flats",class:"radio radio-primary","onUpdate:modelValue":l[8]||(l[8]=u=>r.value.staffOptions.accidentalFamily=u)},null,512),[[Be,r.value.staffOptions.accidentalFamily]]),l[27]||(l[27]=a("span",null,"Force: Flats",-1))])])])])]))}},d_={class:"bg-base-200 flex flex-col min-h-screen"},f_={class:"container mx-auto p-4 flex-1"},h_={class:"max-w-3xl mx-auto mb-4"},p_={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},m_={class:"collapse-content px-4 space-y-4"},g_={key:0,class:"text-sm text-gray-700"},v_={key:1,class:"mt-2"},y_={class:"text-xs text-gray-600 mb-1"},b_={key:0,class:"mt-3 flex items-center gap-2"},__={class:"text-sm text-gray-600"},w_={key:1,class:"mt-3 flex items-center gap-2"},x_={class:"text-sm text-gray-600"},S_={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},k_={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},A_={class:"text-sm font-normal text-gray-500"},E_={class:"collapse-content px-4 space-y-3"},C_={key:0,class:"text-sm text-error"},O_={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},T_={class:"collapse-content px-4 grid gap-3 max-w-xl"},$_={class:"form-control"},P_={class:"form-control"},R_={class:"form-control"},U_={class:"form-control"},j_={class:"form-control"},I_=["disabled"],N_={class:"mb-4"},D_={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},L_={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},F_={class:"text-right text-base font-normal text-gray-600"},M_={class:"collapse-content px-4"},B_={class:"flex items-center gap-4"},V_=["disabled"],H_={class:"text-center"},q_={class:"px-3 py-1 border rounded bg-white text-gray-800 font-mono"},G_=["disabled"],K_={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},W_={class:"collapse-content px-4"},J_={class:"bg-base-100 p-4 rounded text-xs overflow-x-auto max-h-96"},z_={__name:"CreateExercise",setup(t){const e=ds(),s=Zt();e.scaleSelections||(e.scaleSelections=$t({key:"C",scaleType:"Major",startingOctave:"C4",octaveCount:1,maxMeasuresPerLine:2,direction:"ascending",noteDuration:"quarter",timeSignature:"4/4",staffOptions:{keySignature:!0,accidentals:!0,barLines:!0,timeSignature:!0,measuresPerLineMax:2,enforceLedgerLimits:!1,accidentalFamily:"auto-key"}}));const n=z(""),r=z(""),i=z(""),o=z(""),c=z("");z(""),z(null);const l=z(0);let u=z([]);z(!1);const d=z([]);z(!1);const f=z("");ie(()=>{const Z=(f.value||"").trim().toLowerCase(),N=d.value||[];return Z?N.filter(A=>{try{const m=A?.unit_json?.practiceUnitHeader||{},$=m?.instrument?.instrument||m?.instrument||"";return[A?.name,A?.type,m?.keySignature,m?.timeSignature,(m?.techniqueFocus||[]).join(" "),$].filter(Boolean).map(te=>String(te).toLowerCase()).some(te=>te.includes(Z))}catch{return!1}}):N});const h=z(null),p=z("{}");function g(){try{p.value=JSON.stringify(h.value||{},null,2)}catch{p.value="{}"}}Ye(()=>{if(e.noteArray&&e.noteArray.length>0){const Z=e.practiceUnitHeader||{};n.value=Z.practiceName||Z.sourceTitle||"Imported from Scale",r.value=Z.keySignature||"C",i.value=Z.timeSignature||"4/4",u.value=e.noteArray.map(N=>({...N})),l.value=0,s.noteArray=e.noteArray.map(N=>({...N})),h.value=x(e.noteArray),h.value.practiceUnitHeader.practiceName=n.value,h.value.practiceUnitHeader.keySignature=r.value,h.value.practiceUnitHeader.timeSignature=i.value,e.practiceUnitHeader={...e.practiceUnitHeader,...h.value.practiceUnitHeader},Ae(),g(),console.log("[CreateExercise] Auto-populated workspace from existing scale data")}});function v(Z){o.value="";const N=Z?.target?.files?.[0];N&&(c.value=N.name,N.text().then(A=>{try{const m=k(A);if(!m?.noteArray?.length){o.value="No playable notes found in MusicXML.";return}n.value=m.title||"Imported Exercise",r.value=m.keySignature||"C",i.value=m.timeSignature||"4/4",u.value=m.noteArray.map($=>({...$})),l.value=0,e.noteArray=u.value.map($=>({...$})),s.noteArray=u.value.map($=>({...$})),e.scaleSelections=e.scaleSelections||{},e.scaleSelections.key=r.value,e.scaleSelections.timeSignature=i.value,e.title=n.value,h.value=x(e.noteArray),h.value.practiceUnitHeader.practiceName=n.value,h.value.practiceUnitHeader.keySignature=r.value,h.value.practiceUnitHeader.timeSignature=i.value,e.practiceUnitHeader={...e.practiceUnitHeader,...h.value.practiceUnitHeader},Ae(),g()}catch(m){console.warn("[CreateExercise] MusicXML parse failed",m),o.value="MusicXML parse failed. See console."}}).catch(()=>o.value="Failed to read file."))}function k(Z){const N=new DOMParser().parseFromString(Z,"application/xml");if(N.getElementsByTagName("parsererror").length)throw new Error("Invalid XML");const A=M=>N.querySelector(M)?.textContent?.trim()||"",m=A("work > work-title")||A("movement-title")||"",$=A("part measure attributes key fifths"),q=S(Number.parseInt($||"0",10)),te=A("part measure attributes time beats")||"4",le=A("part measure attributes time beat-type")||"4",b=`${te}/${le}`,w=N.querySelector("score-partwise > part"),O=[];if(w){const M=w.querySelectorAll("measure > note");for(const V of M){if(V.querySelector("rest")||V.querySelector("chord"))return;const H=V.querySelector("pitch > step")?.textContent?.trim()||"",se=Number.parseInt(V.querySelector("pitch > alter")?.textContent?.trim()||"0",10),ee=V.querySelector("pitch > octave")?.textContent?.trim()||"4",E=V.querySelector("type")?.textContent?.trim()||"quarter",y=P(H,se,ee),L=V.querySelectorAll("dot").length,F=R(E,L);y&&F&&O.push({pitch:y,duration:F})}}return{title:m,keySignature:q,timeSignature:b,noteArray:O}}function P(Z,N,A){if(!Z)return"";let m="";return N===1?m="#":N===-1?m="b":N>1?m="##":N<-1&&(m="bb"),`${Z}${m}${A}`}function R(Z,N=0){let A="";switch(Z){case"whole":A="w";break;case"half":A="h";break;case"quarter":A="q";break;case"eighth":A="e";break;case"16th":A="s";break}return A?N>0?A+".":A:""}function S(Z){return{"-7":"Cb major","-6":"Gb major","-5":"Db major","-4":"Ab major","-3":"Eb major","-2":"Bb major","-1":"F major",0:"C major",1:"G major",2:"D major",3:"A major",4:"E major",5:"B major",6:"F# major",7:"C# major"}[String(Number.isNaN(Z)?0:Z)]||"C major"}function x(Z){return{practiceUnitHeader:{practiceName:n.value||"Imported Exercise",practiceUnitId:crypto.randomUUID?crypto.randomUUID():"temp-"+Date.now(),practiceUnitType:"Exercise",lastModified:new Date().toISOString(),tempo:80,keySignature:r.value||"C",timeSignature:i.value||"4/4",instrument:e.instrument||{},staffDisplayOptions:{showAccidentals:!0,showOverlays:!0,measuresPerLineMax:2},sourceURL:"",noteColorDesignation:{},contentType:"Passage",techniqueFocus:[],tagSource:"user",repetitionCount:1,sourceMusicXML:c.value||"",instrumentOverride:"",direction:"",startingOctave:"",numberOfOctaves:null,rangeStart:null,rangeEnd:null,composer:"",sourceWork:""},noteArray:Z}}const j=z(""),I=z(80),_=z(1),U=z(""),B=z(""),G=ie(()=>{const Z=e.noteArray||[],N=Z.some(q=>(q.noteColor||"").toLowerCase()==="green"),A=Z.some(q=>(q.noteColor||"").toLowerCase()==="red");if(!N||!A)return!1;const m=Z.findIndex(q=>(q.noteColor||"").toLowerCase()==="green"),$=Z.reduce((q,te,le)=>(te.noteColor||"").toLowerCase()==="red"?le:q,-1);return m>=0&&$>=0&&m<=$}),K=ie(()=>(e.noteArray||[]).findIndex(N=>(N.noteColor||"").toLowerCase()==="green")),J=ie(()=>(e.noteArray||[]).reduce((N,A,m)=>(A.noteColor||"").toLowerCase()==="red"?m:N,-1)),ce=ie(()=>(e.noteArray||[]).some(N=>{const A=(N.noteColor||"").toLowerCase();return A==="orange"||A==="gray"})),ge=ie(()=>(e.noteArray||[]).filter(N=>(N.noteColor||"").toLowerCase()==="orange").length),Se=ie(()=>(e.noteArray||[]).filter(N=>(N.noteColor||"").toLowerCase()==="gray").length);function Ae(){const Z=h.value?.practiceUnitHeader||{};j.value=Z.practiceName||"Imported Exercise",I.value=Number(Z.tempo||80),_.value=Number(Z.repetitionCount||1),U.value=(Z.techniqueFocus||[]).join(", "),B.value=Z.sourceURL||""}function fe(){if(!h.value)return;const Z=h.value.practiceUnitHeader;Z.practiceName=j.value||Z.practiceName,Z.tempo=Number(I.value)||80,Z.sourceURL=B.value||"",Z.repetitionCount=Number(_.value)||1,Z.techniqueFocus=(U.value||"").split(",").map(N=>N.trim()).filter(Boolean),g()}function re(){try{const Z=K.value,N=J.value;if(Z<0||N<0||Z>N){console.warn("[CreateExercise] Trim range invalid",Z,N);return}const m=(e.noteArray||[]).slice(Z,N+1).map($=>({...$,noteColor:"black"}));e.noteArray=m,s.noteArray=m.map($=>({...$})),h.value&&(h.value.noteArray=m,g()),u.value=m.map($=>({...$})),l.value=0}catch(Z){console.warn("[CreateExercise] doTrim failed",Z)}}function we(){try{const Z=e.noteArray||[],N=[];for(const A of Z){const m=(A.noteColor||"").toLowerCase();m!=="orange"&&(m==="gray"?N.push({...A,pitch:"B/4",duration:A.duration+"r",noteColor:"black"}):N.push({...A,noteColor:"black"}))}e.noteArray=N,s.noteArray=N.map(A=>({...A})),h.value&&(h.value.noteArray=N,g()),u.value=N.map(A=>({...A})),console.log("[CreateExercise] Deleted orange notes and converted gray notes to rests")}catch(Z){console.warn("[CreateExercise] deleteSelectedNotes failed",Z)}}function Ee(Z,N){const A=String(Z).match(/^([A-G][#b]?)(\d+)$/);if(!A)return Z;const m=A[1],q=Number.parseInt(A[2],10)+N;return`${m}${q}`}function _e(){const Z=l.value||0,A=(Array.isArray(u.value)?u.value:[]).map(m=>m?.pitch?{...m,pitch:Ee(m.pitch,Z)}:{...m});e.noteArray=A,s.noteArray=A.map(m=>({...m})),h.value&&(h.value.noteArray=A,g())}function Te(){l.value>=2||(l.value+=1,_e())}function Ue(){l.value<=-2||(l.value-=1,_e())}return(Z,N)=>(C(),T("div",d_,[Q(pt),a("main",f_,[N[29]||(N[29]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatCreatorPages"},[a("span",{class:"material-symbols-outlined"},"add_circle"),a("span",{class:"text-2xl font-bold"},"Create Exercise")],-1)),a("div",h_,[Q(ko)]),a("div",p_,[N[11]||(N[11]=a("input",{type:"checkbox",class:"peer",checked:""},null,-1)),N[12]||(N[12]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Preview")],-1)),a("div",m_,[n.value?(C(),T("div",g_,[a("div",null,[N[7]||(N[7]=a("strong",null,"Title:",-1)),X(" "+D(n.value),1)]),a("div",null,[N[8]||(N[8]=a("strong",null,"Key:",-1)),X(" "+D(r.value||"Unknown"),1)]),a("div",null,[N[9]||(N[9]=a("strong",null,"Time:",-1)),X(" "+D(i.value||"4/4"),1)])])):me("",!0),ne(e).noteArray?.length?(C(),T("div",v_,[a("div",y_," Imported note count: "+D(ne(e).noteArray.length),1),N[10]||(N[10]=rc('<div class="bg-blue-50 border border-blue-200 rounded p-3 mb-3 text-sm text-gray-700"><strong class="text-blue-800">How to TRIM:</strong> Click on notes to cycle through colors: <span style="background-color:#bbf7d0;padding:0 0.25rem;border-radius:0.25rem;"><strong style="color:#166534;">green</strong></span> = trim start, <span style="background-color:#fecaca;padding:0 0.25rem;border-radius:0.25rem;"><strong style="color:#991b1b;">red</strong></span> = trim end, <span style="background-color:#fed7aa;padding:0 0.25rem;border-radius:0.25rem;"><strong style="color:#9a3412;">orange</strong></span> = delete note, <span style="background-color:#d1d5db;padding:0 0.25rem;border-radius:0.25rem;"><strong style="color:#1f2937;">gray</strong></span> = replace with rest. Press <strong>[TRIM]</strong> to keep only notes between green and red (inclusive). Press <strong>[Delete Selected Notes]</strong> to remove orange notes and convert gray notes to rests. </div>',1)),Q(Gn,{"practice-enable-click-to-cycle":!0,"practice-color-cycle":["black","green","red","orange","gray"]}),G.value?(C(),T("div",b_,[a("button",{class:"btn btn-sm btn-accent",onClick:re}," [TRIM] "),a("div",__," Keeping notes "+D(K.value+1)+"  "+D(J.value+1),1)])):me("",!0),ce.value?(C(),T("div",w_,[a("button",{class:"btn btn-sm btn-warning",onClick:we}," [Delete Selected Notes] "),a("div",x_,D(ge.value)+" to delete, "+D(Se.value)+" to convert to rests ",1)])):me("",!0)])):me("",!0)])]),a("div",S_,[N[15]||(N[15]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",k_,[N[13]||(N[13]=a("span",null,"MusicXML",-1)),a("span",A_,D(c.value||"Select MusicXML file for import"),1)]),a("div",E_,[N[14]||(N[14]=a("p",{class:"text-sm text-gray-600"}," Choose a .musicxml or .xml file. We'll parse title, key, and time, then convert notes into simple tokens: SPN plus duration (w|h|q|e|s) with an optional dot for dotted values (e.g., q., e.). Dotted durations are fully supported and render/measure as 1.5 their base value. ",-1)),a("input",{type:"file",accept:".musicxml,.xml,application/xml,text/xml",onChange:v,class:"file-input file-input-bordered file-input-sm w-full max-w-md"},null,32),o.value?(C(),T("div",C_,D(o.value),1)):me("",!0)])]),a("div",O_,[N[21]||(N[21]=a("input",{type:"checkbox",class:"peer"},null,-1)),N[22]||(N[22]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Edit Exercise Details")],-1)),a("div",T_,[a("div",$_,[N[16]||(N[16]=a("label",{class:"label",for:"exPracticeName"},[a("span",{class:"label-text"},"Practice Name")],-1)),ae(a("input",{id:"exPracticeName","onUpdate:modelValue":N[0]||(N[0]=A=>j.value=A),class:"input input-sm input-bordered",placeholder:"Imported Exercise"},null,512),[[$e,j.value]])]),a("div",P_,[N[17]||(N[17]=a("label",{class:"label",for:"exTempo"},[a("span",{class:"label-text"},"Tempo (bpm)")],-1)),ae(a("input",{id:"exTempo","onUpdate:modelValue":N[1]||(N[1]=A=>I.value=A),type:"number",min:"20",max:"240",class:"input input-sm input-bordered"},null,512),[[$e,I.value,void 0,{number:!0}]])]),a("div",R_,[N[18]||(N[18]=a("label",{class:"label",for:"exReps"},[a("span",{class:"label-text"},"Repetitions")],-1)),ae(a("input",{id:"exReps","onUpdate:modelValue":N[2]||(N[2]=A=>_.value=A),type:"number",min:"1",max:"20",class:"input input-sm input-bordered"},null,512),[[$e,_.value,void 0,{number:!0}]])]),a("div",U_,[N[19]||(N[19]=a("label",{class:"label",for:"exFocus"},[a("span",{class:"label-text"},"Technique Focus (comma-separated)")],-1)),ae(a("input",{id:"exFocus","onUpdate:modelValue":N[3]||(N[3]=A=>U.value=A),class:"input input-sm input-bordered",placeholder:"tone, articulation"},null,512),[[$e,U.value]])]),a("div",j_,[N[20]||(N[20]=a("label",{class:"label",for:"exSourceURL"},[a("span",{class:"label-text"},"Source URL")],-1)),ae(a("input",{id:"exSourceURL","onUpdate:modelValue":N[4]||(N[4]=A=>B.value=A),class:"input input-sm input-bordered",placeholder:"https://..."},null,512),[[$e,B.value]])]),a("div",null,[a("button",{class:"btn btn-primary btn-sm",onClick:fe,disabled:!h.value}," Apply to Current Unit ",8,I_)])])]),a("div",N_,[Q(qr,{instruments:ne(e).instruments,modelValue:ne(e).instrument,"onUpdate:modelValue":N[5]||(N[5]=A=>ne(e).instrument=A)},null,8,["instruments","modelValue"])]),Q(Su,{scaleSelections:ne(e).scaleSelections,"onUpdate:scaleSelections":N[6]||(N[6]=A=>ne(e).scaleSelections=A)},null,8,["scaleSelections"]),a("div",D_,[N[26]||(N[26]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",L_,[N[23]||(N[23]=a("span",null," Octave Controls",-1)),a("span",F_," Octave Transposition: "+D(l.value),1)]),a("div",M_,[a("div",B_,[a("button",{class:"btn btn-sm",onClick:Ue,disabled:l.value<=-2}," [] ",8,V_),a("div",H_,[N[24]||(N[24]=a("div",{class:"font-semibold mb-1"},"Octave Transposition",-1)),a("span",q_,D(l.value),1)]),a("button",{class:"btn btn-sm",onClick:Te,disabled:l.value>=2}," [+] ",8,G_)]),N[25]||(N[25]=a("div",{class:"text-xs text-gray-600 mt-2"}," Range: -2 to +2 octaves. Adjusts note octaves without changing accidentals. ",-1))])]),a("div",K_,[N[27]||(N[27]=a("input",{type:"checkbox",class:"peer"},null,-1)),N[28]||(N[28]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2"}," Behind the Curtain: practiceUnitStore (JSON snapshot) ",-1)),a("div",W_,[a("pre",J_,D(p.value),1)])]),Q(Rb)]),Q(_t)]))}},Y_={class:"bg-base-200 flex flex-col min-h-screen"},X_={class:"container mx-auto p-4 flex-1"},Q_={class:"max-w-2xl mx-auto mb-4"},Z_={class:"card bg-base-100 shadow-sm max-w-2xl mx-auto"},ew={class:"card-body"},tw={class:"mt-6"},sw={key:0,class:"alert alert-warning mb-2"},nw={class:"form-control"},rw={class:"textarea textarea-bordered w-full min-h-48 bg-base-200 overflow-y-auto p-0"},iw={key:0,class:"p-4"},ow={key:1,class:"p-4 text-gray-500"},aw={key:2,class:"p-2 space-y-1"},lw={class:"flex items-center gap-2 flex-1"},cw={class:"badge badge-outline"},uw={class:"font-medium"},dw={key:0,class:"text-xs text-gray-500"},fw=["onClick","title"],hw={class:"mt-6 border-2 border-blue-300 rounded-lg p-4 bg-blue-50"},pw={key:0,class:"text-gray-500 p-4 bg-white rounded"},mw={key:1,class:"space-y-2"},gw={class:"flex items-center gap-2"},vw={class:"badge badge-outline"},yw={class:"badge badge-neutral"},bw={class:"font-medium"},_w={key:0,class:"text-xs text-gray-500"},ww={class:"flex gap-2"},xw=["onClick","disabled"],Sw=["onClick","disabled"],kw=["onClick"],Aw={class:"mt-6"},Ew={key:0,class:"text-sm text-red-600 mb-2"},Cw={class:"flex gap-3"},Ow=["disabled","title"],Tw={class:"max-w-2xl mx-auto mt-6"},$w={__name:"CreateLessons",setup(t){const e=Hr(),s=z("");async function n(){try{const{data:g}=await ke.auth.getSession(),k=g?.session?.user?.email?.split("@")[0]||"user",P=new Date,R=String(P.getMonth()+1).padStart(2,"0"),S=String(P.getDate()).padStart(2,"0"),x=P.getFullYear(),j=String(P.getHours()).padStart(2,"0"),I=String(P.getMinutes()).padStart(2,"0");return`Lesson ${k} ${R}-${S}-${x} ${j}:${I}`}catch{const g=new Date,v=String(g.getMonth()+1).padStart(2,"0"),k=String(g.getDate()).padStart(2,"0"),P=g.getFullYear(),R=String(g.getHours()).padStart(2,"0"),S=String(g.getMinutes()).padStart(2,"0");return`Lesson user ${v}-${k}-${P} ${R}:${S}`}}function r(g){const v=g?.instrument;return v?typeof v=="string"?v:typeof v=="object"&&(v.instrument||v.name)||"":""}const i=ie(()=>{const g=(s.value||"").toLowerCase().trim(),v=e.availableUnits||[];return g?v.filter(k=>{const P=(k.name||"").toLowerCase(),R=(k.type||"").toLowerCase(),S=r(k).toLowerCase();return P.includes(g)||R.includes(g)||S.includes(g)}):v});ie(()=>i.value.length>0);const o=ie(()=>!!e.lessonName?.trim()&&e.selectedUnits.length>0),c=ie(()=>!e.lessonName?.trim()&&e.selectedUnits.length>0?"Enter a Lesson Name at the top of the page before saving":e.lessonName?.trim()?e.selectedUnits.length===0?"Add at least one Practice Unit to your lesson":"Save this lesson to the database":"Requires a Lesson Name and at least one Practice Unit");function l(g){return e.selectedUnits.some(v=>v.practice_unit_id===g)}function u(g){e.addUnit(g)}function d(g,v){e.moveUnit(g,v)}function f(g){e.removeUnit(g)}async function h(){try{await e.saveLesson(),alert("Lesson saved."),e.clear()}catch(g){console.error("[CreateLessons] save failed",g),alert(g?.message||"Save failed")}}function p(){e.clear()}return Ye(async()=>{const g=await n();e.lessonName=g,e.fetchPracticeUnits()}),(g,v)=>(C(),T("div",Y_,[Q(pt),a("main",X_,[v[12]||(v[12]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatCreatorPages"},[a("span",{class:"material-symbols-outlined"},"note_add"),a("span",{class:"text-2xl font-bold"},"Create Lessons")],-1)),a("div",Q_,[Q(ko,{onRetry:()=>ne(e).fetchPracticeUnits()},null,8,["onRetry"])]),a("div",Z_,[a("div",ew,[v[9]||(v[9]=a("h2",{class:"card-title mb-2"},"Create New Lesson",-1)),v[10]||(v[10]=a("div",{class:"text-sm text-gray-600 mb-4"},[a("strong",null,"How this works:"),X(" Choose a name, add practice units from the list below to build your lesson, then click "),a("strong",null,"Save Lesson to Database"),X(" at the bottom. ")],-1)),v[11]||(v[11]=a("label",{class:"label",for:"lessonName"},[a("span",{class:"label-text font-semibold"},"Lesson Name:")],-1)),ae(a("input",{id:"lessonName",type:"text",class:"input input-bordered w-full","onUpdate:modelValue":v[0]||(v[0]=k=>ne(e).lessonName=k),placeholder:"Enter lesson name"},null,512),[[$e,ne(e).lessonName]]),a("div",tw,[v[5]||(v[5]=a("div",{class:"font-semibold mb-1"},"Your Saved Practice Units:",-1)),v[6]||(v[6]=a("div",{class:"text-xs text-gray-500 mb-2"},' Click "Add" to include a unit in this lesson ',-1)),ne(e).error?(C(),T("div",sw,[a("span",null,D(ne(e).error),1),a("button",{class:"btn btn-xs ml-auto",onClick:v[1]||(v[1]=k=>ne(e).fetchPracticeUnits())}," Retry ")])):me("",!0),a("div",nw,[ae(a("input",{type:"text","onUpdate:modelValue":v[2]||(v[2]=k=>s.value=k),class:"input input-bordered w-full mb-2",placeholder:"Filter by name, type, instrument"},null,512),[[$e,s.value]])]),a("div",rw,[ne(e).loading?(C(),T("div",iw,[...v[3]||(v[3]=[a("span",{class:"loading loading-spinner loading-md"},null,-1),a("span",{class:"ml-2"},"Loading practice units",-1)])])):i.value.length===0?(C(),T("div",ow," No Practice Units found. ")):(C(),T("ul",aw,[(C(!0),T(Re,null,st(i.value,k=>(C(),T("li",{key:k.practice_unit_id},[a("div",{class:"flex items-center justify-between w-full p-2 rounded border",style:as(l(k.practice_unit_id)?"background-color: #fef3c7; border-color: #fcd34d;":"background-color: white; border-color: #e5e7eb;")},[a("div",lw,[a("span",cw,D(k.type),1),a("span",uw,D(k.name),1),r(k)?(C(),T("span",dw," "+D(r(k)),1)):me("",!0)]),a("button",{class:"btn btn-sm btn-circle",onClick:P=>u(k),title:l(k.practice_unit_id)?"Already in lesson":"Add to lesson"},[...v[4]||(v[4]=[a("span",{class:"material-symbols-outlined text-base"},"add",-1)])],8,fw)],4)]))),128))]))])]),a("div",hw,[v[7]||(v[7]=a("div",{class:"font-semibold mb-2"},"  Working Lesson (not saved yet): ",-1)),v[8]||(v[8]=a("div",{class:"text-xs text-gray-600 mb-2"},' These units will be included when you click "Save Lesson to Database" below ',-1)),ne(e).selectedUnits.length===0?(C(),T("div",pw," (empty - add units from the list above) ")):(C(),T("ul",mw,[(C(!0),T(Re,null,st(ne(e).selectedUnits,(k,P)=>(C(),T("li",{key:k.practice_unit_id,class:"flex items-center justify-between p-2 rounded bg-white border border-gray-200"},[a("div",gw,[a("span",vw,D(P+1),1),a("span",yw,D(k.type),1),a("span",bw,D(k.name),1),r(k)?(C(),T("span",_w," "+D(r(k)),1)):me("",!0)]),a("div",ww,[a("button",{class:"btn btn-xs",onClick:R=>d(P,P-1),disabled:P===0},"  ",8,xw),a("button",{class:"btn btn-xs",onClick:R=>d(P,P+1),disabled:P===ne(e).selectedUnits.length-1},"  ",8,Sw),a("button",{class:"btn btn-xs btn-error",onClick:R=>f(k.practice_unit_id)}," Remove ",8,kw)])]))),128))]))]),a("div",Aw,[ne(e).selectedUnits.length>0&&!ne(e).lessonName?.trim()?(C(),T("div",Ew,"  Enter a Lesson Name above before saving ")):me("",!0),a("div",Cw,[a("button",{class:"btn btn-success",onClick:h,disabled:!o.value,title:c.value},"  Save Lesson to Database ",8,Ow),a("button",{class:"btn",onClick:p}," Clear & Start Over ")])])])]),a("div",Tw,[Q(Ao)])]),Q(_t)]))}},Pw={},Rw={class:"bg-base-200 flex flex-col min-h-screen"},Uw={class:"container mx-auto p-4 flex-1"},jw={class:"max-w-3xl mx-auto text-base text-gray-800 space-y-4"},Iw={class:"space-y-2"},Nw={class:"collapse-content"},Dw={id:"feature-list",class:"list-disc pl-5 text-sm text-gray-700"},Lw={key:0,class:"text-sm text-gray-500"},Fw={class:"ml-2 text-gray-600"},Mw={class:"mt-3"},Bw={class:"collapse-content text-sm text-gray-700"},Vw={id:"change-list",class:"list-disc pl-5"},Hw={key:0,class:"text-sm text-gray-500"},qw={class:"text-gray-500"},Gw={class:"collapse-content text-sm text-gray-700"},Kw={id:"ack-list",class:"list-disc pl-5 mt-2"},Ww={key:0,class:"text-sm text-gray-500"},Jw={key:0},zw=["href"],Yw={key:1},Xw={key:2,class:"mt-1"},Qw={class:"list-disc pl-5 text-sm"},Zw=["href"],e0={__name:"About",setup(t){const e=z([]),s=z([]),n=z([]),r=$t({overview:!1,core:!1,contributors:!1,programmed:!1,docs:!1,pipeline:!1,changelog:!1,ack:!1});function i(d){Object.prototype.hasOwnProperty.call(r,d)&&(r[d]=!r[d])}function o(d){try{return new Date(d).toLocaleString()}catch{return d}}function c(d){const f=typeof import.meta<"u"&&Pw?"/alpha-vue-SPA/":"/";return(f.endsWith("/")?f:f+"/")+"data/"+d}async function l(d,f,h){try{const p=c(d),g=await fetch(p);if(!g.ok){console.warn(`Failed to fetch ${p}: ${g.status}`),f.value=[];return}const v=await g.json();h?f.value=Array.isArray(v[h])?v[h]:[]:f.value=Array.isArray(v)?v:[]}catch(p){console.error(`Failed loading ${d}:`,p),f.value=[]}}Ye(async()=>{await Promise.all([l("feature-pipeline.json",e,"features"),l("change-log.json",s,"changes"),l("ack.json",n,"tools")])});function u(d){try{const f=window.open(d,"_blank");if(f)try{f.opener=null}catch{}else window.location.href=d}catch(f){console.error("Failed to open external link",f),window.location.href=d}}return(d,f)=>(C(),T("div",Rw,[Q(pt),a("main",Uw,[f[33]||(f[33]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatAboutPages"},[a("span",{class:"material-symbols-outlined"},"info"),a("span",{class:"text-2xl font-bold"},"About")],-1)),a("div",jw,[a("div",Iw,[a("div",{class:it(["collapse border rounded",{"collapse-open":r.overview}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[0]||(f[0]=h=>i("overview")),onKeydown:[f[1]||(f[1]=at(Ze(h=>i("overview"),["prevent"]),["enter"])),f[2]||(f[2]=at(Ze(h=>i("overview"),["prevent"]),["space"]))]},"Overview",32),f[26]||(f[26]=a("div",{class:"collapse-content"},[a("div",{class:"mb-3"},[a("div",{class:"bg-yellow-50 border-l-4 border-yellow-300 px-3 py-2 text-sm text-yellow-800 rounded"}," This is an alpha version of the Euphonium Tutor App  content and UI may change. ")]),a("p",{class:"leading-relaxed text-sm"}," The Euphonium Tutor App helps euphonium players improve technique, track progress, and explore practice material. It combines interactive tools, audio feedback, and modular extensions to support learners at different levels. ")],-1))],2),a("div",{class:it(["collapse border rounded",{"collapse-open":r.core}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[3]||(f[3]=h=>i("core")),onKeydown:[f[4]||(f[4]=at(Ze(h=>i("core"),["prevent"]),["enter"])),f[5]||(f[5]=at(Ze(h=>i("core"),["prevent"]),["space"]))]}," Core Features",32),f[27]||(f[27]=a("div",{class:"collapse-content"},[a("ul",{class:"list-disc pl-5 space-y-1 text-sm"},[a("li",null,"Interactive fingering chart with visual feedback"),a("li",null,"Real-time pitch analysis using Tone.js"),a("li",null,"Practice streak and progress tracking"),a("li",null,"Speech synthesis for spoken instructions"),a("li",null,"Modular extension tracker and change-log")])],-1))],2),a("div",{class:it(["collapse border rounded",{"collapse-open":r.contributors}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[6]||(f[6]=h=>i("contributors")),onKeydown:[f[7]||(f[7]=at(Ze(h=>i("contributors"),["prevent"]),["enter"])),f[8]||(f[8]=at(Ze(h=>i("contributors"),["prevent"]),["space"]))]}," Contributors",32),f[28]||(f[28]=a("div",{class:"collapse-content"},[a("p",{class:"text-sm"},"Content contributed by: Dan Garlen, Michael Fahrner, and AI assistants.")],-1))],2),a("div",{class:it(["collapse border rounded",{"collapse-open":r.programmed}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[9]||(f[9]=h=>i("programmed")),onKeydown:[f[10]||(f[10]=at(Ze(h=>i("programmed"),["prevent"]),["enter"])),f[11]||(f[11]=at(Ze(h=>i("programmed"),["prevent"]),["space"]))]}," Programmed By",32),f[29]||(f[29]=a("div",{class:"collapse-content"},[a("p",{class:"text-sm"},"Author: Dan Garlen and supporting AI/automation tools.")],-1))],2),a("div",{class:it(["collapse border rounded",{"collapse-open":r.docs}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[12]||(f[12]=h=>i("docs")),onKeydown:[f[13]||(f[13]=at(Ze(h=>i("docs"),["prevent"]),["enter"])),f[14]||(f[14]=at(Ze(h=>i("docs"),["prevent"]),["space"]))]}," Documentation",32),f[30]||(f[30]=a("div",{class:"collapse-content"},[a("div",{class:"space-y-2 text-sm"},[a("p",null,[a("a",{href:"http://EuphoniumTutorDocs.garlen.net",target:"_blank",class:"link link-primary"},"Euphonium Tutor Docs")]),a("p",null,[a("a",{href:"/prototype/cmtDocs.html",class:"link"},"Compact Music Token (CMT) Format Documentation")])])],-1))],2),a("div",{class:it(["collapse border rounded",{"collapse-open":r.pipeline}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[15]||(f[15]=h=>i("pipeline")),onKeydown:[f[16]||(f[16]=at(Ze(h=>i("pipeline"),["prevent"]),["enter"])),f[17]||(f[17]=at(Ze(h=>i("pipeline"),["prevent"]),["space"]))]},"Feature Pipeline / Wish List",32),a("div",Nw,[a("ul",Dw,[e.value.length?me("",!0):(C(),T("li",Lw,"Loading features...")),(C(!0),T(Re,null,st(e.value,h=>(C(),T("li",{key:h.title,class:it(["mb-2 p-2 rounded",{"bg-yellow-50 border border-yellow-300":h.status==="Active"}])},[a("strong",null,D(h.title),1),X(": "+D(h.description)+" ",1),a("em",Fw,"["+D(h.status)+"]",1)],2))),128))]),a("div",Mw,[a("a",{class:"btn btn-outline btn-sm mr-2",href:"https://musictutor.studio/prototype/",target:"_blank",rel:"noopener noreferrer",onClick:f[18]||(f[18]=Ze(h=>u("https://musictutor.studio/prototype/"),["stop","prevent"]))},"[Version: Prototype]"),a("a",{class:"btn btn-primary btn-sm",href:"https://musictutor.studio/alpha/",target:"_blank",rel:"noopener noreferrer",onClick:f[19]||(f[19]=Ze(h=>u("https://musictutor.studio/alpha/"),["stop","prevent"]))},"[Version: Alpha]")])])],2),a("div",{class:it(["collapse border rounded",{"collapse-open":r.changelog}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[20]||(f[20]=h=>i("changelog")),onKeydown:[f[21]||(f[21]=at(Ze(h=>i("changelog"),["prevent"]),["enter"])),f[22]||(f[22]=at(Ze(h=>i("changelog"),["prevent"]),["space"]))]},"Change Log",32),a("div",Bw,[a("ul",Vw,[s.value.length?me("",!0):(C(),T("li",Hw,"Loading change log...")),(C(!0),T(Re,null,st(s.value,h=>(C(),T("li",{key:h.timestamp,class:"mb-2"},[a("strong",null,D(h.file),1),X(": "+D(h.change)+" ",1),a("em",qw,"["+D(o(h.timestamp))+"]",1)]))),128))])])],2),a("div",{class:it(["collapse border rounded",{"collapse-open":r.ack}])},[a("div",{class:"collapse-title text-lg font-semibold",role:"button",tabindex:"0",onClick:f[23]||(f[23]=h=>i("ack")),onKeydown:[f[24]||(f[24]=at(Ze(h=>i("ack"),["prevent"]),["enter"])),f[25]||(f[25]=at(Ze(h=>i("ack"),["prevent"]),["space"]))]},"Acknowledgements",32),a("div",Gw,[f[32]||(f[32]=a("p",null,"Thanks to open-source libraries and community contributors.",-1)),a("ul",Kw,[n.value.length?me("",!0):(C(),T("li",Ww,"Loading acknowledgements...")),(C(!0),T(Re,null,st(n.value,h=>(C(),T("li",{key:h.name,class:"mb-2"},[h.homepage?(C(),T("span",Jw,[a("a",{href:h.homepage,target:"_blank",rel:"noopener noreferrer",class:"text-blue-700 font-semibold hover:underline"},D(h.name),9,zw)])):(C(),T("span",Yw,[a("strong",null,D(h.name),1)])),f[31]||(f[31]=X(" by ",-1)),a("em",null,D(h.publisher),1),X(": "+D(h.description)+" ",1),h.links&&h.links.length?(C(),T("div",Xw,[a("ul",Qw,[(C(!0),T(Re,null,st(h.links,(p,g)=>(C(),T("li",{key:g},[a("a",{href:p,target:"_blank",rel:"noopener noreferrer",class:"text-blue-600 hover:underline"},D(p),9,Zw)]))),128))])])):me("",!0)]))),128))])])],2)])])]),Q(_t)]))}},t0={class:"bg-base-200 flex flex-col min-h-screen"},s0={class:"container mx-auto p-4 flex-1"},n0={class:"collapse collapse-arrow bg-base-100 border border-base-300 mb-6 rounded-xl"},r0={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex items-center justify-between w-full"},i0={class:"text-xs text-gray-500"},o0={key:0},a0={class:"collapse-content px-4 pb-4 space-y-4"},l0={key:0,class:"p-3 border border-warning rounded bg-warning/10"},c0={class:"form-control w-full max-w-xs"},u0={class:"form-control w-full max-w-xs"},d0={class:"mt-2 flex gap-2"},f0={class:"form-control w-full max-w-xs"},h0={class:"form-control w-full max-w-xs"},p0={class:"relative"},m0=["type"],g0=["aria-label"],v0={class:"material-symbols-outlined text-base"},y0={class:"flex gap-2"},b0={class:"mt-4"},_0={class:"flex items-center gap-6 text-sm"},w0={class:"flex items-center gap-1 cursor-pointer"},x0={class:"flex items-center gap-1 cursor-pointer"},S0={key:0,class:"text-xs text-gray-500 mt-1"},k0={key:1,class:"text-xs text-gray-500 mt-1"},A0={id:"user-message",class:"text-sm mt-2"},E0={class:"mb-4"},C0={__name:"Preferences",setup(t){const e=z(""),s=z(""),n=z(""),r=z(""),i=z(""),o=z(!1),c=z(""),l=z(""),u=z("private"),d=z(!1);z(!1),z(!1);async function f(){if(n.value="",!e.value||!s.value){n.value="Enter email + password first.";return}try{const{error:S,data:x}=await ke.auth.signUp({email:e.value,password:s.value});S?n.value=`Signup failed: ${S.message}`:(n.value=x?.user?.confirmed_at?"Account created and confirmed.":"Signup requested. Check your email for confirmation link.",r.value=x?.user?.id||r.value)}catch(S){n.value="Unexpected signup error.",console.warn("[Preferences] handleSignup error",S)}}async function h(){if(n.value="",!e.value||!s.value){n.value="Enter email + password first.";return}try{const{error:S,data:x}=await ke.auth.signInWithPassword({email:e.value,password:s.value});S?n.value=`Login failed: ${S.message}`:(n.value=`Logged in as ${x?.user?.email}.`,r.value=x?.user?.id||r.value,i.value=x?.user?.email||i.value)}catch(S){n.value="Unexpected login error.",console.warn("[Preferences] handleLogin error",S)}}async function p(){try{const{error:S}=await ke.auth.signOut();S?n.value=`Logout failed: ${S.message}`:(n.value="Logged out.",r.value="",i.value="",v.practiceUnitHeader.User="")}catch(S){n.value="Unexpected logout error.",console.warn("[Preferences] handleLogout error",S)}}async function g(){n.value="";const S=(e.value||"").trim();if(!S){n.value="Enter email then tap 'Forgot password?'.";return}try{const{error:x}=await ke.auth.resetPasswordForEmail(S,{redirectTo:`${location.origin}/alpha-vue-SPA/#/preferences`});x?n.value=`Reset failed: ${x.message}`:n.value="Reset link sent. Check your email."}catch(x){n.value="Unexpected reset error.",console.warn("[Preferences] handleForgotPassword error",x)}}const v=ds();Ye(()=>{(!v.instruments||v.instruments.length===0)&&v.loadInstruments();const S=R("instrument");if(S&&!v.instrument&&v.instruments?.length){const j=v.instruments.find(I=>I.instrument===S);j&&(v.instrument=j)}ke.auth.getSession().then(({data:j})=>{r.value=j?.session?.user?.id||"",i.value=j?.session?.user?.email||""});const{data:x}=ke.auth.onAuthStateChange((j,I)=>{r.value=I?.user?.id||"",i.value=I?.user?.email||"",j==="PASSWORD_RECOVERY"&&(o.value=!0,n.value="Password recovery link verified. Please set a new password below."),I?.user?.id&&(v.practiceUnitHeader.User=I.user.id)});io(()=>{try{x.subscription?.unsubscribe?.()}catch{}})}),Ye(()=>{v.practiceUnitHeader.shareMusic===!0&&(u.value="share")}),qe(u,S=>{const x=S==="share";v.practiceUnitHeader.shareMusic=x}),Ye(()=>{r.value&&(v.practiceUnitHeader.User=r.value)});async function k(){if(n.value="",!c.value||c.value!==l.value){n.value="Passwords must match.";return}try{const{error:S}=await ke.auth.updateUser({password:c.value});S?n.value=`Failed to update password: ${S.message}`:(n.value="Password updated. You can now log in.",o.value=!1,c.value="",l.value="")}catch(S){n.value="Unexpected error updating password.",console.warn("[Preferences] handleApplyNewPassword error",S)}}function P(){if(!v.instrument){alert("Please select an instrument before saving.");return}const S=v.instrument.instrument||"",x=3600*24*365;document.cookie=`instrument=${encodeURIComponent(S)}; path=/; max-age=${x}`,alert(`Preferences saved. Instrument set to: ${S}`)}function R(S){const x=document.cookie.match(new RegExp("(?:^|; )"+S.replace(/([.$?*|{}()\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return x?decodeURIComponent(x[1]):""}return(S,x)=>(C(),T("div",t0,[Q(pt),a("main",s0,[x[20]||(x[20]=a("div",{class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatPreferencePages"},[a("span",{class:"material-symbols-outlined icon"},"settings"),a("span",{class:"text-2xl font-bold"},"Preferences")],-1)),a("div",n0,[x[18]||(x[18]=a("input",{type:"checkbox",class:"peer",id:"user-collapse-toggle"},null,-1)),a("div",r0,[x[9]||(x[9]=a("div",{class:"flex items-center gap-2"},[a("span",{class:"material-symbols-outlined"},"person"),a("span",null,"User")],-1)),a("div",i0,[r.value&&r.value.length?(C(),T(Re,{key:0},[X(" ID: "+D(r.value),1),i.value&&i.value.length?(C(),T("span",o0," ("+D(i.value)+")",1)):me("",!0)],64)):(C(),T(Re,{key:1},[X(" Not signed in ")],64))])]),a("div",a0,[o.value?(C(),T("div",l0,[x[12]||(x[12]=a("div",{class:"font-semibold text-warning mb-1"}," Set a new password ",-1)),a("div",c0,[x[10]||(x[10]=a("label",{class:"label",for:"new-password"},[a("span",{class:"label-text"},"New password")],-1)),ae(a("input",{id:"new-password","onUpdate:modelValue":x[0]||(x[0]=j=>c.value=j),type:"password",class:"input input-bordered w-full"},null,512),[[$e,c.value]])]),a("div",u0,[x[11]||(x[11]=a("label",{class:"label",for:"confirm-password"},[a("span",{class:"label-text"},"Confirm new password")],-1)),ae(a("input",{id:"confirm-password","onUpdate:modelValue":x[1]||(x[1]=j=>l.value=j),type:"password",class:"input input-bordered w-full"},null,512),[[$e,l.value]])]),a("div",d0,[a("button",{class:"btn btn-warning btn-sm",onClick:k}," Update Password "),a("button",{class:"btn btn-ghost btn-sm",onClick:x[2]||(x[2]=j=>o.value=!1)}," Cancel ")])])):me("",!0),a("div",f0,[x[13]||(x[13]=a("label",{class:"label",for:"user-email"},[a("span",{class:"label-text"},"Email")],-1)),ae(a("input",{id:"user-email","onUpdate:modelValue":x[3]||(x[3]=j=>e.value=j),type:"email",placeholder:"Enter your email",class:"input input-bordered w-full"},null,512),[[$e,e.value]])]),a("div",h0,[x[14]||(x[14]=a("label",{class:"label",for:"user-password"},[a("span",{class:"label-text"},"Password")],-1)),a("div",p0,[ae(a("input",{id:"user-password","onUpdate:modelValue":x[4]||(x[4]=j=>s.value=j),type:d.value?"text":"password",placeholder:"Enter your password",class:"input input-bordered w-full pr-12"},null,8,m0),[[qf,s.value]]),a("button",{type:"button",class:"absolute top-1/2 -translate-y-1/2 right-2 btn btn-xs btn-ghost","aria-label":d.value?"Hide password":"Show password",onClick:x[5]||(x[5]=j=>d.value=!d.value)},[a("span",v0,D(d.value?"visibility_off":"visibility"),1)],8,g0)])]),a("div",y0,[a("button",{id:"signup-btn",class:"btn btn-primary",onClick:f}," Create Account "),a("button",{id:"login-btn",class:"btn btn-secondary",onClick:h}," Login "),r.value?(C(),T("button",{key:0,id:"logout-btn",class:"btn btn-outline",onClick:p}," Logout ")):me("",!0),a("button",{type:"button",class:"btn btn-ghost btn-sm",onClick:g}," Forgot password? ")]),a("div",b0,[x[17]||(x[17]=a("div",{class:"font-semibold mb-1"},"Practice Privacy",-1)),a("div",_0,[a("label",w0,[ae(a("input",{type:"radio",name:"shareMusic",value:"share","onUpdate:modelValue":x[6]||(x[6]=j=>u.value=j)},null,512),[[Be,u.value]]),x[15]||(x[15]=a("span",null,"Share",-1))]),a("label",x0,[ae(a("input",{type:"radio",name:"shareMusic",value:"private","onUpdate:modelValue":x[7]||(x[7]=j=>u.value=j)},null,512),[[Be,u.value]]),x[16]||(x[16]=a("span",null,"Personal Use ONLY",-1))])]),u.value==="share"?(C(),T("div",S0," Your future practice units will be marked as shareable. ")):(C(),T("div",k0," Units will be marked private (Personal Use ONLY). "))]),a("div",A0,D(n.value),1)])]),a("div",E0,[Q(qr,{instruments:ne(v).instruments,modelValue:ne(v).instrument,"onUpdate:modelValue":x[8]||(x[8]=j=>ne(v).instrument=j)},null,8,["instruments","modelValue"])]),a("button",{id:"save-btn",class:"btn btn-active btn-success",onClick:P},[...x[19]||(x[19]=[a("span",{class:"material-symbols-outlined icon"},"save",-1),X(" Save Preferences ",-1)])])]),Q(_t)]))}},O0={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4"},T0={class:"collapse-title font-bold text-lg px-4 flex justify-between items-center"},$0={key:0,class:"text-right text-base font-normal text-gray-600"},P0={class:"collapse-content flex flex-row gap-8 px-4"},R0={class:"flex items-center gap-3"},U0=["value"],j0={class:"flex gap-4"},I0={class:"flex items-center gap-2 cursor-pointer"},N0={class:"flex items-center gap-2 cursor-pointer"},D0={class:"flex items-center gap-2 cursor-pointer"},L0={__name:"CreateScale-ScaleSelector",props:{scaleSelections:{type:Object,default:()=>({key:"",scaleType:""})}},emits:["update:scaleSelections"],setup(t,{emit:e}){function s(c){return c?c.charAt(0).toUpperCase()+c.slice(1):""}const n=t,r=e,i=ie({get:()=>n.scaleSelections,set:c=>r("update:scaleSelections",c)}),o=z({});return Ye(async()=>{try{const c=await fetch("/alpha-vue-SPA/data/scaleKeys.json");if(!c.ok)throw new Error("Failed to load scaleKeys.json");o.value=await c.json()}catch(c){console.error("ScaleKeys fetch error:",c)}}),(c,l)=>(C(),T("div",O0,[l[11]||(l[11]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",T0,[l[4]||(l[4]=a("span",null,"Scale Selector",-1)),i.value.key&&i.value.scaleType?(C(),T("span",$0,D(i.value.key)+" "+D(s(i.value.scaleType))+" Scale ",1)):me("",!0)]),a("div",P0,[a("div",R0,[l[8]||(l[8]=a("label",{for:"root-note",class:"font-semibold w-32"},"Key:",-1)),ae(a("select",{id:"root-note",class:"flex-1 p-2 border rounded bg-white text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":l[0]||(l[0]=u=>i.value.key=u)},[(C(!0),T(Re,null,st(o.value,(u,d)=>(C(),T("option",{key:d,value:d},D(u),9,U0))),128))],512),[[As,i.value.key]]),l[9]||(l[9]=a("span",{style:{display:"inline-block",width:"2em"}},"",-1)),l[10]||(l[10]=a("span",{class:"font-semibold w-32"},"Scale Type:",-1)),a("div",j0,[a("label",I0,[ae(a("input",{type:"radio",name:"scale-type",value:"major",class:"radio radio-primary","onUpdate:modelValue":l[1]||(l[1]=u=>i.value.scaleType=u)},null,512),[[Be,i.value.scaleType]]),l[5]||(l[5]=a("span",null,"Major",-1))]),a("label",N0,[ae(a("input",{type:"radio",name:"scale-type",value:"minor",class:"radio radio-primary","onUpdate:modelValue":l[2]||(l[2]=u=>i.value.scaleType=u)},null,512),[[Be,i.value.scaleType]]),l[6]||(l[6]=a("span",null,"Minor",-1))]),a("label",D0,[ae(a("input",{type:"radio",name:"scale-type",value:"chromatic",class:"radio radio-primary","onUpdate:modelValue":l[3]||(l[3]=u=>i.value.scaleType=u)},null,512),[[Be,i.value.scaleType]]),l[7]||(l[7]=a("span",null,"Chromatic",-1))])])])])]))}},F0={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4"},M0={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},B0={key:0,class:"text-right text-base font-normal text-gray-600"},V0={class:"collapse-content flex flex-col gap-6 px-4"},H0={class:"border border-gray-300 rounded p-4"},q0={class:"flex flex-row gap-8 items-center"},G0={class:"flex items-center gap-3"},K0={id:"starting-octave-label",class:"px-4 py-1 border rounded bg-white text-gray-800 font-mono text-xl font-bold"},W0={class:"flex items-center gap-3"},J0={id:"octave-count-label",class:"px-4 py-1 border rounded bg-white text-gray-800 font-mono text-xl font-bold"},z0={class:"flex items-center gap-3"},Y0={id:"max-measures-per-line",class:"px-4 py-1 border rounded bg-white text-gray-800 font-mono text-xl font-bold"},X0={__name:"CreateScale-ScaleRange",props:{scaleSelections:{type:Object,default:()=>({key:"C",scaleType:"major",startingOctave:"C4",octaveCount:1,maxMeasuresPerLine:2,direction:"Ascending",noteDuration:"quarter",staffOptions:{keySignature:!0,accidentals:!0,barLines:!0,timeSignature:!0,accidentalFamily:"auto-key"}})}},emits:["update:scaleSelections"],setup(t,{emit:e}){const s=t,n=e,r=ie({get:()=>s.scaleSelections,set:c=>n("update:scaleSelections",c)});function i(c){const l=c.match(/^([A-G]#?)(\d)$/);return l?`${l[1]}${Number.parseInt(l[2])+1}`:c}function o(c){const l=c.match(/^([A-G]#?)(\d)$/);return l?`${l[1]}${Math.max(1,Number.parseInt(l[2])-1)}`:c}return(c,l)=>(C(),T("div",F0,[l[20]||(l[20]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",M0,[l[6]||(l[6]=a("span",null,"Scale Range Settings",-1)),r.value.octaveCount&&r.value.startingOctave?(C(),T("span",B0," Scale Range: "+D(r.value.octaveCount)+" octave"+D(r.value.octaveCount>1?"s":"")+" starting at "+D(r.value.startingOctave),1)):me("",!0)]),a("div",V0,[a("fieldset",H0,[l[14]||(l[14]=a("legend",{class:"font-semibold px-2"},"Octave",-1)),a("div",q0,[a("div",G0,[l[9]||(l[9]=a("label",{for:"starting-octave-label",class:"font-semibold w-24"},"Start:",-1)),a("button",{class:"btn btn-sm btn-outline btn-primary flex items-center justify-center","aria-label":"Decrease Octave",onClick:l[0]||(l[0]=u=>r.value.startingOctave=o(r.value.startingOctave))},[...l[7]||(l[7]=[a("span",{class:"material-symbols-outlined"},"remove",-1)])]),a("span",K0,D(r.value.startingOctave),1),a("button",{class:"btn btn-sm btn-outline btn-primary flex items-center justify-center","aria-label":"Increase Octave",onClick:l[1]||(l[1]=u=>r.value.startingOctave=i(r.value.startingOctave))},[...l[8]||(l[8]=[a("span",{class:"material-symbols-outlined"},"add",-1)])]),l[10]||(l[10]=a("span",{style:{display:"inline-block",width:"2em"}},"",-1))]),a("div",W0,[l[13]||(l[13]=a("label",{for:"octave-count-label",class:"font-semibold w-24"},"Number:",-1)),a("button",{class:"btn btn-sm btn-outline btn-primary flex items-center justify-center","aria-label":"Decrease Number of Octaves",onClick:l[2]||(l[2]=u=>r.value.octaveCount=Math.max(1,r.value.octaveCount-1))},[...l[11]||(l[11]=[a("span",{class:"material-symbols-outlined"},"remove",-1)])]),a("span",J0,D(r.value.octaveCount),1),a("button",{class:"btn btn-sm btn-outline btn-primary flex items-center justify-center","aria-label":"Increase Number of Octaves",onClick:l[3]||(l[3]=u=>r.value.octaveCount=r.value.octaveCount+1)},[...l[12]||(l[12]=[a("span",{class:"material-symbols-outlined"},"add",-1)])])])])]),l[19]||(l[19]=a("div",{style:{height:"1ch"}},null,-1)),a("div",z0,[l[17]||(l[17]=a("label",{for:"max-measures-per-line",class:"font-semibold w-60"},"Max Measures/Line:",-1)),a("button",{class:"btn btn-sm btn-outline btn-primary flex items-center justify-center","aria-label":"Decrease Max Measures per Line",onClick:l[4]||(l[4]=u=>r.value.maxMeasuresPerLine=Math.max(1,(r.value.maxMeasuresPerLine||2)-1))},[...l[15]||(l[15]=[a("span",{class:"material-symbols-outlined"},"remove",-1)])]),a("span",Y0,D(r.value.maxMeasuresPerLine||2),1),a("button",{class:"btn btn-sm btn-outline btn-primary flex items-center justify-center","aria-label":"Increase Max Measures per Line",onClick:l[5]||(l[5]=u=>r.value.maxMeasuresPerLine=Math.min(4,(r.value.maxMeasuresPerLine||2)+1))},[...l[16]||(l[16]=[a("span",{class:"material-symbols-outlined"},"add",-1)])]),l[18]||(l[18]=a("span",{class:"text-sm text-gray-600"},"(14)",-1))])])]))}},Q0={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Z0={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},ex={key:0,class:"text-right text-base font-normal text-gray-600"},tx={class:"collapse-content"},sx={class:"flex items-center gap-4 mb-6"},nx={class:"flex gap-6"},rx={class:"flex items-center gap-2 cursor-pointer"},ix={class:"flex items-center gap-2 cursor-pointer"},ox={class:"flex items-center gap-2 cursor-pointer"},ax={class:"mb-6"},lx={class:"flex gap-6 flex-nowrap"},cx={class:"flex items-center gap-2 cursor-pointer"},ux={class:"flex items-center gap-2 cursor-pointer"},dx={class:"flex items-center gap-2 cursor-pointer"},fx={class:"flex items-center gap-2 cursor-pointer"},hx={class:"mb-3"},px={class:"flex items-center gap-4"},mx={class:"flex items-center gap-4"},gx={__name:"CreateScale-ScaleDurationDirection",props:{scaleSelections:{type:Object,default:()=>({key:"C",scaleType:"major",startingOctave:"C4",octaveCount:1,direction:"Ascending",noteDuration:"quarter",timeSignature:"4/4",staffOptions:{keySignature:!0,accidentals:!0,barLines:!0,timeSignature:!0,accidentalFamily:"auto-key"}})}},emits:["update:scaleSelections"],setup(t,{emit:e}){function s(o){switch(o){case"eighth":return"Eighth Note";case"quarter":return"Quarter Note";case"half":return"Half Note";case"whole":return"Whole Note";default:return""}}const n=t,r=e,i=ie({get:()=>n.scaleSelections,set:o=>r("update:scaleSelections",o)});return(o,c)=>(C(),T("div",Q0,[c[21]||(c[21]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",Z0,[c[8]||(c[8]=a("span",null,"Duration & Direction",-1)),i.value.direction&&i.value.noteDuration?(C(),T("span",ex,D(i.value.direction)+" "+D(s(i.value.noteDuration))+" Scale ",1)):me("",!0)]),a("div",tx,[a("div",sx,[c[12]||(c[12]=a("label",{class:"font-semibold w-32"},"Direction:",-1)),a("div",nx,[a("label",rx,[ae(a("input",{type:"radio",name:"direction",value:"Ascending",class:"radio radio-primary","onUpdate:modelValue":c[0]||(c[0]=l=>i.value.direction=l)},null,512),[[Be,i.value.direction]]),c[9]||(c[9]=a("span",null," Ascending",-1))]),a("label",ix,[ae(a("input",{type:"radio",name:"direction",value:"Descending",class:"radio radio-primary","onUpdate:modelValue":c[1]||(c[1]=l=>i.value.direction=l)},null,512),[[Be,i.value.direction]]),c[10]||(c[10]=a("span",null," Descending",-1))]),a("label",ox,[ae(a("input",{type:"radio",name:"direction",value:"Both",class:"radio radio-primary","onUpdate:modelValue":c[2]||(c[2]=l=>i.value.direction=l)},null,512),[[Be,i.value.direction]]),c[11]||(c[11]=a("span",null," Ascending & Descending",-1))])])]),a("div",ax,[c[17]||(c[17]=a("div",{class:"font-semibold mb-2"},"Note Duration:",-1)),a("div",lx,[a("label",cx,[ae(a("input",{type:"radio",name:"note-duration",value:"eighth",class:"radio radio-primary","onUpdate:modelValue":c[3]||(c[3]=l=>i.value.noteDuration=l)},null,512),[[Be,i.value.noteDuration]]),c[13]||(c[13]=a("span",null,"Eighth Notes",-1))]),a("label",ux,[ae(a("input",{type:"radio",name:"note-duration",value:"quarter",class:"radio radio-primary","onUpdate:modelValue":c[4]||(c[4]=l=>i.value.noteDuration=l)},null,512),[[Be,i.value.noteDuration]]),c[14]||(c[14]=a("span",null,"Quarter Notes",-1))]),a("label",dx,[ae(a("input",{type:"radio",name:"note-duration",value:"half",class:"radio radio-primary","onUpdate:modelValue":c[5]||(c[5]=l=>i.value.noteDuration=l)},null,512),[[Be,i.value.noteDuration]]),c[15]||(c[15]=a("span",null,"Half Notes",-1))]),a("label",fx,[ae(a("input",{type:"radio",name:"note-duration",value:"whole",class:"radio radio-primary","onUpdate:modelValue":c[6]||(c[6]=l=>i.value.noteDuration=l)},null,512),[[Be,i.value.noteDuration]]),c[16]||(c[16]=a("span",null,"Whole Notes",-1))])])]),a("div",hx,[a("div",px,[c[20]||(c[20]=a("div",{class:"font-semibold w-48"},"Time Signature:",-1)),a("div",mx,[ae(a("select",{class:"select select-bordered max-w-xs","onUpdate:modelValue":c[7]||(c[7]=l=>i.value.timeSignature=l)},[...c[18]||(c[18]=[rc('<option value="2/4">2/4</option><option value="3/4">3/4</option><option value="4/4">4/4</option><option value="6/8">6/8</option><option value="9/8">9/8</option><option value="12/8">12/8</option>',6)])],512),[[As,i.value.timeSignature]]),c[19]||(c[19]=a("span",{class:"text-sm text-gray-600"},"Used by staff preview and export",-1))])])])])]))}},vx={class:"bg-base-200 flex flex-col min-h-screen"},yx={class:"container mx-auto p-4 flex-1"},bx={class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatCreatorPages"},_x={class:"text-2xl font-bold"},wx={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},xx={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},Sx={class:"text-right text-base font-normal text-gray-600"},kx={class:"collapse-content px-4"},Ax={class:"mb-4"},Ex={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mt-4 rounded-xl"},Cx={class:"collapse-content px-4"},Ox={class:"bg-base-100 p-4 rounded text-xs overflow-x-auto max-h-96"},Tx={style:{"max-width":"400px",margin:"2em auto"}},tl="mts.staffOptions",$x={__name:"CreateScaleView",setup(t){function e(){console.log("function copyScaleSPN called.");const p=s.noteArray&&s.noteArray.length>0?s.noteArray.map(g=>g.pitch).join(", "):"";console.log("[Copy Scale SPN] noteArray:",s.noteArray),console.log("[Copy Scale SPN] spnArray:",p),p?navigator.clipboard.writeText(p).then(()=>{console.log("[Copy Scale SPN] Clipboard write succeeded.")}).catch(g=>{console.error("[Copy Scale SPN] Clipboard write failed:",g),alert("Failed to copy scale SPN.")}):(console.warn("[Copy Scale SPN] No scale generated to copy."),alert("No scale generated to copy."))}const s=ds();z(!1);const n=z([]);z(!1);const r=z("");ie(()=>{const p=(r.value||"").trim().toLowerCase(),g=n.value||[];return p?g.filter(v=>{try{const k=v?.unit_json?.practiceUnitHeader||{},P=k?.instrument?.instrument||k?.instrument||"";return[v?.name,v?.type,k?.keySignature,k?.contentType,k?.startingOctave,String(k?.numberOfOctaves||""),k?.direction,P].filter(Boolean).map(S=>String(S).toLowerCase()).some(S=>S.includes(p))}catch{return!1}}):g}),s.scaleSelections||(s.scaleSelections=$t({key:s.practiceUnitHeader.keySignature||"C",scaleType:s.practiceUnitHeader.contentType||"Major",startingOctave:s.practiceUnitHeader.startingOctave||"C4",octaveCount:s.practiceUnitHeader.numberOfOctaves||1,maxMeasuresPerLine:s.practiceUnitHeader.staffDisplayOptions?.measuresPerLineMax||2,direction:s.practiceUnitHeader.direction||"ascending",noteDuration:"quarter",timeSignature:s.practiceUnitHeader.timeSignature||"4/4",staffOptions:{keySignature:!0,accidentals:!0,barLines:!0,timeSignature:!0,measuresPerLineMax:s.practiceUnitHeader.staffDisplayOptions?.measuresPerLineMax||2,enforceLedgerLimits:!1,accidentalFamily:"auto-key",...s.practiceUnitHeader.staffDisplayOptions}})),qe(()=>s.scaleSelections,p=>{p&&(s.practiceUnitHeader.keySignature=p.key||"C",s.practiceUnitHeader.contentType=p.scaleType||"Major",s.practiceUnitHeader.startingOctave=p.startingOctave||"C4",s.practiceUnitHeader.numberOfOctaves=p.octaveCount||1,s.practiceUnitHeader.direction=p.direction||"ascending",s.practiceUnitHeader.timeSignature=p.timeSignature||"4/4",p.staffOptions&&(s.practiceUnitHeader.staffDisplayOptions={...p.staffOptions}))},{deep:!0,immediate:!0});const i=z("Not yet saved");let o=null;function c(){i.value=`${s.scaleSelections.key} ${s.scaleSelections.scaleType} Scale`,s.noteArray=[];const p=Zt();p.noteArray=[];const g=s.scaleSelections,v=g.scaleType||"major",k=g.key||"C";let P=g.startingOctave||"C4";const R=g.octaveCount||1,S=g.direction||"Ascending",x=g.noteDuration||"quarter",j=g.staffOptions?.accidentalFamily||"auto-key",I={"F#":["F#","G#","A#","B","C#","D#","E#"],"C#":["C#","D#","E#","F#","G#","A#","B#"],Gb:["Gb","Ab","Bb","Cb","Db","Eb","F"],Db:["Db","Eb","F","Gb","Ab","Bb","C"],Ab:["Ab","Bb","C","Db","Eb","F","G"],Eb:["Eb","F","G","Ab","Bb","C","D"],Bb:["Bb","C","D","Eb","F","G","A"],F:["F","G","A","Bb","C","D","E"],C:["C","D","E","F","G","A","B"],G:["G","A","B","C","D","E","F#"],D:["D","E","F#","G","A","B","C#"],A:["A","B","C#","D","E","F#","G#"],E:["E","F#","G#","A","B","C#","D#"],B:["B","C#","D#","E","F#","G#","A#"],C_minor:["C","D","Eb","F","G","Ab","Bb"],G_minor:["G","A","Bb","C","D","Eb","F"],D_minor:["D","E","F","G","A","Bb","C"],A_minor:["A","B","C","D","E","F","G"],E_minor:["E","F#","G","A","B","C","D"],B_minor:["B","C#","D","E","F#","G","A"],"F#_minor":["F#","G#","A","B","C#","D","E"],"C#_minor":["C#","D#","E","F#","G#","A","B"],F_minor:["F","G","Ab","Bb","C","Db","Eb"],Bb_minor:["Bb","C","Db","Eb","F","Gb","Ab"],Eb_minor:["Eb","F","Gb","Ab","Bb","Cb","Db"],Ab_minor:["Ab","Bb","Cb","Db","Eb","Fb","Gb"]};function _(re){if(window.spnToMidi)return window.spnToMidi(re);const we=re.match(/^([A-G][#b]?)(\d)$/);if(!we)return 60;const Ee={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11},_e=we[1];return 12*(parseInt(we[2])+1)+(Ee[_e]??0)}function U(re){if(window.midiToSpn)return window.midiToSpn(re);const we=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Ee=Math.floor(re/12)-1;return`${we[re%12]}/${Ee}`}function B(re){const we=["C","G","D","A","E","B","F#","C#"];return["F","Bb","Eb","Ab","Db","Gb","Cb"].includes(re)?"flats":we.includes(re)?"sharps":{"A#":"sharps","D#":"sharps","G#":"sharps"}[re]||"sharps"}function G(re,we){const Ee=re.match(/^([A-G][#b]{0,2})(\d+)$/);if(!Ee)return re;const[,_e,Te]=Ee,Ue=parseInt(Te,10);function Z(N,A,m){return(N==="B#"||N==="B##")&&A.startsWith("C")?m+1:(N==="Cb"||N==="Cbb")&&A.startsWith("B")?m-1:m}if(we==="flats"){const N={"C#":"Db","C##":"D","B#":"C","B##":"C#","D#":"Eb","D##":"E","E#":"F","E##":"F#","F#":"Gb","F##":"G","G#":"Ab","G##":"A","A#":"Bb","A##":"B"},A={Cb:"B",Fb:"E",Ebb:"D",Bbb:"A"},m=N[_e]||A[_e]||_e,$=Z(_e,m,Ue);return m+$}else if(we==="sharps"){const N={Db:"C#",Dbb:"C",Eb:"D#",Ebb:"D",Fb:"E",Gb:"F#",Gbb:"F",Ab:"G#",Abb:"G",Bb:"A#",Bbb:"A",Cb:"B","E#":"F","B#":"C"},A={"C##":"D","D##":"E","F##":"G","G##":"A","A##":"B"},m=N[_e]||A[_e]||_e,$=Z(_e,m,Ue);return m+$}return re}function K(re,we,Ee,_e){const Te=["C","D","E","F","G","A","B"],Ue=re.charAt(0),Z=Te.indexOf(Ue);if(!{C:{sharps:0,flats:0,family:"natural"},G:{sharps:1,flats:0,family:"sharps"},D:{sharps:2,flats:0,family:"sharps"},A:{sharps:3,flats:0,family:"sharps"},E:{sharps:4,flats:0,family:"sharps"},B:{sharps:5,flats:0,family:"sharps"},"F#":{sharps:6,flats:0,family:"sharps"},"C#":{sharps:7,flats:0,family:"sharps"},F:{sharps:0,flats:1,family:"flats"},Bb:{sharps:0,flats:2,family:"flats"},Eb:{sharps:0,flats:3,family:"flats"},Ab:{sharps:0,flats:4,family:"flats"},Db:{sharps:0,flats:5,family:"flats"},Gb:{sharps:0,flats:6,family:"flats"},Cb:{sharps:0,flats:7,family:"flats"}}[re])return ce(re,we,Ee,_e);const m=[];for(let te=0;te<_e;te++){const le=parseInt(Ee.replace(/^[A-G][b#]?/,""))+te;for(let b=0;b<7;b++){const w=(Z+b)%7,O=Te[w],M=J(O,re,b);let V=le;b>0&&w<Z&&V++;const H=O+M+V;m.push(H)}}const $=Te[Z],q=J($,re,0);return m.push($+q+(parseInt(Ee.replace(/^[A-G][b#]?/,""))+_e)),m}function J(re,we,Ee,_e){const Ue=I[we]?.[Ee];return Ue&&Ue.charAt(0)===re?Ue.substring(1):""}function ce(re,we,Ee,_e){let Ue=_(`${k}/${parseInt(Ee.replace(/^[A-G][b#]?/,""))}`);const Z=[];Z.push(`${re}${parseInt(Ee.replace(/^[A-G][b#]?/,""))}`);const N=_e*we.length;for(let A=0;A<N;A++){const m=A%we.length;Ue+=we[m];const $=U(Ue);Z.push($.replace("/",""))}return Z}let ge=[];if(v==="chromatic"){for(let re=0;re<R;re++){const we=parseInt(P.replace(/^[A-G][b#]?/,""))+re,Ee=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];for(const _e of Ee)ge.push(`${_e}${we}`)}ge.push(`C${parseInt(P.replace(/^[A-G][b#]?/,""))+R}`)}else if(v==="minor"){let Ee=function(_e,Te,Ue,Z){const N=[],A=I[we],m=["C","D","E","F","G","A","B"],$=_e.charAt(0),q=m.indexOf($);for(let b=0;b<Z;b++){const w=Number.parseInt(Ue.replace(/^[A-G][b#]?/,""))+b;for(let O=0;O<7;O++){const M=A?A[O]:m[(q+O)%7],V=M.charAt(0),H=m.indexOf(V);let se=w;O>0&&H<q&&se++,N.push(M+se)}}const te=A?A[0]:m[q],le=Number.parseInt(Ue.replace(/^[A-G][b#]?/,""))+Z;return N.push(te+le),N};const re=[2,1,2,2,1,2,2],we=k+"_minor";ge=Ee(k,re,P,R)}else ge=K(k,[2,2,1,2,2,2,1],P,R);let Se="sharps";j==="auto-key"?Se=B(k):j==="auto-direction"?Se=S==="Descending"?"flats":"sharps":j==="force-sharps"?Se="sharps":j==="force-flats"&&(Se="flats"),j==="auto-direction"||v==="chromatic"||j.startsWith("force-")?(S==="Descending"&&ge.reverse(),ge=ge.map(re=>G(re,Se))):S==="Descending"&&ge.reverse();const Ae={quarter:"q",eighth:"e",half:"h",whole:"w"},fe=ge.map(re=>({pitch:re,duration:Ae[x]||"q",noteVisible:!0,noteColor:"black",overlay:"",overlayObject:{},rangeStatus:"within"}));s.noteArray=fe,p.noteArray=fe,e()}qe(()=>[s.scaleSelections.key,s.scaleSelections.scaleType,s.scaleSelections.startingOctave,s.scaleSelections.octaveCount,s.scaleSelections.direction,s.scaleSelections.noteDuration,s.scaleSelections.timeSignature,s.scaleSelections.staffOptions,s.instrument],()=>{i.value="Not yet saved",c()},{deep:!0}),Ye(()=>{o&&!s.instrument&&(s.instrument=o)}),qe(()=>s.instrument,p=>{p&&(o=p)}),z(null),s.scaleSelections||(s.scaleSelections=$t({key:"C",scaleType:"major",startingOctave:"C4",octaveCount:1,maxMeasuresPerLine:2,direction:"Ascending",noteDuration:"quarter",timeSignature:"4/4",staffOptions:{keySignature:!0,accidentals:!0,barLines:!0,timeSignature:!0,measuresPerLineMax:2,enforceLedgerLimits:!1,accidentalFamily:"auto-key"}}));function l(p,g){const v=s.practiceUnitHeader.instrument;if(v&&v.standardRange&&v.standardRange.start){if(v.standardRange.start.startsWith(p))return v.standardRange.start;const k=v.standardRange.start.replace(/^[A-G][b#]?/,"");return p+k}return p+"4"}Ye(()=>{try{const p=localStorage.getItem(tl);if(p){const g=JSON.parse(p);g&&typeof g=="object"&&(s.scaleSelections.staffOptions={...s.scaleSelections.staffOptions,...g})}}catch{}}),qe(()=>s.scaleSelections?.staffOptions,p=>{try{localStorage.setItem(tl,JSON.stringify(p||{}))}catch{}},{deep:!0}),qe(()=>[s.scaleSelections?.key,s.scaleSelections?.scaleType,s.practiceUnitHeader.instrument],([p,g,v])=>{p&&g?s.scaleSelections.startingOctave=l(p):v&&v.standardRange&&v.standardRange.start?s.scaleSelections.startingOctave=v.standardRange.start:s.scaleSelections.startingOctave="C4"},{immediate:!0});const u=z("");s.scaleSelections||(s.scaleSelections=$t({key:"C",scaleType:"major",startingOctave:"C4",octaveCount:1,maxMeasuresPerLine:2,direction:"Ascending",noteDuration:"quarter",timeSignature:"4/4",staffOptions:{keySignature:!0,accidentals:!0,barLines:!0,timeSignature:!0,measuresPerLineMax:2,accidentalFamily:"auto-key"}})),qe(()=>[s.scaleSelections?.key,s.scaleSelections?.scaleType,s.scaleSelections?.startingOctave,s.scaleSelections?.octaveCount,s.scaleSelections?.direction,s.practiceUnitHeader?.instrument],()=>{const p=f();u.value=p,s.practiceUnitHeader&&(s.practiceUnitHeader.practiceName=p)},{immediate:!0,deep:!1});function d(p){return!p||!p.instrument?"Unknown Instrument":p.instrument.split(",")[0].trim()}function f(){const p=s.practiceUnitHeader.instrument,g=s.scaleSelections||{},v=d(p),k=g.scaleType?g.scaleType.charAt(0).toUpperCase()+g.scaleType.slice(1):"Major";return`${g.key||"C"} ${k} Scale for ${v}`}function h(p){const g=document.cookie.split(";").map(k=>k.trim()),v=`${p}=`;for(const k of g)if(k.startsWith(v))return decodeURIComponent(k.slice(v.length));return""}return Ye(async()=>{await s.loadInstruments();try{const p=h("instrument");if(p&&!s.practiceUnitHeader.instrument&&Array.isArray(s.instruments)&&s.instruments.length){const g=s.instruments.find(v=>v.instrument===p);g&&(s.practiceUnitHeader.instrument=g)}}catch{}}),(p,g)=>(C(),T("div",vx,[Q(pt),a("main",yx,[a("div",bx,[g[6]||(g[6]=a("span",{class:"material-symbols-outlined"},"queue_music",-1)),a("span",_x,D(ne(s).title),1)]),a("div",wx,[g[8]||(g[8]=a("input",{type:"checkbox",class:"peer"},null,-1)),a("div",xx,[g[7]||(g[7]=a("span",null,"Scale Preview",-1)),a("span",Sx,D(ne(s).noteArray&&ne(s).noteArray.length>0?ne(s).noteArray.map(v=>v.pitch).join(", "):"No scale generated yet."),1)]),a("div",kx,[Q(Gn)])]),a("div",Ax,[Q(qr,{instruments:ne(s).instruments,modelValue:ne(s).practiceUnitHeader.instrument,"onUpdate:modelValue":g[0]||(g[0]=v=>ne(s).practiceUnitHeader.instrument=v)},null,8,["instruments","modelValue"])]),Q(L0,{scaleSelections:ne(s).scaleSelections,"onUpdate:scaleSelections":g[1]||(g[1]=v=>ne(s).scaleSelections=v)},null,8,["scaleSelections"]),Q(X0,{scaleSelections:ne(s).scaleSelections,"onUpdate:scaleSelections":g[2]||(g[2]=v=>ne(s).scaleSelections=v)},null,8,["scaleSelections"]),Q(gx,{scaleSelections:ne(s).scaleSelections,"onUpdate:scaleSelections":g[3]||(g[3]=v=>ne(s).scaleSelections=v)},null,8,["scaleSelections"]),Q(Su,{scaleSelections:ne(s).scaleSelections,"onUpdate:scaleSelections":g[4]||(g[4]=v=>ne(s).scaleSelections=v)},null,8,["scaleSelections"]),a("div",Ex,[g[9]||(g[9]=a("input",{type:"checkbox",class:"peer"},null,-1)),g[10]||(g[10]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Behind the Curtain: practiceUnitStore (JSON snapshot)")],-1)),a("div",Cx,[a("pre",Ox,D(JSON.stringify(ne(s).composePracticeUnit(),null,2))+`
          `,1)])])]),a("div",Tx,[a("button",{class:"mtsFormatCreatorButtons flex items-center gap-2",onClick:g[5]||(g[5]=v=>p.$router.push("/creator"))},[...g[11]||(g[11]=[a("span",{class:"material-symbols-outlined align-middle mr-2","aria-hidden":"true"},"edit_square",-1),X(" Return to Creator ",-1)])])]),Q(_t)]))}},Px={class:"bg-base-200 flex flex-col min-h-screen"},Rx={class:"container mx-auto p-4 flex-1"},Ux={class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatCreatorPages"},jx={key:0,class:"badge badge-primary ml-2"},Ix={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Nx={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},Dx={class:"text-right text-base font-normal text-gray-600"},Lx={class:"collapse-content px-4"},Fx={class:"mb-4"},Mx={class:"flex items-center gap-2 flex-wrap"},Bx={key:0},Vx={key:1},Hx={class:"ml-2 input-group input-group-sm"},qx={class:"text-sm text-gray-600 ml-4"},Gx={key:0,class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Kx={class:"collapse-content px-4 text-sm leading-7"},Wx={key:1,class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},Jx={class:"collapse-content px-4 text-sm leading-7"},zx={key:0},Yx={key:1},Xx={key:2},Qx=["href"],Zx={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},e1={class:"collapse-content px-4"},t1={class:"bg-blue-50 border border-blue-200 rounded p-3 mb-3 text-sm text-gray-700"},s1={class:"list-disc list-inside mt-1 space-y-1"},n1={key:0},r1={key:1},i1={key:0},o1={key:1},a1={class:"flex gap-4 mb-4 flex-wrap"},l1=["disabled"],c1={key:2,class:"modal modal-open"},u1={class:"modal-box max-w-2xl"},d1={class:"font-bold text-lg mb-3"},f1={class:"form-control mb-3"},h1=["placeholder"],p1={key:0,class:"flex justify-center py-8"},m1={key:1,class:"py-8 text-center text-gray-500"},g1={key:2,class:"py-8 text-center text-gray-500"},v1={key:3,class:"space-y-2 max-h-96 overflow-y-auto"},y1=["onClick"],b1={class:"card-body p-4"},_1={class:"flex justify-between items-start"},w1={class:"flex-1"},x1={class:"font-semibold"},S1={class:"text-sm text-gray-500"},k1={class:"text-xs text-gray-500 mt-1"},A1={class:"badge badge-primary"},E1={class:"modal-action"},C1={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mt-4 rounded-xl"},O1={class:"collapse-content px-4"},T1={class:"bg-base-100 p-4 rounded text-xs overflow-x-auto max-h-96"},$1={style:{"max-width":"400px",margin:"2em auto"}},P1={__name:"CreatePracticeUnitView",setup(t){const e=ds(),s=z(!1),n=z([]),r=z(!1),i=z(""),o=z(null);async function c(E){const{error:y}=await ke.from("practice_units").upsert(E,{onConflict:"practice_unit_id"});return{error:y}}async function l(E){const{error:y}=await ke.from("practice_units").insert(E);return{error:y}}Ye(async()=>{await e.loadInstruments()});const u=ie(()=>e.practiceUnitHeader?.practiceUnitType||"Scale"),d=ie(()=>{const E=e.practiceUnitHeader?.instrument||e.instrument;return E&&E.instrument||"Unknown"}),f=ie(()=>e.noteArray?.length||0),h=ie(()=>JSON.stringify({practiceUnitHeader:e.practiceUnitHeader,noteArray:e.noteArray},null,2)),p=z(!1),g=z(!1),v=z(0),k=z(!1);let P=null,R=null;const S=z(e.practiceUnitHeader?.tempo||80);function x(){return new Promise((E,y)=>{if(typeof globalThis.Tone<"u")return E(globalThis.Tone);const L=document.querySelector('script[data-src="tone-cdn"]');if(L){L.addEventListener("load",()=>E(globalThis.Tone)),L.addEventListener("error",()=>y(new Error("Failed to load Tone.js")));return}const F=document.createElement("script");F.setAttribute("data-src","tone-cdn"),F.src="https://cdn.jsdelivr.net/npm/tone@14.8.39/build/Tone.js",F.onload=()=>E(globalThis.Tone),F.onerror=()=>y(new Error("Failed to load Tone.js")),document.head.appendChild(F)})}function j(){P&&(clearTimeout(P),P=null)}function I(E){try{const y=String(E?.duration||"q"),L=y.match(/^([whqes])(?:\.|\*)?(r)?$/i);let F="q",W=!1;L&&(F=L[1].toLowerCase(),W=/\.|\*/.test(y));const ue=6e4/(Number(S.value)||80),he={w:4,h:2,q:1,e:.5,s:.25}[F]||1;return Math.max(50,Math.round(he*(W?1.5:1)*ue))}catch{return 6e4/(Number(S.value)||80)}}async function _(){if(R)return R;const E=await x();return await E.start?.(),R=new E.Synth().toDestination(),R}function U(E){try{const y=Array.from(document.querySelectorAll(".vf-stavenote"));y.forEach(L=>L.classList.remove("note-highlight")),y[E]&&y[E].classList.add("note-highlight")}catch{}}async function B(E=0){try{j();const y=Array.isArray(e.noteArray)?e.noteArray:[];if(!y.length){alert("No notes to play."),p.value=!1;return}v.value=Math.max(0,Math.min(E,y.length-1));const L=await _();p.value=!0,g.value=!1;const F=y[v.value];U(v.value);const W=String(F?.pitch||""),ue=W.includes("/")?W.replace(/\//g,""):W,he=I(F),be=Math.max(.08,he/1e3);try{L.triggerAttackRelease(ue,be)}catch{try{L.triggerAttackRelease(W,be)}catch{}}P=setTimeout(()=>{if(P=null,!p.value)return;v.value++;const Oe=y.length;v.value>=Oe?k.value?(v.value=0,B(v.value)):J():B(v.value)},he)}catch(y){console.warn("[CreatePracticeUnitView] playFrom failed",y),J()}}function G(){if(!(p.value&&!g.value)){if(g.value){g.value=!1,B(v.value);return}B(v.value||0)}}function K(){p.value&&(g.value=!0,p.value=!1,j())}function J(){p.value=!1,g.value=!1,v.value=0,j();try{document.querySelectorAll(".vf-stavenote").forEach(E=>E.classList.remove("note-highlight"))}catch{}}function ce(){J();const E=Array.isArray(e.noteArray)?e.noteArray:[];E.length&&(v.value=Math.min(E.length-1,(v.value||0)+1),B(v.value))}function ge(){J(),(Array.isArray(e.noteArray)?e.noteArray:[]).length&&(v.value=Math.max(0,(v.value||0)-1),B(v.value))}function Se(){k.value=!k.value}ro(()=>{j();try{R&&typeof R.dispose=="function"&&R.dispose()}catch{}R=null});const Ae=E=>typeof E=="string"&&E.length?E[0].toUpperCase()+E.slice(1):E,fe=ie(()=>{const E=e.scaleSelections||{};return`${E.key||"C"} ${Ae(E.scaleType||"major")} Scale`}),re=ie(()=>{const E=e.scaleSelections||{},y=Number(E.octaveCount)||1;return`${y} ${y===1?"octave":"octaves"} starting at ${E.startingOctave||"C4"}`}),we=ie(()=>{const E=e.scaleSelections||{},y=E.direction||"Ascending",F={whole:"Whole",half:"Half",quarter:"Quarter",eighth:"Eighth"}[E.noteDuration]||Ae(E.noteDuration||"Quarter");return`${y} ${F} Note Scale`}),Ee=ie(()=>{const E=e.scaleSelections&&e.scaleSelections.staffOptions||{},y=[];E.keySignature&&y.push("Key Signature"),E.barLines&&y.push("Bar Lines"),E.timeSignature&&y.push("Time Signature"),E.accidentals&&y.push("Accidentals");let L="";switch(E.accidentalFamily){case"auto-key":L="Auto: Based on Key";break;case"auto-direction":L="Auto: Based on Asc/Desc";break;case"force-sharps":L="Force: Sharps";break;case"force-flats":L="Force: Flats";break}return y.join(", ")+(L?`, ${L}`:"")}),_e=ie(()=>e.practiceUnitHeader?.practiceName||"Untitled Exercise"),Te=ie(()=>e.practiceUnitHeader?.keySignature||"C"),Ue=ie(()=>e.practiceUnitHeader?.timeSignature||"4/4"),Z=ie(()=>e.practiceUnitHeader?.tempo||80),N=ie(()=>e.practiceUnitHeader?.techniqueFocus||[]),A=ie(()=>e.practiceUnitHeader?.sourceMusicXML||""),m=ie(()=>e.practiceUnitHeader?.sourceURL||""),$=ie(()=>{const E=e.practiceUnitHeader;if(E?.practiceName)return E.practiceName;if(u.value==="Scale"){const L=E?.instrument?.instrument?.split(",")[0]?.trim()||"Unknown Instrument",F=e.scaleSelections||{},W=F.scaleType?F.scaleType.charAt(0).toUpperCase()+F.scaleType.slice(1):"Major";return`${F.key||E?.keySignature||"C"} ${W} Scale for ${L}`}else{const L=E?.instrument?.instrument?.split(",")[0]?.trim()||"Unknown Instrument",F=E?.sourceTitle;return F?`${F} for ${L}`:`Exercise for ${L}`}}),q=ie(()=>{const E=(i.value||"").trim().toLowerCase(),y=n.value||[];return E?y.filter(L=>{try{const F=L?.unit_json?.practiceUnitHeader||{},W=F?.instrument?.instrument||F?.instrument||"",ue=(F?.techniqueFocus||[]).join(" ");return[L?.name,L?.type,F?.keySignature,F?.timeSignature,F?.contentType,ue,W].filter(Boolean).map(be=>String(be).toLowerCase()).some(be=>be.includes(E))}catch{return!1}}):y});function te(){try{const E=e.composePracticeUnit(),y=E.practiceUnitHeader;let L=globalThis.prompt("Enter Practice Unit Name:",$.value);if(!L)return;y.practiceName=L;const F=JSON.stringify(E,null,2),W=new Blob([F],{type:"application/json"}),ue=URL.createObjectURL(W),he=document.createElement("a");he.href=ue,he.download=`MTS-Practice Unit ${L}.json`,he.click(),URL.revokeObjectURL(ue)}catch(E){console.warn("[CreatePracticeUnitView] exportToJson failed",E),alert("Failed to export practice unit.")}}function le(){o.value&&o.value.click()}async function b(E){const y=E?.target?.files?.[0];if(y)try{const L=await y.text(),F=JSON.parse(L);F.practiceUnitHeader&&Array.isArray(F.noteArray)?(e.loadPracticeUnit(F),alert(`Loaded ${u.value} from file: ${y.name}`)):alert("Invalid practice unit format. Expected practiceUnitHeader and noteArray.")}catch(L){console.warn("[CreatePracticeUnitView] Import parse failed",L),alert("Failed to parse JSON file.")}}async function w(){try{const{data:E,error:y}=await ke.auth.getSession(),L=E?.session;if(y||!L?.user?.id){alert("Please sign in on Preferences before saving to database.");return}const F=e.composePracticeUnit(),W=F.practiceUnitHeader;W.practiceUnitId||(W.practiceUnitId=crypto.randomUUID?crypto.randomUUID():`guid-${Date.now()}`),W.lastModified=new Date().toISOString(),W.User=L.user.id,W.practiceUnitType||(W.practiceUnitType=u.value);const ue=W.practiceName||$.value;W.practiceName=ue;const he={user_id:L.user.id,practice_unit_id:W.practiceUnitId,name:ue,type:W.practiceUnitType,share_music:!!W.shareMusic,unit_json:F,last_modified:W.lastModified},{error:be}=await c(he);if(be){console.warn("[CreatePracticeUnitView] saveToDatabase error",be),alert(`Save failed: ${be.message}`);return}alert("Saved to database.")}catch(E){console.warn("[CreatePracticeUnitView] saveToDatabase exception",E),alert("Unexpected error while saving to database.")}}async function O(){try{const{data:E,error:y}=await ke.auth.getSession(),L=E?.session;if(y||!L?.user?.id){alert("Please sign in on Preferences before saving to database.");return}const F=e.composePracticeUnit(),W=F.practiceUnitHeader;W.practiceUnitId=crypto.randomUUID?crypto.randomUUID():`guid-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,W.lastModified=new Date().toISOString(),W.User=L.user.id,W.practiceUnitType||(W.practiceUnitType=u.value);const ue=W.practiceName||$.value;W.practiceName=ue;const he={user_id:L.user.id,practice_unit_id:W.practiceUnitId,name:ue,type:W.practiceUnitType,share_music:!!W.shareMusic,unit_json:F,last_modified:W.lastModified},{error:be}=await l(he);if(be){console.warn("[CreatePracticeUnitView] saveAsNewToDatabase error",be),alert(`Save as New failed: ${be.message}`);return}alert(`Saved as new practice unit to database.

Name: ${W.practiceName}
ID: ${W.practiceUnitId}

This is a brand new unit separate from any previous saves.`)}catch(E){console.warn("[CreatePracticeUnitView] saveAsNewToDatabase exception",E),alert("Unexpected error while saving as new to database.")}}async function M(){try{const{data:E}=await ke.auth.getSession(),y=E?.session;if(!y?.user?.id){alert("Sign in first to recall from database.");return}r.value=!0,s.value=!0;const{data:L,error:F}=await ke.from("practice_units").select("practice_unit_id, name, type, last_modified, unit_json").eq("user_id",y.user.id).order("last_modified",{ascending:!1});if(F){console.warn("[CreatePracticeUnitView] openRecallModal error",F),alert(`Failed to load saved practice units: ${F.message}`),s.value=!1;return}n.value=L||[]}catch(E){console.warn("[CreatePracticeUnitView] openRecallModal exception",E),alert(`Unexpected error while loading saved ${u.value.toLowerCase()}s.`),s.value=!1}finally{r.value=!1}}function V(E){try{if(!E?.unit_json){alert("Invalid practice unit data.");return}e.loadPracticeUnit(E.unit_json),s.value=!1,alert(`Loaded: ${E.name}`)}catch(y){console.warn("[CreatePracticeUnitView] loadSelectedUnit exception",y),alert("Failed to load practice unit.")}}function H(E){if(!E)return"";const y=new Date(E);return y.toLocaleDateString()+" "+y.toLocaleTimeString()}function se(E){return!E||!E.instrument?"Unknown Instrument":E.instrument.split(",")[0].trim()}function ee(E){try{const y=E?.unit_json?.practiceUnitHeader||{},L=se(y.instrument);if(E.type==="Scale"){const F=y.contentType?y.contentType.charAt(0).toUpperCase()+y.contentType.slice(1):"",W=[];return y.keySignature&&F&&W.push(`${y.keySignature} ${F}`),y.startingOctave&&W.push(`start ${y.startingOctave}`),y.numberOfOctaves&&W.push(`${y.numberOfOctaves} octave${y.numberOfOctaves>1?"s":""}`),y.direction&&W.push(String(y.direction)),L&&L!=="Unknown Instrument"&&W.push(`for ${L}`),W.filter(Boolean).join("  ")}else{const F=(y?.techniqueFocus||[]).join(", "),W=[];return y.keySignature&&W.push(y.keySignature),y.timeSignature&&W.push(y.timeSignature),F&&W.push(F),L&&L!=="Unknown Instrument"&&W.push(`for ${L}`),W.filter(Boolean).join("  ")}}catch{return""}}return(E,y)=>(C(),T("div",Px,[Q(pt),a("main",Rx,[a("div",Ux,[y[5]||(y[5]=a("span",{class:"material-symbols-outlined"},"visibility",-1)),y[6]||(y[6]=a("span",{class:"text-2xl font-bold"},"Preview Practice Unit",-1)),u.value?(C(),T("span",jx,D(u.value),1)):me("",!0)]),a("div",Ix,[y[7]||(y[7]=a("input",{type:"checkbox",class:"peer",checked:""},null,-1)),a("div",Nx,[a("span",null,D(u.value)+" Preview",1),a("span",Dx,D(ne(e).noteArray&&ne(e).noteArray.length>0?ne(e).noteArray.map(L=>L.pitch).join(", "):`No ${u.value.toLowerCase()} generated yet.`),1)]),a("div",Lx,[Q(Gn)])]),a("div",Fx,[a("div",Mx,[a("button",{class:"btn btn-sm",onClick:ge,title:"Step back"},""),a("button",{class:it(["btn btn-sm",p.value?"btn-warning":"btn-primary"]),onClick:y[0]||(y[0]=L=>p.value?K():G())},[p.value?(C(),T("span",Vx," Pause")):(C(),T("span",Bx," Play"))],2),a("button",{class:"btn btn-sm btn-ghost",onClick:J,title:"Stop"},""),a("button",{class:"btn btn-sm",onClick:ce,title:"Step forward"},""),a("label",Hx,[y[8]||(y[8]=a("span",{class:"text-sm"},"Tempo",-1)),ae(a("input",{type:"number",class:"input input-sm input-bordered w-28","onUpdate:modelValue":y[1]||(y[1]=L=>S.value=L),min:"30",max:"300"},null,512),[[$e,S.value,void 0,{number:!0}]])]),a("button",{class:it(["btn btn-sm ml-2",k.value?"btn-primary":"btn-outline"]),onClick:Se},"Loop: "+D(k.value?"On":"Off"),3),a("div",qx,"Notes: "+D(f.value),1)])]),u.value==="Scale"?(C(),T("div",Gx,[y[14]||(y[14]=a("input",{type:"checkbox",class:"peer"},null,-1)),y[15]||(y[15]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Details")],-1)),a("div",Kx,[a("div",null,[y[9]||(y[9]=a("strong",null,"Instrument:",-1)),X(" "+D(d.value),1)]),a("div",null,[y[10]||(y[10]=a("strong",null,"Scale Selector:",-1)),X(" "+D(fe.value),1)]),a("div",null,[y[11]||(y[11]=a("strong",null,"Scale Range:",-1)),X(" "+D(re.value),1)]),a("div",null,[y[12]||(y[12]=a("strong",null,"Duration & Direction:",-1)),X(" "+D(we.value),1)]),a("div",null,[y[13]||(y[13]=a("strong",null,"Staff Formatting:",-1)),X(" "+D(Ee.value),1)])])])):u.value==="Exercise"?(C(),T("div",Wx,[y[25]||(y[25]=a("input",{type:"checkbox",class:"peer"},null,-1)),y[26]||(y[26]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Details")],-1)),a("div",Jx,[a("div",null,[y[16]||(y[16]=a("strong",null,"Title:",-1)),X(" "+D(_e.value),1)]),a("div",null,[y[17]||(y[17]=a("strong",null,"Instrument:",-1)),X(" "+D(d.value),1)]),a("div",null,[y[18]||(y[18]=a("strong",null,"Key Signature:",-1)),X(" "+D(Te.value),1)]),a("div",null,[y[19]||(y[19]=a("strong",null,"Time Signature:",-1)),X(" "+D(Ue.value),1)]),a("div",null,[y[20]||(y[20]=a("strong",null,"Tempo:",-1)),X(" "+D(Z.value)+" bpm",1)]),N.value.length>0?(C(),T("div",zx,[y[21]||(y[21]=a("strong",null,"Technique Focus:",-1)),X(" "+D(N.value.join(", ")),1)])):me("",!0),A.value?(C(),T("div",Yx,[y[22]||(y[22]=a("strong",null,"Source:",-1)),X(" "+D(A.value),1)])):me("",!0),m.value?(C(),T("div",Xx,[y[23]||(y[23]=a("strong",null,"Source URL:",-1)),a("a",{href:m.value,target:"_blank",class:"link link-primary"},D(m.value),9,Qx)])):me("",!0),a("div",null,[y[24]||(y[24]=a("strong",null,"Note Count:",-1)),X(" "+D(f.value),1)])])])):me("",!0),a("div",Zx,[y[37]||(y[37]=a("input",{type:"checkbox",class:"peer"},null,-1)),y[38]||(y[38]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2"},[a("span",null," Practice Unit Snapshot Manager")],-1)),a("div",e1,[a("div",t1,[y[35]||(y[35]=a("strong",{class:"text-blue-800"},"Save/Update Options:",-1)),a("ul",s1,[a("li",null,[y[27]||(y[27]=a("strong",null,"SAVE to Database",-1)),y[28]||(y[28]=X("  ",-1)),ne(e).practiceUnitHeader?.practiceUnitId?(C(),T("span",r1,"Disabled after first save")):(C(),T("span",n1,"Creates a new record (first time)")),y[29]||(y[29]=X(". ",-1))]),a("li",null,[y[30]||(y[30]=a("strong",null,"UPDATE in Database",-1)),y[31]||(y[31]=X("  ",-1)),ne(e).practiceUnitHeader?.practiceUnitId?(C(),T("span",i1,"Updates the existing record (after first save)")):(C(),T("span",o1,"Disabled until first save")),y[32]||(y[32]=X(". ",-1))]),y[33]||(y[33]=a("li",null,[a("strong",null,"SAVE as New"),X("  Always creates a brand new copy with a fresh ID. Use to make a variation or backup. ")],-1)),y[34]||(y[34]=a("li",null,[a("strong",null,"Export/Import JSON"),X("  Download or upload practice units as standalone files for sharing or backup outside the database. ")],-1))])]),a("div",a1,[a("button",{class:"btn btn-warning",onClick:te}," Export to JSON file "),a("button",{class:"mtsFormatCreatorButtons flex items-center gap-2 mt-4",onClick:le},[...y[36]||(y[36]=[a("span",{class:"material-symbols-outlined align-middle mr-2","aria-hidden":"true"},"upload_file",-1),X(" Import from JSON file ",-1)])]),a("input",{ref_key:"importFileInput",ref:o,type:"file",accept:"application/json",style:{display:"none"},onChange:b},null,544),a("button",{class:"btn btn-primary mt-4",onClick:w,disabled:ne(e).practiceUnitHeader?.practiceUnitId}," SAVE to Database ",8,l1),ne(e).practiceUnitHeader?.practiceUnitId?(C(),T("button",{key:0,class:"btn btn-primary mt-4",onClick:w}," UPDATE in Database ")):me("",!0),a("button",{class:"btn btn-accent mt-4",onClick:O}," SAVE as New "),a("button",{class:"btn btn-outline mt-4",onClick:M}," RECALL from Database ")])])]),s.value?(C(),T("div",c1,[a("div",u1,[a("h3",d1," Select "+D(u.value)+" to Recall ",1),a("div",f1,[ae(a("input",{type:"text",class:"input input-bordered w-full",placeholder:u.value==="Scale"?"Filter by name, key, type, or instrument...":"Filter by name, key, time, focus, or instrument...","onUpdate:modelValue":y[2]||(y[2]=L=>i.value=L)},null,8,h1),[[$e,i.value]])]),r.value?(C(),T("div",p1,[...y[39]||(y[39]=[a("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):n.value.length===0?(C(),T("div",m1," No saved "+D(u.value.toLowerCase())+"s found for your account. ",1)):q.value.length===0?(C(),T("div",g1,' No matches for "'+D(i.value)+'". ',1)):(C(),T("div",v1,[(C(!0),T(Re,null,st(q.value,L=>(C(),T("div",{key:L.practice_unit_id,class:"card bg-base-100 border hover:border-primary cursor-pointer transition-all",onClick:F=>V(L)},[a("div",b1,[a("div",_1,[a("div",w1,[a("h4",x1,D(L.name),1),a("p",S1,D(ee(L)),1),a("p",k1,D(H(L.last_modified)),1)]),a("span",A1,D(L.type),1)])])],8,y1))),128))])),a("div",E1,[a("button",{class:"btn",onClick:y[3]||(y[3]=L=>s.value=!1)},"Cancel")])])])):me("",!0),a("div",C1,[y[40]||(y[40]=a("input",{type:"checkbox",class:"peer"},null,-1)),y[41]||(y[41]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Behind the Curtain: practiceUnit.json")],-1)),a("div",O1,[a("pre",T1,D(h.value),1)])])]),a("div",$1,[a("button",{class:"mtsFormatCreatorButtons flex items-center gap-2",onClick:y[4]||(y[4]=L=>E.$router.push("/creator"))},[...y[42]||(y[42]=[a("span",{class:"material-symbols-outlined align-middle mr-2","aria-hidden":"true"},"edit_square",-1),X(" Return to Creator ",-1)])])]),Q(_t)]))}},R1={class:"bg-base-200 flex flex-col min-h-screen"},U1={class:"container mx-auto p-4 flex-1"},j1={class:"flex items-center gap-2 mb-8 px-4 py-2 rounded mtsFormatCreatorPages"},I1={key:0,class:"badge badge-primary ml-2"},N1={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},D1={class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},L1={class:"text-right text-base font-normal text-gray-600"},F1={class:"collapse-content px-4"},M1={key:0,class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},B1={class:"collapse-content px-4 text-sm leading-7"},V1={key:1,class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-4 rounded-xl"},H1={class:"collapse-content px-4 text-sm leading-7"},q1={key:0},G1={key:1},K1={key:2},W1=["href"],J1={class:"max-w-2xl mx-auto mb-4"},z1={class:"card bg-base-100 shadow-sm"},Y1={class:"card-body"},X1={key:0,class:"alert alert-warning mb-2"},Q1={class:"form-control mb-2"},Z1={class:"textarea textarea-bordered w-full min-h-48 bg-base-200 overflow-y-auto p-0"},eS={key:0,class:"p-4"},tS={key:1,class:"p-4 text-gray-500"},sS={key:2,class:"p-2 space-y-1"},nS={class:"flex items-center gap-2 flex-1"},rS={class:"badge badge-outline"},iS={class:"font-medium"},oS={key:0,class:"text-xs text-gray-500"},aS=["onClick","title","aria-pressed"],lS={key:2,class:"max-w-3xl mx-auto mb-6"},cS={class:"card bg-base-100 shadow-sm"},uS={class:"card-body"},dS={class:"flex items-center justify-between"},fS={class:"card-title"},hS={class:"flex gap-2"},pS={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2"},mS={class:"grid grid-cols-2 gap-2 mt-2"},gS={class:"space-y-2"},vS={class:"flex items-center gap-2"},yS=["onUpdate:modelValue"],bS=["onUpdate:modelValue"],_S=["onUpdate:modelValue"],wS=["onClick","disabled"],xS=["onClick","disabled"],SS=["onClick"],kS={class:"collapse collapse-arrow bg-gray-50 border border-gray-300 mb-6 rounded-xl max-w-3xl mx-auto"},AS={class:"collapse-content px-4 pb-4"},ES={class:"whitespace-pre-wrap text-sm bg-base-200 p-3 rounded overflow-auto"},CS={style:{"max-width":"400px",margin:"2em auto"}},OS={__name:"CreateEditPracticeUnit",setup(t){const e=ds(),s=Hr(),n=Zt(),r=z(""),i=z(!1),o=z(!1),c=z(""),l=z(null),u=z(null),d=$t({practiceName:"",practiceUnitType:"Scale",instrumentName:"",keySignature:"",timeSignature:"",tempo:120}),f=z([]);function h(A){const m=A?.instrument;return m?typeof m=="string"?m:typeof m=="object"&&(m.instrument||m.name)||"":""}function p(A){try{const m=A?.practice_unit_id,$=l.value;return String(m||"")===String($||"")}catch{return!1}}const g=ie(()=>{const A=(r.value||"").toLowerCase().trim(),m=s.availableUnits||[];return A?m.filter($=>{const q=($.name||"").toLowerCase(),te=($.type||"").toLowerCase(),le=h($).toLowerCase();return q.includes(A)||te.includes(A)||le.includes(A)}):m});function v(A){if(!A||!A.unit_json)return alert("Invalid unit");l.value=A.practice_unit_id||null,u.value=A,c.value=A.name||"(untitled)";const m=A.unit_json.practiceUnitHeader||{};d.practiceName=m.practiceName||m.practiceUnitName||c.value||"",d.practiceUnitType=m.practiceUnitType||A.type||"Scale",d.instrumentName=m.instrument||m.instrumentName||"",d.keySignature=m.keySignature||m.key||"",d.timeSignature=m.timeSignature||"",d.tempo=m.tempo||m.bpm||120,f.value=Array.isArray(A.unit_json.noteArray)?A.unit_json.noteArray.map($=>({...$})):[];try{e.practiceUnitHeader={...e.practiceUnitHeader,...d},e.noteArray=f.value.map($=>({...$})),n.noteArray=f.value.map($=>({...$}))}catch($){console.warn("Failed to load unit into active memory for preview",$)}o.value=!0,i.value=!0}function k(A){v(A)}function P(){o.value=!1,l.value=null,u.value=null}function R(){f.value.push({pitch:"C4",duration:"q",noteColor:""})}function S(A){f.value.splice(A,1)}function x(A){if(A<=0)return;const m=f.value,$=m[A-1];m[A-1]=m[A],m[A]=$}function j(A){const m=f.value;if(A>=m.length-1)return;const $=m[A+1];m[A+1]=m[A],m[A]=$}function I(){const A=e.practiceUnitHeader||{},m=e.noteArray||[];m&&m.length>0||A&&A.practiceName?(d.practiceName=A.practiceName||"",d.practiceUnitType=A.practiceUnitType||"Scale",d.instrumentName=A.instrument||A.instrumentName||"",d.keySignature=A.keySignature||"",d.timeSignature=A.timeSignature||"",d.tempo=A.tempo||120,f.value=Array.isArray(m)?m.map(q=>({...q})):[],i.value=!0,n.noteArray=f.value.map(q=>({...q}))):i.value=!1}function _(){e.practiceUnitHeader={...e.practiceUnitHeader,practiceName:d.practiceName,practiceUnitType:d.practiceUnitType,instrument:d.instrumentName,keySignature:d.keySignature,timeSignature:d.timeSignature,tempo:d.tempo},e.noteArray=f.value.map(A=>({...A})),n.noteArray=f.value.map(A=>({...A})),alert("Saved edits to active memory"),o.value=!1}async function U(){try{const A={practiceUnitHeader:{...d},noteArray:f.value},{data:m,error:$}=await ke.auth.getSession();if($)throw $;const q=m?.session?.user;if(!q){alert("Sign in first to save to database.");return}const te={practice_unit_id:l.value||void 0,user_id:q.id,name:c.value||d.practiceName||"(untitled)",type:d.practiceUnitType||u.value?.type||"Scale",unit_json:A};let le;if(l.value?le=await ke.from("practice_units").upsert(te,{onConflict:"practice_unit_id"}).select().single():le=await ke.from("practice_units").insert(te).select().single(),le.error)throw le.error;await s.fetchPracticeUnits();const b=le.data;l.value=b?.practice_unit_id||l.value,alert("Saved practice unit to database."),o.value=!1}catch(A){console.error("[CreateEditPracticeUnit] saveToDatabase failed",A),alert(A?.message||"Failed to save to database.")}}async function B(){if(!l.value)return alert("No unit selected to delete.");if(confirm("Delete this practice unit from the database? This cannot be undone."))try{const A=await ke.from("practice_units").delete().eq("practice_unit_id",l.value).select();if(A.error)throw A.error;await s.fetchPracticeUnits(),alert("Deleted practice unit."),o.value=!1,l.value=null}catch(A){console.error("Failed to delete",A),alert(A?.message||"Delete failed.")}}Ye(()=>{s.fetchPracticeUnits().catch(A=>console.warn("Failed to load practice units",A)),e.loadInstruments(),I()}),qe(f,A=>{if(o.value)try{e.noteArray=A.map(m=>({...m})),n.noteArray=A.map(m=>({...m})),u.value&&(u.value.unit_json=u.value.unit_json||{},u.value.unit_json.noteArray=A.map(m=>({...m})))}catch(m){console.warn("Failed to sync notes to stores",m)}},{deep:!0}),qe(d,A=>{if(o.value)try{e.practiceUnitHeader={...e.practiceUnitHeader,...A},u.value&&(u.value.unit_json=u.value.unit_json||{},u.value.unit_json.practiceUnitHeader={...A})}catch(m){console.warn("Failed to sync header to store",m)}},{deep:!0});const G=ie(()=>e.practiceUnitHeader?.practiceUnitType||"Scale"),K=ie(()=>{const A=e.practiceUnitHeader?.instrument||e.instrument;return A&&A.instrument||"Unknown"}),J=ie(()=>e.noteArray?.length||0),ce=ie(()=>{const A=e.scaleSelections||{};return`${A.key||"C"} ${A.scaleType?A.scaleType.charAt(0).toUpperCase()+A.scaleType.slice(1):"Major"} Scale`}),ge=ie(()=>{const A=e.scaleSelections||{},m=Number(A.octaveCount)||1;return`${m} ${m===1?"octave":"octaves"} starting at ${A.startingOctave||"C4"}`}),Se=ie(()=>{const A=e.scaleSelections||{},m=A.direction||"Ascending",q={whole:"Whole",half:"Half",quarter:"Quarter",eighth:"Eighth"}[A.noteDuration]||(A.noteDuration?A.noteDuration:"Quarter");return`${m} ${q} Note Scale`}),Ae=ie(()=>{const A=e.scaleSelections&&e.scaleSelections.staffOptions||{},m=[];A.keySignature&&m.push("Key Signature"),A.barLines&&m.push("Bar Lines"),A.timeSignature&&m.push("Time Signature"),A.accidentals&&m.push("Accidentals");let $="";switch(A.accidentalFamily){case"auto-key":$="Auto: Based on Key";break;case"auto-direction":$="Auto: Based on Asc/Desc";break;case"force-sharps":$="Force: Sharps";break;case"force-flats":$="Force: Flats";break}return m.join(", ")+($?`, ${$}`:"")}),fe=ie(()=>e.practiceUnitHeader?.practiceName||""),re=ie(()=>e.practiceUnitHeader?.keySignature||""),we=ie(()=>e.practiceUnitHeader?.timeSignature||""),Ee=ie(()=>e.practiceUnitHeader?.tempo||""),_e=ie(()=>e.practiceUnitHeader?.techniqueFocus||[]),Te=ie(()=>e.practiceUnitHeader?.sourceMusicXML||""),Ue=ie(()=>e.practiceUnitHeader?.sourceURL||""),Z=ie(()=>o.value?{practiceUnitHeader:{...d},noteArray:f.value.map(A=>({...A}))}:typeof e.composePracticeUnit=="function"?e.composePracticeUnit():{practiceUnitHeader:e.practiceUnitHeader||{},noteArray:e.noteArray||[]}),N=ie(()=>JSON.stringify(Z.value,null,2));return(A,m)=>(C(),T("div",R1,[Q(pt),a("main",U1,[a("div",j1,[m[9]||(m[9]=a("span",{class:"material-symbols-outlined"},"edit",-1)),m[10]||(m[10]=a("span",{class:"text-2xl font-bold"},"Edit Practice Unit",-1)),G.value?(C(),T("span",I1,D(G.value),1)):me("",!0)]),a("div",N1,[ae(a("input",{type:"checkbox",class:"peer","onUpdate:modelValue":m[0]||(m[0]=$=>i.value=$)},null,512),[[zt,i.value]]),a("div",D1,[m[11]||(m[11]=a("span",null,"Preview",-1)),a("span",L1,D(ne(e).noteArray&&ne(e).noteArray.length>0?ne(e).noteArray.map($=>$.pitch).join(", "):"No Practice Unit Loaded."),1)]),a("div",F1,[Q(Gn)])]),G.value==="Scale"?(C(),T("div",M1,[m[17]||(m[17]=a("input",{type:"checkbox",class:"peer"},null,-1)),m[18]||(m[18]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Details")],-1)),a("div",B1,[a("div",null,[m[12]||(m[12]=a("strong",null,"Instrument:",-1)),X(" "+D(K.value),1)]),a("div",null,[m[13]||(m[13]=a("strong",null,"Scale Selector:",-1)),X(" "+D(ce.value),1)]),a("div",null,[m[14]||(m[14]=a("strong",null,"Scale Range:",-1)),X(" "+D(ge.value),1)]),a("div",null,[m[15]||(m[15]=a("strong",null,"Duration & Direction:",-1)),X(" "+D(Se.value),1)]),a("div",null,[m[16]||(m[16]=a("strong",null,"Staff Formatting:",-1)),X(" "+D(Ae.value),1)])])])):G.value==="Exercise"?(C(),T("div",V1,[m[29]||(m[29]=a("input",{type:"checkbox",class:"peer"},null,-1)),m[30]||(m[30]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2 flex justify-between items-center"},[a("span",null,"Details")],-1)),a("div",H1,[a("div",null,[m[19]||(m[19]=a("strong",null,"Title:",-1)),X(" "+D(fe.value),1)]),a("div",null,[m[20]||(m[20]=a("strong",null,"Instrument:",-1)),X(" "+D(K.value),1)]),a("div",null,[m[21]||(m[21]=a("strong",null,"Key Signature:",-1)),X(" "+D(re.value),1)]),a("div",null,[m[22]||(m[22]=a("strong",null,"Time Signature:",-1)),X(" "+D(we.value),1)]),a("div",null,[m[23]||(m[23]=a("strong",null,"Tempo:",-1)),X(" "+D(Ee.value)+" bpm",1)]),_e.value.length>0?(C(),T("div",q1,[m[24]||(m[24]=a("strong",null,"Technique Focus:",-1)),X(" "+D(_e.value.join(", ")),1)])):me("",!0),Te.value?(C(),T("div",G1,[m[25]||(m[25]=a("strong",null,"Source:",-1)),X(" "+D(Te.value),1)])):me("",!0),Ue.value?(C(),T("div",K1,[m[26]||(m[26]=a("strong",null,"Source URL:",-1)),m[27]||(m[27]=X()),a("a",{href:Ue.value,target:"_blank",class:"link link-primary"},D(Ue.value),9,W1)])):me("",!0),a("div",null,[m[28]||(m[28]=a("strong",null,"Note Count:",-1)),X(" "+D(J.value),1)])])])):me("",!0),a("div",J1,[a("div",z1,[a("div",Y1,[m[33]||(m[33]=a("h3",{class:"card-title"},"Your Saved Practice Units",-1)),m[34]||(m[34]=a("div",{class:"text-xs text-gray-500 mb-2"},"Filter and open a saved practice unit for editing",-1)),ne(s).error?(C(),T("div",X1,[a("span",null,D(ne(s).error),1),a("button",{class:"btn btn-xs ml-auto",onClick:m[1]||(m[1]=$=>ne(s).fetchPracticeUnits())},"Retry")])):me("",!0),a("div",Q1,[ae(a("input",{type:"text","onUpdate:modelValue":m[2]||(m[2]=$=>r.value=$),class:"input input-bordered w-full",placeholder:"Filter by name, type, instrument"},null,512),[[$e,r.value]])]),a("div",Z1,[ne(s).loading?(C(),T("div",eS,[...m[31]||(m[31]=[a("span",{class:"loading loading-spinner loading-md"},null,-1),a("span",{class:"ml-2"},"Loading practice units",-1)])])):g.value.length===0?(C(),T("div",tS,"No Practice Units found.")):(C(),T("ul",sS,[(C(!0),T(Re,null,st(g.value,$=>(C(),T("li",{key:$.practice_unit_id},[a("div",{class:it(["flex items-center justify-between w-full p-2 rounded border",p($)?"bg-yellow-100 border-yellow-300 text-black":"bg-white border-gray-200"]),style:as(p($)?{backgroundColor:"#fff9c4",borderColor:"#f6e05e",color:"#000000"}:{})},[a("div",nS,[a("span",rS,D($.type),1),a("span",iS,D($.name),1),h($)?(C(),T("span",oS," "+D(h($)),1)):me("",!0)]),a("button",{class:"btn btn-sm btn-circle",onClick:q=>k($),title:"Edit "+$.name,"aria-pressed":p($)},[...m[32]||(m[32]=[a("span",{class:"material-symbols-outlined text-base"},"edit",-1)])],8,aS)],6)]))),128))]))])])])]),o.value?(C(),T("div",lS,[a("div",cS,[a("div",uS,[a("div",dS,[a("h3",fS,"Edit Practice Unit: "+D(c.value||"(new)"),1),a("div",hS,[a("button",{class:"btn btn-ghost",onClick:P},"Cancel"),a("button",{class:"btn",onClick:_},"Save to Memory"),a("button",{class:"btn btn-primary",onClick:U},"Save to Database"),l.value?(C(),T("button",{key:0,class:"btn btn-error",onClick:B},"Delete")):me("",!0)])]),a("div",pS,[a("div",null,[m[38]||(m[38]=a("label",{class:"label"},[a("span",{class:"label-text"},"Practice Name")],-1)),m[39]||(m[39]=a("label",{class:"label mt-2"},[a("span",{class:"label-text"},"Type")],-1)),ae(a("select",{"onUpdate:modelValue":m[3]||(m[3]=$=>d.practiceUnitType=$),class:"select select-bordered w-full"},[...m[35]||(m[35]=[a("option",null,"Scale",-1),a("option",null,"Exercise",-1)])],512),[[As,d.practiceUnitType]]),m[40]||(m[40]=a("label",{class:"label mt-2"},[a("span",{class:"label-text"},"Instrument")],-1)),ae(a("input",{"onUpdate:modelValue":m[4]||(m[4]=$=>d.instrumentName=$),class:"input input-bordered w-full",placeholder:"Instrument (string)"},null,512),[[$e,d.instrumentName]]),a("div",mS,[a("div",null,[m[36]||(m[36]=a("label",{class:"label"},[a("span",{class:"label-text"},"Key")],-1)),ae(a("input",{"onUpdate:modelValue":m[5]||(m[5]=$=>d.keySignature=$),class:"input input-bordered w-full"},null,512),[[$e,d.keySignature]])]),a("div",null,[m[37]||(m[37]=a("label",{class:"label"},[a("span",{class:"label-text"},"Time")],-1)),ae(a("input",{"onUpdate:modelValue":m[6]||(m[6]=$=>d.timeSignature=$),class:"input input-bordered w-full"},null,512),[[$e,d.timeSignature]])])]),m[41]||(m[41]=a("label",{class:"label mt-2"},[a("span",{class:"label-text"},"Tempo (bpm)")],-1)),ae(a("input",{type:"number","onUpdate:modelValue":m[7]||(m[7]=$=>d.tempo=$),class:"input input-bordered w-32",min:"20",max:"400"},null,512),[[$e,d.tempo,void 0,{number:!0}]])]),a("div",null,[m[42]||(m[42]=a("label",{class:"label"},[a("span",{class:"label-text"},"Note Array (edit items)")],-1)),a("div",gS,[(C(!0),T(Re,null,st(f.value,($,q)=>(C(),T("div",{key:q,class:"p-2 border rounded bg-white"},[a("div",vS,[ae(a("input",{"onUpdate:modelValue":te=>$.pitch=te,class:"input input-sm input-bordered w-32"},null,8,yS),[[$e,$.pitch]]),ae(a("input",{"onUpdate:modelValue":te=>$.duration=te,class:"input input-sm input-bordered w-24"},null,8,bS),[[$e,$.duration]]),ae(a("input",{"onUpdate:modelValue":te=>$.noteColor=te,class:"input input-sm input-bordered w-24",placeholder:"color"},null,8,_S),[[$e,$.noteColor]]),a("button",{class:"btn btn-xs",onClick:te=>x(q),disabled:q===0},"",8,wS),a("button",{class:"btn btn-xs",onClick:te=>j(q),disabled:q===f.value.length-1},"",8,xS),a("button",{class:"btn btn-xs btn-error ml-auto",onClick:te=>S(q)},"Remove",8,SS)])]))),128))]),a("div",{class:"mt-2"},[a("button",{class:"btn btn-sm",onClick:R},"Add Note")])])])])])])):me("",!0)]),a("div",kS,[m[43]||(m[43]=a("input",{type:"checkbox",class:"peer"},null,-1)),m[44]||(m[44]=a("div",{class:"collapse-title font-bold text-lg px-4 pt-4 pb-2"},"Behind the Curtain: practiceUnit.json",-1)),a("div",AS,[a("pre",ES,D(N.value),1)])]),a("div",CS,[a("button",{class:"mtsFormatCreatorButtons flex items-center gap-2",onClick:m[8]||(m[8]=$=>A.$router.push("/creator"))},[...m[45]||(m[45]=[a("span",{class:"material-symbols-outlined align-middle mr-2","aria-hidden":"true"},"edit_square",-1),X(" Return to Creator ",-1)])])]),Q(_t)]))}},TS=["value"],$S=["value"],PS={__name:"ScaleBuilder",props:{enums:Object,modelValue:Object},emits:["update:modelValue"],setup(t,{emit:e}){return(s,n)=>(C(),T("div",null,[n[3]||(n[3]=a("label",{for:"scale-type",class:"font-bold mb-2 block"},"Scale Type:",-1)),ae(a("select",{id:"scale-type","onUpdate:modelValue":n[0]||(n[0]=r=>t.modelValue.scaleType=r),class:"select select-bordered w-full mb-2"},[(C(!0),T(Re,null,st(t.enums.scaleType,r=>(C(),T("option",{key:r,value:r},D(r),9,TS))),128))],512),[[As,t.modelValue.scaleType]]),n[4]||(n[4]=a("label",{for:"direction",class:"font-bold mb-2 block"},"Direction:",-1)),ae(a("select",{id:"direction","onUpdate:modelValue":n[1]||(n[1]=r=>t.modelValue.direction=r),class:"select select-bordered w-full mb-2"},[(C(!0),T(Re,null,st(t.enums.direction,r=>(C(),T("option",{key:r,value:r},D(r),9,$S))),128))],512),[[As,t.modelValue.direction]]),n[5]||(n[5]=a("label",{for:"octaves",class:"font-bold mb-2 block"},"Octaves:",-1)),ae(a("input",{id:"octaves",type:"number","onUpdate:modelValue":n[2]||(n[2]=r=>t.modelValue.octaves=r),class:"input input-bordered w-full",min:"1",max:"4"},null,512),[[$e,t.modelValue.octaves]])]))}},RS={__name:"StaffNoteBuilder",props:{config:Object,modelValue:Object},emits:["update:modelValue"],setup(t,{emit:e}){const s=t,n=e,r=z("");function i(c){return c.split(/\s+/).filter(Boolean).map(l=>{const u=l.match(/^([A-Ga-g][b#]?)(\d)$/);return u?{key:u[1].toLowerCase()+"/"+u[2],duration:"q"}:null}).filter(Boolean)}function o(){const c=i(r.value);n("update:modelValue",{...s.modelValue,noteArray:c})}return qe(()=>s.modelValue.noteArray,c=>{Array.isArray(c)&&(r.value=c.map(l=>l.key.replace("/","")).join(" "))},{immediate:!0}),(c,l)=>(C(),T("div",null,[l[1]||(l[1]=a("label",{for:"note-input",class:"font-bold mb-2 block"},"Note Input:",-1)),ae(a("input",{id:"note-input","onUpdate:modelValue":l[0]||(l[0]=u=>r.value=u),class:"input input-bordered w-full",placeholder:"Enter notes (e.g. C4 D4 E4)",onInput:o},null,544),[[$e,r.value]])]))}},US={class:"phase-test-container"},jS={key:0},IS={key:1},NS={key:2},DS={key:3},LS={class:"phase-controls"},FS=["disabled"],MS=["disabled"],BS={key:4,class:"text-red-600 mt-2"},VS={__name:"PhaseBasedVueTestContainer",setup(t){const e=z(1),s=z(null),n=z({}),r=z({noteArray:[]}),i=z([]),o=z({}),c=z(""),l=Zt();qe(()=>r.value.noteArray,h=>{Array.isArray(h)&&(l.noteArray=h)},{deep:!0});const u=ie(()=>({instrument:s.value,scale:n.value,noteArray:r.value.noteArray}));function d(){e.value<4&&e.value++}function f(){e.value>1&&e.value--}return Ye(async()=>{try{const h=await fetch("/alpha-vue-SPA/data/instruments.json");if(!h.ok)throw new Error("Failed to fetch instruments.json");i.value=await h.json()}catch(h){c.value=`Could not load c:/Dev/MusicTutorStudio/Code/public/alpha-vue-SPA/data/instruments.json.
Error: ${h&&h.message?h.message:h}`,i.value=[]}try{const h=await fetch("/alpha-vue-SPA/data/enums.json");if(!h.ok)throw new Error("Failed to fetch enums.json");o.value=await h.json()}catch(h){c.value+=`
Could not load c:/Dev/MusicTutorStudio/Code/public/alpha-vue-SPA/data/enums.json.
Error: ${h&&h.message?h.message:h}`,o.value={}}}),(h,p)=>(C(),T("div",US,[p[10]||(p[10]=a("h2",null,"Phase-Based Vue Test Container",-1)),e.value===1?(C(),T("div",jS,[p[3]||(p[3]=a("p",null,"Phase 1: Instrument Selection",-1)),Q(qr,{instruments:i.value,modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=g=>s.value=g)},null,8,["instruments","modelValue"])])):e.value===2?(C(),T("div",IS,[p[4]||(p[4]=a("p",null,"Phase 2: Scale Configuration",-1)),Q(PS,{enums:o.value,modelValue:n.value,"onUpdate:modelValue":p[1]||(p[1]=g=>n.value=g)},null,8,["enums","modelValue"])])):e.value===3?(C(),T("div",NS,[p[5]||(p[5]=a("p",null,"Phase 3: Staff Note Builder",-1)),Q(RS,{modelValue:r.value,"onUpdate:modelValue":p[2]||(p[2]=g=>r.value=g)},null,8,["modelValue"])])):e.value===4?(C(),T("div",DS,[p[6]||(p[6]=a("p",null,"Phase 4: Data Block Preview",-1)),a("pre",null,D(u.value),1)])):me("",!0),a("div",LS,[p[7]||(p[7]=X(" [",-1)),a("button",{onClick:f,disabled:e.value===1},"Previous",8,FS),p[8]||(p[8]=X("] [",-1)),a("button",{onClick:d,disabled:e.value===4},"Next",8,MS),p[9]||(p[9]=X("] ",-1))]),c.value?(C(),T("div",BS,D(c.value),1)):me("",!0)]))}},HS=xu(VS,[["__scopeId","data-v-a53e476a"]]),qS={__name:"SaveToPracticeUnitExport",setup(t){const e=Zt(),s=ds();function n(){const r=So({scaleStore:s,notesStore:e,name:s?.title||"Untitled"}),i=JSON.stringify(r,null,2),o=new Blob([i],{type:"application/json"}),c=URL.createObjectURL(o),l=document.createElement("a");l.href=c,l.download="MTS-practiceUnitExport.json",l.click(),URL.revokeObjectURL(c)}return(r,i)=>(C(),T("button",{class:"btn btn-warning",onClick:n}," SAVE to MTS-practiceUnitExport.json "))}},GS={__name:"RecallJsonFromPinia",setup(t){function e(){const s=Zt();alert(JSON.stringify(s.noteArray,null,2))}return(s,n)=>(C(),T("button",{class:"btn btn-info",onClick:e}," RECALL json FROM Pinia "))}},KS={key:0},WS={class:"ml-2"},JS={__name:"ImportPracticeUnitExport",setup(t){const e=z(null),s=z(null);function n(i){s.value=i.target.files[0]||null}function r(){const i=s.value;if(!i){alert("No file selected.");return}const o=new FileReader;o.onload=c=>{try{const l=JSON.parse(c.target.result),u=Zt();l.noteArray?(u.noteArray=l.noteArray,alert("Imported noteArray to Pinia!")):alert("Invalid file: noteArray missing")}catch(l){alert("Error parsing JSON: "+l)}},o.readAsText(i)}return(i,o)=>(C(),T("div",null,[o[1]||(o[1]=a("label",{class:"block mb-2",for:"fileInput"},"Step 1: Choose a JSON file to import",-1)),a("input",{id:"fileInput",type:"file",accept:"application/json",onChange:n,ref_key:"fileInput",ref:e,class:"mb-2"},null,544),s.value&&s.value.name?(C(),T("div",KS,[o[0]||(o[0]=a("label",{class:"block mb-2",for:"importBtn"},"Step 2: Click IMPORT to load into Pinia",-1)),a("button",{id:"importBtn",class:"btn btn-secondary",onClick:r}," IMPORT MTS-practiceUnitExport.json to Pinia "),a("span",WS,"Selected: "+D(s.value.name),1)])):me("",!0)]))}},zS={__name:"EditPracticeUnitScaleInMemory",setup(t){function e(){const s=Zt(),n=prompt("Scale Type:",s.scaleType||"Major")||s.scaleType||"Major",r=prompt("Direction:",s.direction||"ascending")||s.direction||"ascending",i=prompt("Scale Range Start (e.g. C4):",s.scaleRange?.start||"")||s.scaleRange?.start||"",o=prompt("Scale Range End (e.g. C5):",s.scaleRange?.end||"")||s.scaleRange?.end||"";let c=JSON.stringify(s.noteArray||[],null,2);c=prompt("Edit noteArray (JSON):",c)||c;let l;try{if(l=JSON.parse(c),!Array.isArray(l))throw new Error("noteArray must be an array")}catch{alert("Invalid noteArray JSON. Changes not applied.");return}s.scaleType=n,s.direction=r,s.scaleRange={start:i,end:o},s.noteArray=l,alert(`practiceUnitScale updated in memory!
Type: ${n}
Direction: ${r}
Range: ${i} - ${o}
noteArray updated.`)}return(s,n)=>(C(),T("button",{class:"btn btn-accent",onClick:e}," Edit practiceUnitScale Pinia Store "))}},YS=[{path:"/",name:"home",component:gp},{path:"/practice",name:"practice",component:xp},{path:"/practice-recall-practice-unit",name:"practice-recall-practice-unit",component:_v},{path:"/practice-active-unit",name:"practice-active-unit",component:Xv},{path:"/practice-notes",name:"practice-notes",component:Iy},{path:"/creator",name:"creator",component:Fy},{path:"/lessons",name:"lessons",component:Hy},{path:"/lessons-manage",name:"lessons-manage",component:Cb},{path:"/lessons-create",name:"lessons-create",component:$w},{path:"/lessons-start",name:"lessons-start",component:$b},{path:"/preferences",name:"preferences",component:C0},{path:"/create-scales",name:"create-scales",component:$x},{path:"/create-exercises",name:"create-exercises",component:z_},{path:"/create-lessons",name:"create-lessons",redirect:"/lessons-create"},{path:"/about",name:"about",component:e0},{path:"/create-practice-unit-view",name:"create-practice-unit-view",component:P1},{path:"/create-edit-practice-unit",name:"create-edit-practice-unit",component:OS},{path:"/create-scale-view",name:"create-scale-view",redirect:"/create-practice-unit-view"},{path:"/create-exercise-view",name:"create-exercise-view",redirect:"/create-practice-unit-view"},{path:"/phase-test-container",name:"phase-test-container",component:HS},{path:"/save-to-practice-unit-export",name:"save-to-practice-unit-export",component:qS},{path:"/recall-json-from-pinia",name:"recall-json-from-pinia",component:GS},{path:"/import-practice-unit-export",name:"import-practice-unit-export",component:JS},{path:"/edit-practice-unit-scale-in-memory",name:"edit-practice-unit-scale-in-memory",component:zS}],XS=op({history:Fh(),routes:YS});console.log("[Vue Alpha] main.js loaded, attempting to mount app...");const Eo=Xf(eh);Eo.use(kp());Eo.use(XS);Eo.mount("#app");console.log("[Vue Alpha] app mounted.");
